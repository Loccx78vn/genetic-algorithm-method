{"title":"Genetic Algorithms in R","markdown":{"yaml":{"title":"Genetic Algorithms in R","subtitle":"Vi·ªát Nam, 2024","categories":["SupplyChainManagement","Logistics","Genetic Algorithm"],"description":"ƒê√¢y l√† b√†i vi·∫øt c·ªßa t√¥i v·ªÅ c√°ch s·ª≠ d·ª•ng R trong ·ª©ng d·ª•ng Genetic Algorithm trong Supply Chain","number-sections":true,"format":{"html":{"code-fold":true,"code-tools":true}},"filters":["quarto-ext/shinylive"],"bibliography":"references.bib"},"headingText":"Gi·ªõi thi·ªáu:","containsRefs":false,"markdown":"\n\n\n```{r}\n#| warning: false\n#| message: false\n#| echo: false\n#Call packages\npacman::p_load(rio,\n               here,\n               janitor,\n               tidyverse,\n               dplyr,\n               magrittr,\n               ggplot2,\n               purrr,\n               lubridate,\n               mice,\n               plotly,\n               DiagrammeR,\n               shinylive)\n```\n\n## V√†i ƒëi·ªÉm v·ªÅ thu·∫≠t to√°n Genetic:\n\n**GA** hay **Genetic Algorithm** l√† 1 thu·∫≠t to√°n t·ªëi ∆∞u h√≥a ng·∫´u nhi√™n (**stochastic search algorithms**), ƒë∆∞·ª£c ph√°t tri·ªÉn d·ª±a tr√™n l√Ω thuy·∫øt ti·∫øn h√≥a v√† s·ª± ch·ªçn l·ªçc t·ª± nhi√™n c·ªßa sinh h·ªçc [@lucascrucca2013].\n\n·ªû th·ªùi c·∫•p 3, b·∫°n ƒë√£ t·ª´ng h·ªçc v·ªÅ l√Ω thuy·∫øt ti·∫øn h√≥a v√† ch·ªçn l·ªçc t·ª± nhi√™n c·ªßa [Charles Darwin](https://vi.wikipedia.org/wiki/Charles_Darwin) v√† [Alfred Russel](https://vi.wikipedia.org/wiki/Alfred_Russel_Wallace) ·ªü m√¥n Sinh h·ªçc. N·∫øu b·∫°n c≈©ng t·ª´ng li·ªát Sinh nh∆∞ t√¥i th√¨ b·∫°n qu√™n c≈©ng kh√¥ng sao üòÖüòÖ. V·∫≠y th√¨ ƒë·ªÉ t√¥i gi·∫£i th√≠ch l·∫°i nh∆∞ sau:\n\nS·ª± ti·∫øn h√≥a l√† s·ª± thay ƒë·ªïi ƒë·∫∑c ƒëi·ªÉm di truy·ªÅn c·ªßa 1 qu·∫ßn th·ªÉ sinh v·∫≠t, v√≠ d·ª• ƒëi·ªÉn h√¨nh ch√≠nh l√† t·ª´ lo·∫°i v∆∞·ª£n ƒë√£ ti·∫øn h√≥a th√†nh h√¨nh d·∫°ng con ng∆∞·ªùi vƒÉn minh nh∆∞ c√°c b·∫°n b√¢y gi·ªù. V·∫≠y qu√° tr√¨nh ti·∫øn h√≥a ƒë√≥ di·ªÖn ra khi c√≥ s·ª± ch·ªçn l·ªçc t·ª± nhi√™n t·∫°o ra c√°c bi·∫øn d·ªã di truy·ªÅn (V√≠ d·ª•: ƒë·ªôt bi·∫øn,...) v√† k·∫øt qu·∫£ l√† c√°c c√° th·ªÉ ƒë·ªôt bi·∫øn tr·ªü n√™n ph·ªï bi·∫øn h∆°n ho·∫∑c hi·∫øm g·∫∑p h∆°n trong qu·∫ßn th·ªÉ. V·∫≠y ƒëi·ªÅu ki·ªán ƒë·ªÉ x·∫£y ra s·ª± ch·ªçn l·ªçc t·ª± nhi√™n c√≥ th·ªÉ l√† s·ª± thay ƒë·ªïi v·ªÅ m√¥i tr∆∞·ªùng s·ªëng, ƒë·ªãa l√Ω,... d·∫´n t·ªõi s·ª± kh√°c nhau v·ªÅ kh·∫£ nƒÉng s·ªëng s√≥t v√† sinh s·∫£n.\n\nK·∫øt c·ª•c l√† xu·∫•t hi·ªán c√°c c√° th·ªÉ ƒë·ªôt bi·∫øn \"m·∫°nh m·∫Ω h∆°n\" ho·∫∑c ƒë√∫ng l√† \"ƒë·∫∑c bi·ªát h∆°n\" c√≥ kh·∫£ nƒÉng t·ªìn t·∫°i khi xu·∫•t hi·ªán s·ª± thay ƒë·ªïi l·ªõn, v√≠ d·ª• nh∆∞ d∆∞·ªõi ƒë√¢y, do s·ª± thay ƒë·ªïi v·ªÅ ƒë·ªãa ƒëi·ªÉm s·ªëng, t·ª´ m·ªôt lo·∫°i chim s·∫ª ƒë√£ ph√°t tri·ªÉn th√†nh 3 ph√¢n h·ªç kh√°c nhau.\n\n```{=html}\n<div style=\"text-align: center; margin-bottom: 20px;\">\n  <img src=\"img/Natural_selection.jpg\" style=\"max-width: 100%; height: auto; display: block; margin: 0 auto;\">\n  \n  <!-- Picture Name -->\n  <div style=\"text-align: left; margin-top: 10px;\">\n    H√¨nh 1: V√≠ d·ª• v·ªÅ ch·ªçn l·ªçc t·ª± nhi√™n\n  </div>\n  \n  <!-- Source Link -->\n  <div style=\"text-align: right; font-style: italic; margin-top: 5px;\">\n    Source: <a href=\"https://www.biologyonline.com/dictionary/natural-selection\">Link to Image</a>\n  </div>\n</div>\n```\n\nV·∫≠y l√≠ thuy·∫øt n√†y li√™n quan g√¨ t·ªõi v·∫•n ƒë·ªÅ t·ªëi ∆∞u h√≥a. Th√¥ng th∆∞·ªùng khi b·∫°n mu·ªën t·ªëi ∆∞u h√≥a m·ªôt v·∫•n ƒë·ªÅ g√¨ ƒë√≥, b·∫°n c·∫ßn x√¢y d·ª±ng m√¥ h√¨nh ƒë·ªãnh l∆∞·ª£ng n√≥, v√≠ d·ª• nh∆∞ d∆∞·ªõi ·∫£nh n√†y ta ƒëang c√≥ m√¥ h√¨nh [MILP](https://www.mathworks.com/help/optim/ug/mixed-integer-linear-programming-algorithms.html) nh·∫±m ho·∫°ch ƒë·ªãnh tuy·∫øn ƒë∆∞·ªùng v√† t·ªëi ∆∞u h√≥a qu√£ng ƒë∆∞·ªùng di chuy·ªÉn.\n\n```{=html}\n<div style=\"text-align: center; margin-bottom: 20px;\">\n  <img src=\"img/MILP.png\" style=\"max-width: 100%; height: auto; display: block; margin: 0 auto;\">\n  \n  <!-- Picture Name -->\n  <div style=\"text-align: left; margin-top: 10px;\">\n    H√¨nh 2: M√¥ h√¨nh VRP\n  </div>\n  \n  <!-- Source Link -->\n  <div style=\"text-align: right; font-style: italic; margin-top: 5px;\">\n    Source: <a href=\"https://medium.com/@rihot_gusron/capacitated-vehicle-routing-problem-with-lingo-427c2d3bf724\">Link to Image</a>\n  </div>\n</div>\n```\n\nM·ª•c ti√™u c·ªßa h√†m ch√≠nh l√† t√¨m ra gi√° tr·ªã nh·ªè nh·∫•t nghƒ©a l√† chi ph√≠ cho vi·ªác di chuy·ªÉn c·ªßa xe l√† nh·ªè nh·∫•t. Do ƒë√≥, b·∫°n c√≥ th·ªÉ h√¨nh dung r·∫±ng **gi√° tr·ªã nh·ªè nh·∫•t** ƒë√≥ nh∆∞ l√† c√°c **c√° th·ªÉ ƒë·ªôt bi·∫øn** c√≥ kh·∫£ nƒÉng s·ªëng s√≥t cao nh·∫•t trong qu·∫©n th·ªÉ.\n\nV√¨ v·∫≠y thu·∫≠t to√°n **Genetic** (GA) ch√≠nh l√† l·∫∑p ƒëi l·∫∑p l·∫°i s·ª± ch·ªçn l·ªçc t·ª± nhi√™n trong m·ªôt qu·∫ßn th·ªÉ ho·∫∑c m·ªôt m·∫´u ƒë·ªÉ ƒë·∫øn cu·ªëi c√πng t√¨m ra c√° th·ªÉ v∆∞·ª£t tr·ªôi nh·∫•t.\n\n## C√°ch ho·∫°t ƒë·ªông GA trong ML:\n\nTrong Machine Learning, GA nh·∫±m t√¨m ra ƒë√∫ng c√°c bi·∫øn c·∫ßn thi·∫øt ƒë·ªÉ x√¢y d·ª±ng m√¥ h√¨nh t·ªët nh·∫•t. G·ªâa s·ª≠ ch√∫ng ta c√≥ 2 m√¥ h√¨nh l√†:\n\n-   M√¥ h√¨nh 1: g·ªìm c√°c bi·∫øn A,C,D.\n-   M√¥ h√¨nh 2: g·ªìm bi·∫øn A,B,E.\n\nV·∫≠y m√¥ h√¨nh n√†o m·ªõi l√† t·ªët nh·∫•t cho m√¥ h√¨nh d·ª± ƒëo√°n ? Ch√∫ng ta ch∆∞a bi·∫øt ƒë∆∞·ª£c v√† ch·ªâ c√≥ th·ªÉ so s√°nh n√≥ th√¥ng qua thu·∫≠t to√°n Genetic.\n\nV·ªÅ quy tr√¨nh, thu·∫≠t to√°n Genetic s·∫Ω c√≥ c√°ch ho·∫°t ƒë·ªông nh∆∞ d∆∞·ªõi ƒë√¢y. Quy tr√¨nh n√†y m√¨nh tham kh·∫£o c·ªßa [@rohithgandhi2018].\n\n```{=html}\n<div style=\"text-align: center; margin-bottom: 20px;\">\n  <img src=\"img/Genetic_Algorithm.png\" style=\"max-width: 100%; height: auto; display: block; margin: 0 auto;\">\n  \n  <!-- Picture Name -->\n  <div style=\"text-align: left; margin-top: 10px;\">\n    H√¨nh 3: Thu·∫≠t to√°n Genetic\n  </div>\n  \n  <!-- Source Link -->\n  <div style=\"text-align: right; font-style: italic; margin-top: 5px;\">\n    Source: <a href=\"https://medium.datadriveninvestor.com/genetic-algorithms-9f920939f7cc\">Link to Image</a>\n  </div>\n</div>\n```\n\nDi·ªÖn gi·∫£i c√°ch ho·∫°t ƒë·ªông:\n\n-   B∆∞·ªõc 1 (**Initialisation**): m·ªói bi·∫øn ƒë∆∞·ª£c xem l√† *Gene* v√† nhi·ªÅu *Gene* g·ªôp l·∫°i th√†nh m·ªôt m√¥ h√¨nh hay g·ªçi l√† *Chromosome* v√† nhi·ªÅu *Chromosome* s·∫Ω t·∫°o th√†nh m·ªôt qu·∫ßn th·ªÉ (*Population*). Vi·ªác n√†y gi·ªëng nh∆∞ l√† b·∫°n ƒëang tr√¨nh b√†y h·∫øt c√°c ph∆∞∆°ng √°n c√≥ th·ªÉ s·ª≠ d·ª•ng.\n\n```{=html}\n<div style=\"text-align: center; margin-bottom: 20px;\">\n  <img src=\"img/Term.png\" style=\"max-width: 100%; height: auto; display: block; margin: 0 auto;\">\n  \n  <!-- Picture Name -->\n  <div style=\"text-align: left; margin-top: 10px;\">\n    H√¨nh 4: C√°c thu·∫≠t ng·ªØ trong GA\n  </div>\n  \n  <!-- Source Link -->\n  <div style=\"text-align: right; font-style: italic; margin-top: 5px;\">\n    Source: <a href=\"https://www.doc.ic.ac.uk/research/technicalreports/2003/DTR03-4.pdf\">Link to Image</a>\n  </div>\n</div>\n```\n\n-   B∆∞·ªõc 2 (**Fitness Function**): B·∫°n c·∫ßn x√¢y d·ª±ng m·ªôt h√†m m·ª•c ti√™u ƒë·ªÉ t√≠nh to√°n gi√° tr·ªã cho c√°c m√¥ h√¨nh ·ªü b∆∞·ªõc 1.\n\n-   B∆∞·ªõc 3 (**Selection**): Bi·∫øn n√†o c√≥ gi√° tr·ªã y·∫øu k√©m s·∫Ω b·ªã lo·∫°i v√† qu√° tr√¨nh t√≠nh to√°n s·∫Ω ti·∫øp t·ª•c ·ªü th·∫ø h·ªá c·ªßa n√≥ ti·∫øp theo. Di·ªÖn gi·∫£i ƒë∆°n gi·∫£n h∆°n l√† ch√∫ng ta th·ª≠ m·ªôt c√°ch kh√°c v√† c·ªë g·∫Øng c·∫£i thi·ªán k·∫øt qu·∫£.\n\n-   B∆∞·ªõc 4 (**Crossover**): T·∫°o ra m√¥ h√¨nh g·ªìm c√°c bi·∫øn t·ªët ƒë√£ l·ª±a ch·ªçn ·ªü b∆∞·ªõc 3. V√≠ d·ª• nh∆∞ bi·∫øn A, B l√† t·ªët cho m√¥ h√¨nh.\n\n-   B∆∞·ªõc 5 (**Mutation**): Thay ƒë·ªïi m√¥ h√¨nh ƒë·∫ßu v√†o ƒë√£ bao g·ªìm c√°c bi·∫øn ·ªü b∆∞·ªõc 4 v√† b·∫Øt ƒë·∫ßu l·∫°i t·ª´ b∆∞·ªõc 1. V√≠ d·ª• m√¥ h√¨nh c·∫ßn ch·ªçn g·ªìm 5 bi·∫øn v√† ta ƒë√£ ch·ªçn ƒë∆∞·ª£c bi·∫øn A,B l√† t·ªët. Do ƒë√≥, khi quay l·∫°i b∆∞·ªõc 1, ta ch·ªâ c·∫ßn ch·ªçn th√™m 3 bi·∫øn thay v√¨ 5 bi·∫øn nh∆∞ th√¥ng th∆∞·ªùng.\n\n# Th·ª±c h√†nh trong R:\n\nSau khi ƒë√£ s∆° l∆∞·ª£c v·ªÅ thu·∫≠t to√°n, b√¢y gi·ªù ta s·∫Ω v√†o ph·∫ßn th·ª±c h√†nh trong R. V·∫≠y l√†m sao ƒë·ªÉ ·ª©ng d·ª•ng thu·∫≠t to√°n Genetic trong R, m√¨nh ƒë√£ kham kh·∫£o qua nhi·ªÅu ngu·ªìn t√†i li·ªáu v√† t·ªïng h·ª£p d∆∞·ªõi ƒë√¢y:\n\n**X√¢y d·ª±ng h√†m m·ª•c ti√™u**: h√†m m·ª•c ti√™u l√† b∆∞·ªõc quan tr·ªçng nh·∫•t trong thu·∫≠t to√°n Genetic v√¨ n√≥ l√† c∆° s·ªü ƒë·ªÉ ƒë√°nh gi√° v√† l·ª±a ch·ªçn c√° th·ªÉ v∆∞·ª£t tr·ªôi nh·∫•t. V√† h√†m m·ª•c ti√™u s·∫Ω lu√¥n kh√°c nhau t√πy v√†o v·∫•n ƒë·ªÅ m√† ta ƒë·∫∑t ra. Gi·∫£ s·ª≠ ch√∫ng ta mu·ªën t·ªëi ∆∞u chi ph√≠ th√¨ n√≥ l√† h√†m Min, c√≤n ta mu·ªën t·ªëi ƒëa l·ª£i nhu·∫≠n th√¨ n√≥ s·∫Ω l√† h√†m Max.\n\nV·∫≠y h√†m m·ª•c ti√™u c·ªßa b√†i to√°n tr√™n trong R, b·∫°n c√≥ th·ªÉ tham kh·∫£o ph·∫ßn code b√™n d∆∞·ªõi m√¨nh:\n\n::: callout-important\n### Type of fitness function\n\nƒê·ªëi s·ªë `type` trong h√†m c√≥ 3 gi√° tr·ªã:\n\n-   `\"binary\"`: ƒë·∫°i di·ªán cho bi·∫øn quy·∫øt ƒë·ªãnh d·∫°ng ph√¢n lo·∫°i, v√≠ d·ª•: c√≥/kh√¥ng\n-   `\"real-valued\"`: d√πng d·ªÉ t·ªëi ∆∞u cho c√°c bi·∫øn quy·∫øt ƒë·ªãnh l√† d·∫°ng s·ªë th·ª±c, s·ªë t·ª± nhi√™n.\n-   `\"permutation\"`: cho c√°c v·∫•n ƒë·ªÅ li√™n quan ƒë·∫øn vi·ªác s·∫Øp x·∫øp l·∫°i c√°c bi·∫øn th√†nh danh s√°ch, v√≠ d·ª•: thang ƒëo Likert.\n:::\n\nChi ti·∫øt v·ªÅ h√†m `ga()`, b·∫°n c√≥ th·ªÉ tham kh·∫£o t√†i li·ªáu c·ªßa [@lucascrucca2013].\n\n## Thu·∫≠t to√°n Genetic:\n\nV·∫≠y b√¢y gi·ªù ch√∫ng ta s·∫Ω x·ª≠ l√≠ b√†i to√°n tr√™n theo thu·∫≠t to√°n **Genetic**\n\nG·ªâa s·ª≠ ch√∫ng ta c√≥ b√†i to√°n v·ªÅ v·∫≠n chuy·ªÉn h√†ng t·ª´ nh√† kho ƒë·ªÉ th·ªèa m√£n nhu c·∫ßu ·ªü c√°c ƒëi·ªÉm **DC (Distribution center)**. V√† c√¥ng th·ª©c ƒë·ªÉ t√≠nh to√°n ƒë∆∞·ª£c chi ph√≠ l√†:\n\nH√†m chi ph√≠ t·ªïng th·ªÉ ƒë∆∞·ª£c x√°c ƒë·ªãnh nh∆∞ sau:\n\n$$\nTC = \\sum_{i=1}^{m} \\left( D_{ij} \\times \\frac{P}{F} \\times 0.4 + LC_i \\right) \\times Q_j\n$$\n\nTrong b√†i to√°n n√†y, b·∫°n s·∫Ω c·∫ßn d·ªØ li·ªáu ƒë·ªÉ t√≠nh to√°n 2 th√¥ng s·ªë l√†: **Ph√≠ b·ªëc x·∫øp (Loading cost)** v√† **Chi ph√≠ v·∫≠n chuy·ªÉn (Transportation cost)**.\n\nN·∫øu trong c√¥ng vi·ªác th∆∞·ªùng ng√†y ·ªü c√¥ng ty, ch√∫ng ta s·∫Ω c·∫ßn l·∫•y d·ªØ li·ªáu t·ª´ **Data warehouse** b·∫±ng SQL ho·∫∑c c√°c ph·∫ßn m·ªÅm **Business Intelligence** kh√°c. ·ªû ƒë√¢y, nh·∫±m m·ª•c ƒë√≠ch h·ªçc t·∫≠p, m√¨nh ƒë√£ t·∫°o ra code ·ªü ph√≠a d∆∞·ªõi ƒë·ªÉ x√¢y d·ª±ng d·ªØ li·ªáu cho c√°c b·∫°n luy·ªán t·∫≠p.\n\n```{r}\n# Create a data frame for loading costs\nloading_costs <- data.frame(\n  Warehouse = rep(paste(\"WH\", 1:5), each = 4),\n  ID = rep(1:5, times = 4),\n  Weight_Category = rep(c(\"< 2 tons\", \"2 to 5 tons\", \"5 to 10 tons\", \"> 10 tons\"), times = 5),\n  Has_Machine = rep(c(\"Yes\", \"No\", \"Yes\", \"No\", \"No\"), each = 4),\n  Loading_Cost = c(80, 100, 120, 160,  # Warehouse 1 (with machine)\n                   110, 150, 180, 210,  # Warehouse 2 (without machine)\n                   85, 105, 125, 140,  # Warehouse 3 (with machine)\n                   150, 170, 190, 210,  # Warehouse 4 (without machine)\n                   140, 165, 185, 215)   # Warehouse 5 (without machine)\n)\n\n# Set seed for reproducibility\nset.seed(123)\n\n# Define parameters\nweight_categories <- c(\"< 1.5\", \"1.5 to 2.5\", \"2.5 to 5\", \"5 to 10\", \"> 10\")\n# Create the data frame\nloading_costs <- data.frame(\n  Warehouse = rep(1:5, each = 15),  # 5 warehouses, 15 rows each\n  DC = rep(rep(1:3, each = 5), times = 5),  # Repeat 1, 2, 3 for each warehouse\n  Weight_Category = rep(weight_categories, times = 15),  # Repeat categories for 15 rows\n  Loading_Cost = round(runif(75, 5, 150), 2),\n  Has_Machine = sample(c(\"Yes\", \"No\"), 75, replace = TRUE)\n)\n\n# Define warehouses with coordinates (latitude, longitude)\nwarehouses <- data.frame(\n  ID = 1:5,\n  Latitude = c(21.0285, 16.0545, 10.7769, 14.0583, 19.8060), # Example latitudes (Hanoi, HCMC, Da Nang, etc.)\n  Longitude = c(105.804, 108.2022, 106.6957, 108.2772, 105.7460) # Example longitudes\n)\n\n# Define distribution centers data in Vietnam (example coordinates)\ndistribution_centers <- data.frame(\n  ID = 1:3,\n  Demand = c(90, 30, 150),\n  Latitude = c(17.974855, 11.7769, 15.122327), # Example latitudes (Hanoi, Da Nang, HCMC)\n  Longitude = c(102.630867, 106.6957, 108.799357) # Example longitudes\n)\n```\n\nN·∫øu b·∫°n t·ª´ng g·∫∑p kh√≥ khƒÉn trong vi·ªác ph·∫£i ƒë·ªëi m·∫∑t v·ªõi c·∫£ ƒë·ªëng d·ªØ li·ªáu t·ª´ h·ªá th·ªëng v√† ch∆∞a bi·∫øt l·∫•y d·ªØ li·ªáu n√†o ƒë·ªÉ ph√¢n t√≠ch ho·∫∑c g·ªôp b·∫£ng n√†o qua b·∫£ng n√†o th√¨ l·ªùi khuy√™n c·ªßa m√¨nh l√† h√£y v·∫Ω b·∫£ng **Entity relation diagram (ERD)**.\n\n**ERD** l√† m·ªôt c√¥ng c·ª• tr·ª±c quan d√πng ƒë·ªÉ m√¥ t·∫£ c·∫•u tr√∫c d·ªØ li·ªáu trong c∆° s·ªü d·ªØ li·ªáu. ERD th·ªÉ hi·ªán c√°c th·ª±c th·ªÉ (*entities*), thu·ªôc t√≠nh (*attributes*), v√† c√°c m·ªëi quan h·ªá (*relationships*) gi·ªØa ch√∫ng. C√°c th·ª±c th·ªÉ th∆∞·ªùng ƒë∆∞·ª£c bi·ªÉu di·ªÖn d∆∞·ªõi d·∫°ng h√¨nh ch·ªØ nh·∫≠t, thu·ªôc t√≠nh d∆∞·ªõi d·∫°ng h√¨nh ellips, v√† m·ªëi quan h·ªá b·∫±ng h√¨nh thoi ho·∫∑c ƒë∆∞·ªùng n·ªëi. ERD gi√∫p l·∫≠p k·∫ø ho·∫°ch cho thi·∫øt k·∫ø c∆° s·ªü d·ªØ li·ªáu, ƒë·∫£m b·∫£o r·∫±ng c√°c y·∫øu t·ªë d·ªØ li·ªáu v√† quan h·ªá gi·ªØa ch√∫ng ƒë∆∞·ª£c x√°c ƒë·ªãnh r√µ r√†ng, t·∫°o n·ªÅn t·∫£ng cho vi·ªác ph√°t tri·ªÉn v√† qu·∫£n l√Ω d·ªØ li·ªáu hi·ªáu qu·∫£.\n\nNh∆∞ bi·ªÉu ƒë·ªì d∆∞·ªõi ƒë√¢y, m√¨nh ƒëang c√≥ 3 b·∫£ng g·ªìm:\n\n-   B·∫£ng th√¥ng tin chi ti·∫øt v·ªÅ DC.\n\n-   B·∫£ng th√¥ng tin chi ti·∫øt v·ªÅ WH.\n\n-   B·∫£ng gi√° v·ªÅ loading cost v√† transportation cost t·ª´ WH ƒë·∫øn DC.\n\nV√† c√°c b·∫°n c√≥ th·ªÉ d·ªÖ d√†ng h√¨nh dung c√°c m·ªëi quan h·ªá th√¥ng qua b·∫£ng **Entity relation diagram (ERD)** d∆∞·ªõi ƒë√¢y:\n\n```{r}\n#| echo: false\n#| fig-subcap: \"Bi·ªÉu ƒë·ªì 1: EDR model\"\nlibrary(datamodelr)\n# Create the data model from your data frames\ndm1 <- dm_from_data_frames(list(\n  Warehouses = warehouses,\n  Loading_Costs = loading_costs,\n  Distribution_Centers = distribution_centers\n)) %>%\n  dm_set_key(\"Warehouses\", \"ID\") %>%\n  dm_set_key(\"Loading_Costs\", c(\"Warehouse\", \"DC\")) %>%\n  dm_set_key(\"Distribution_Centers\", \"ID\") %>%\n  dm_add_references(\n    Loading_Costs$Warehouse == Warehouses$ID,  # Correct reference\n    Loading_Costs$DC == Distribution_Centers$ID  # Assuming this is the correct reference\n  )\n\n# Create and render the ERD\ndm_create_graph(dm1, rankdir = \"LR\", columnArrows = TRUE) %>%\n  dm_render_graph()\n```\n\n::: callout-tip\n### T·∫£i package datamodelr:\n\nM√¨nh t·∫°o bi·ªÉu ƒë·ªì n√†y b·∫±ng th∆∞ vi·ªán `datamodelr`. B·∫°n c√≥ th·ªÉ t·∫£i b·∫±ng c√∫ ph√°p: `devtools::install_github(\"bergant/datamodelr\")`\n:::\n\n### D·ªØ li·ªáu ƒë·∫ßu v√†o:\n\nNh∆∞ v·∫≠y, d·ª±a v√†o ƒë√≥, ta s·∫Ω t√≠nh to√°n ƒë∆∞·ª£c 2 *matrix* v·ªÅ chi ph√≠:\n\n-   B·∫£ng gi√° loading ·ªü c√°c kho. (H√¨nh b√™n tr√°i)\n\n-   B·∫£ng chi ph√≠ v·∫≠n chuy·ªÉn t·ª´ t·ª´ng WH ƒë·∫øn c√°c DCs. (H√¨nh b√™n ph·∫£i)\n\n```{r}\n#| warning: false\n#| message: false\n## Calculate the transportation cost:\n# Haversine distance function\nhaversine <- function(lat1, lon1, lat2, lon2) {\n  R <- 6371 # Radius of Earth in kilometers\n  dlat <- (lat2 - lat1) * pi / 180\n  dlon <- (lon2 - lon1) * pi / 180\n  a <- sin(dlat / 2) * sin(dlat / 2) +\n       cos(lat1 * pi / 180) * cos(lat2 * pi / 180) * \n       sin(dlon / 2) * sin(dlon / 2)\n  c <- 2 * atan2(sqrt(a), sqrt(1 - a))\n  R * c # Distance in kilometers\n}\n\n# Calculate distance matrix based on coordinates\ndistance_matrix <- matrix(0, nrow = nrow(warehouses), ncol = nrow(distribution_centers))\n\nfor (i in 1:nrow(warehouses)) {\n  for (j in 1:nrow(distribution_centers)) {\n    distance_matrix[i, j] <- haversine(\n      warehouses$Latitude[i], warehouses$Longitude[i],\n      distribution_centers$Latitude[j], distribution_centers$Longitude[j]\n    )\n  }\n}\n\n# Define the fuel price (example value)\nfuel_price <- 20 # Fuel price per kilometer\n\n# Calculate transportation costs\ntransportation_costs <- distance_matrix * fuel_price * 0.4\n\n## Calculate the loading cost:\nweights_per_good <- 0.1\n\nmean_loading_cost<-loading_costs %>% \n  group_by(DC, Warehouse) %>% \n  summarise(mean = mean(Loading_Cost,na.rm = TRUE)/1000/weights_per_good) %>% # Assumes weighted of goods is 0.1kg \n  ungroup()\n\nlibrary(data.table)\n# Reshape the data frame to a wide format\nmean_cost_matrix <- reshape2::dcast(mean_loading_cost,\n                          Warehouse ~ DC, \n                          value.var = \"mean\")\n\n# Convert the data frame to a matrix and remove the Warehouse column\nloading_costs_per_dc <- as.matrix(mean_cost_matrix[,-1])\n\n# Set row names as the warehouse names\nrownames(loading_costs_per_dc) <- mean_loading_cost$Warehouse[!duplicated(mean_loading_cost$Warehouse)]\n```\n\n```{r}\n#| warning: false\n#| message: false\n#| echo: false\n#| fig-cap: \"T·ªïng c√°c phi ph√≠ cho vi·ªác b·ªëc x·∫øp v√† v·∫≠n chuy·ªÉn h√†ng h√≥a\"\n#| fig-subcap: [\"Bi·ªÉu ƒë·ªì 2: Heatmap cho b·∫£ng chi ph√≠ b·ªëc x·∫øp\", \"Bi·ªÉu ƒë·ªì 3: B·∫£ng gi√° v·∫≠n chuy·ªÉn t·ª´ WH ƒë·∫øn DC\"]\n#| layout-ncol: 2\n# Code t·∫°o hai bi·ªÉu ƒë·ªì\n\nlibrary(ggplot2)\n\n# Convert the distance matrix to a data frame\ndistance_df <- reshape2::melt(transportation_costs)\ncolnames(distance_df) <- c(\"Warehouse\", \"Distribution_Center\", \"Transportation_Cost\")\n\n# Plot the distance matrix with updated colors\nggplot(distance_df, aes(x = Warehouse, \n                        y = Distribution_Center, \n                        fill = Transportation_Cost)) +\n  geom_tile(color = \"white\", linewidth = 0.5) +  # Add borders to tiles\n  geom_text(aes(label = scales::comma(Transportation_Cost, accuracy = 1)), \n            color = ifelse(distance_df$Transportation_Cost > \n                           max(distance_df$Transportation_Cost)/2, \"white\", \"black\"),\n            size = 3.5) +  # Adaptive text color\n  scale_fill_gradient2(\n    low = \"#f7fbff\", \n    mid = \"#6baed6\", \n    high = \"#08519c\",\n    midpoint = median(distance_df$Transportation_Cost),\n    name = \"Cost (VNƒê)\",\n    labels = scales::comma\n  ) +\n  theme_minimal() +\n  labs(\n    title = \"Transportation Costs Between Facilities\",\n    subtitle = \"Costs shown in Vietnamese Dong (VNƒê)\",\n    x = \"Warehouse\",\n    y = \"Distribution Center\"\n  ) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1, face = \"bold\", size = 12),\n    axis.text.y = element_text(face = \"bold\", size = 12),\n    axis.title.x = element_text(size = 14, face = \"bold\", margin = margin(t = 15)),\n    axis.title.y = element_text(size = 14, face = \"bold\", margin = margin(r = 15)),\n    plot.title = element_text(face = \"bold\", size = 16),\n    plot.subtitle = element_text(size = 12, color = \"gray30\"),\n    panel.grid = element_blank(),  # Remove grid lines\n    legend.position = \"right\"\n  )\n\n# Convert the transportation costs matrix to a data frame\nlibrary(gt)\nlibrary(gtExtras)\n# Create a gt table\nm<-loading_costs %>%\n  mutate(Loading_Cost = Loading_Cost * 1000,\n         DC = paste(\"DC\",DC),\n         Warehouse = paste(\"WH\",Warehouse)) # Convert to currency\n  \nhead(m[order(-m$Loading_Cost),]) %>% \n  gt() %>%\n  fmt_currency(\n    columns = Loading_Cost,\n    currency = \"VND\",\n    decimals = 0,\n    use_seps = TRUE\n  ) %>%\n  tab_header(\n    title = md(\"**Loading Costs by weight category in each warehouses**\"),\n    subtitle = md(\"Table just contains **expected loading cost**\")\n  ) %>%  \n  opt_align_table_header(align = \"center\") %>% \n  cols_label(\n    Loading_Cost = \"Loading Cost (VNƒê)\",\n    Weight_Category = \"Weight Category\",\n    Has_Machine = \"Has Machine\",\n    DC = \"Distribution Center\"\n  ) %>% \n  data_color(method = \"numeric\",\n             palette = \"viridis\",\n             reverse = TRUE) %>% \n  gt_theme_pff() %>% \n  tab_style(style = list(cell_text(align = \"center\")),\n            locations = cells_body(columns = everything())) %>%\n  tab_style(\n    style = list(\n      cell_text(align = \"center\")\n    ),\n    locations = list(\n      cells_column_labels(everything())\n    )\n  ) %>% \n  tab_source_note(source = md(\"*Source: package gt in R*\")) %>% \n  tab_style(\n    style = \"font-weight: bold\",\n    locations = cells_body(Weight_Category)\n  )\n  \n```\n\n### X√¢y d·ª±ng h√†m m·ª•c ti√™u:\n\nSau khi ƒë√£ c√≥ ƒë·ªß d·ªØ li·ªáu, b·∫°n s·∫Ω b·∫Øt ƒë·∫ßu vi·∫øt h√†m m·ª•c ti√™u v√† d√πng thu·∫≠t to√°n GA ƒë·ªÉ t√¨m ra gi√° tr·ªã t·ªëi ∆∞u nh·∫•t.\n\nTrong h√†m `ga` t·ª´ g√≥i **GA** trong R, c√≥ m·ªôt s·ªë ƒë·ªëi s·ªë quan tr·ªçng cho ph√©p b·∫°n t√πy ch·ªânh thu·∫≠t to√°n di truy·ªÅn. D∆∞·ªõi ƒë√¢y l√† m·ªôt c√°i nh√¨n t·ªïng quan v·ªÅ m·ªôt s·ªë ƒë·ªëi s·ªë quan tr·ªçng:\n\n-   **type**: Ch·ªâ ƒë·ªãnh lo·∫°i t·ªëi ∆∞u h√≥a (v√≠ d·ª•: `\"real-valued\"`, `\"binary\"` ho·∫∑c `\"permutation\"`).\n\n-   **fitness**: H√†m ƒë√°nh gi√° ƒë·ªô ph√π h·ª£p; n√≥ n√™n nh·∫≠n m·ªôt vector tham s·ªë l√†m ƒë·∫ßu v√†o v√† tr·∫£ v·ªÅ m·ªôt gi√° tr·ªã s·ªë.\n\n-   **lower** v√† **upper**: ƒê·ªãnh nghƒ©a gi·ªõi h·∫°n cho c√°c bi·∫øn n·∫øu b·∫°n ƒëang t·ªëi ∆∞u h√≥a trong kh√¥ng gian li√™n t·ª•c (d√πng cho c√°c lo·∫°i gi√° tr·ªã th·ª±c).\n\n-   **popSize**: Thi·∫øt l·∫≠p k√≠ch th∆∞·ªõc qu·∫ßn th·ªÉ cho m·ªói th·∫ø h·ªá.\n\n-   **maxiter**: Ch·ªâ ƒë·ªãnh s·ªë th·∫ø h·ªá t·ªëi ƒëa ƒë·ªÉ ch·∫°y thu·∫≠t to√°n.\n\n-   **run**: Ch·ªâ ƒë·ªãnh s·ªë th·∫ø h·ªá ƒë·ªÉ ch·∫°y thu·∫≠t to√°n m√† kh√¥ng c√≥ s·ª± c·∫£i thi·ªán tr∆∞·ªõc khi d·ª´ng l·∫°i.\n\n-   **pmutation**: X√°c su·∫•t x·∫£y ra ƒë·ªôt bi·∫øn trong qu·∫ßn th·ªÉ.\n\n-   **elitism**: X√°c ƒë·ªãnh xem c√°c c√° th·ªÉ t·ªët nh·∫•t c√≥ n√™n ƒë∆∞·ª£c gi·ªØ l·∫°i trong th·∫ø h·ªá ti·∫øp theo hay kh√¥ng.\n\nNh·ªØng ƒë·ªëi s·ªë n√†y gi√∫p ƒëi·ªÅu ch·ªânh thu·∫≠t to√°n di truy·ªÅn cho c√°c nhu c·∫ßu t·ªëi ∆∞u h√≥a c·ª• th·ªÉ c·ªßa b·∫°n, cho ph√©p hi·ªáu su·∫•t t·ªët h∆°n v√† h·ªôi t·ª• v·ªÅ c√°c gi·∫£i ph√°p t·ªëi ∆∞u.\n\nNgo√†i ra, c√≤n c√≥ c√°c l∆∞u √Ω cho b·∫°n khi s·ª≠ d·ª•ng R nh∆∞ sau:\n\n::: callout-caution\n### L∆∞u √Ω khi d√πng h√†m ga():\n\nH√†m `ga()` ph·∫£i c√≥ √≠t nh·∫•t 2 ƒë·ªëi s·ªë l√† `type` v√† `fitness th√¨ R m·ªõi ch·∫°y ƒë∆∞·ª£c.`\n\n-   Ri√™ng khi type = \"binary\" th√¨ c·∫ßn th√™m ƒë·ªëi s·ªë `nBits.`\n\n-   C√≤n khi `type = \"real-valued\"/\"permutation\"` th√¨ c·∫ßn th√™m ƒë·ªëi s·ªë `min` v√† `max`.\n:::\n\n```{r}\n#| message: false\n#| warning: false\n#| output: false\n# Load necessary library\nlibrary(GA)\ndemand<-c(distribution_centers$Demand)\n\n# Define the objective function\nobjective_function <- function(quantities) {\n    quantities_matrix <- matrix(quantities, \n                                nrow = 5, \n                                ncol = 3, \n                                byrow = TRUE)\n    \n    # Calculate total loading costs\n    loading_costs <- rowSums(quantities_matrix) * loading_costs_per_dc  # Total loading costs for each DC\n    # Calculate total transportation costs\n    transportation_costs <- sum(quantities_matrix * transportation_costs)\n    \n    # Combine both costs\n    total_cost <- sum(loading_costs) + transportation_costs\n    \n    # Check if demands are met\n    if (any(colSums(quantities_matrix) < demand)) {\n        return(Inf)  # Penalize if demands are not met\n    }\n    \n    return(total_cost)\n}\n\n# Set up the Genetic Algorithm\nnum_vars <- 5 * 3  # 5 warehouses, 3 distribution centers\nga_result <- ga(\n    type = \"real-valued\",\n    fitness = function(x) -objective_function(x),  # Negate for minimization\n    lower = rep(0, num_vars),  # Minimum quantity\n    upper = rep(100, num_vars),  # Maximum quantity (adjust as needed)\n    popSize = 50,\n    maxiter = 100,\n    run = 10,\n    monitor = TRUE\n)\n```\n\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\nlibrary(leaflet)\n## Update flag of countries in each locations:\nlibrary(readxl)\nwrite <- read_excel(\"write.xlsx\")\nwarehouses<-write[1:5,]\ndistribution_centers<-write[6:8,]\n```\n\n```{r}\n#| warning: false\n#| message: false\n# Assuming ga_result@solution contains optimal quantities\nga_result_solution <- c(ga_result@solution)\n\n# Reshape the solution into a matrix (5 warehouses x 3 DCs)\noptimal_quantities <- matrix(ga_result@solution,\n                             nrow = 5, \n                             ncol = 3, \n                             byrow = TRUE)\n\n# Convert the matrix to a data frame\nweights<-optimal_quantities* weights_per_good\n\nrownames(weights) <- 1:5\ncolnames(weights) <- 1:3\n\nlibrary(reshape2)\nreal_weighted <- melt(weights)\n\n# Rename the columns\ncolnames(real_weighted) <- c(\"Warehouse\", \"DC\", \"Total_Weight\")\n\n# Perform left join\nresult <- real_weighted %>%\n  left_join(loading_costs, by = c(\"Warehouse\", \"DC\"))\n\nresult <-result %>% \n  mutate(Price = case_when(\n    Total_Weight < 1.5 ~ \"< 1.5\",\n    Total_Weight <2.5 ~ \"1.5 to 2.5\",\n    Total_Weight < 5 ~ \"2.5 to 5\",\n    Total_Weight < 10 ~ \"5 to 10\",\n    Total_Weight >= 10 ~ \"> 10\",\n      is.na(Total_Weight) ~ NA_character_  # Handle NA explicitly if needed\n  ))\n  \nresult<-result %>% \n  filter(Weight_Category == Price) %>% \n  select(-Price)\n\n# Join with tranportation cost table:\nrownames(transportation_costs) <- 1:5\ncolnames(transportation_costs) <- 1:3\n\ntransport<-melt(transportation_costs)\n\n# Rename the columns\ncolnames(transport) <- c(\"Warehouse\", \"DC\", \"Transport_cost\")\n\n\nresult<-left_join(result,\n                  transport,\n                  by=c(\"Warehouse\", \"DC\"))\n\n# Adjust:\n\nresult<-result %>% \n      mutate(Loading_Cost = Loading_Cost*1000,\n             Transport_cost = Transport_cost*1000,\n             DC = paste(\"DC\",DC),\n             Warehouse = paste(\"WH\",Warehouse)) \n\n# Reorder cols in table:\nresult<-result[,c(\"Warehouse\",\n                 \"DC\",\n                 \"Has_Machine\",\n                 \"Total_Weight\",\n                 \"Weight_Category\",\n                 \"Loading_Cost\",\n                 \"Transport_cost\")]\n```\n\n### B√°o c√°o:\n\nV√† cu·ªëi c√πng, sau khi c√≥ k·∫øt qu·∫£, m√¨nh s·∫Ω d√πng c√°c th∆∞ vi·ªán g·ªìm: **Leaflet**, **gt**, v√† **bi·ªÉu ƒë·ªì Sankey** ph·ª•c v·ª• nh·ªØng m·ª•c ƒë√≠ch kh√°c nhau cho tr·ª±c quan h√≥a d·ªØ li·ªáu.\n\n1.  **Leaflet**: ƒê√¢y l√† m·ªôt th∆∞ vi·ªán m·∫°nh m·∫Ω ƒë·ªÉ t·∫°o b·∫£n ƒë·ªì t∆∞∆°ng t√°c. N√≥ cho ph√©p ng∆∞·ªùi d√πng d·ªÖ d√†ng th√™m c√°c l·ªõp, ƒëi·ªÉm ƒë√°nh d·∫•u v√† pop-up, r·∫•t l√Ω t∆∞·ªüng ƒë·ªÉ tr·ª±c quan h√≥a d·ªØ li·ªáu ƒë·ªãa l√Ω. Leaflet ƒë·∫∑c bi·ªát h·ªØu √≠ch ƒë·ªÉ hi·ªÉn th·ªã c√°c d·ªØ li·ªáu nh∆∞ v·ªã tr√≠, l·ªô tr√¨nh, ho·∫∑c ph√¢n b·ªë kh√¥ng gian.\n\n2.  **gt**: G√≥i **gt** ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ t·∫°o ra c√°c b·∫£ng ch·∫•t l∆∞·ª£ng cao trong R. N√≥ cho ph√©p ng∆∞·ªùi d√πng ƒë·ªãnh d·∫°ng v√† t·∫°o ki·ªÉu cho b·∫£ng m·ªôt c√°ch d·ªÖ d√†ng, gi√∫p ch√∫ng tr·ªü n√™n h·∫•p d·∫´n v√† d·ªÖ ƒë·ªçc. gt h·ªó tr·ª£ c√°c t√≠nh nƒÉng nh∆∞ ƒë·ªãnh d·∫°ng t√πy ch·ªânh, d√≤ng t√≥m t·∫Øt, v√† th·∫≠m ch√≠ th√™m ch√∫ th√≠ch, n√¢ng cao c√°ch tr√¨nh b√†y d·ªØ li·ªáu trong b√°o c√°o.\n\n3.  **Bi·ªÉu ƒë·ªì Sankey**: Nh·ªØng bi·ªÉu ƒë·ªì n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ tr·ª±c quan h√≥a lu·ªìng v√† m·ªëi quan h·ªá gi·ªØa c√°c danh m·ª•c kh√°c nhau. Trong R, g√≥i **networkD3** ho·∫∑c **ggalluvial** c√≥ th·ªÉ t·∫°o ra bi·ªÉu ƒë·ªì Sankey, gi√∫p hi·ªÉu c√°ch c√°c gi√° tr·ªã di chuy·ªÉn gi·ªØa c√°c n√∫t, ch·∫≥ng h·∫°n nh∆∞ theo d√µi h√†nh tr√¨nh ng∆∞·ªùi d√πng ho·∫∑c hi·ªÉn th·ªã ph√¢n b·ªï t√†i nguy√™n.\n\nƒê·ªÉ k·∫øt n·ªëi c√°c bi·ªÉu ƒë·ªì l·∫°i v·ªõi nhau, ta th∆∞·ªùng nghƒ© ƒë·∫øn `Shiny` trong **R** nh∆∞ng v√¨ ch√∫ng ta ƒëang t·∫°o website b·∫±ng **Quarto** n√™n output cu·ªëi c√πng s·∫Ω l√† m·ªôt trang web tƒ©nh - *static website*. Do ƒë√≥, n√≥ s·∫Ω kh√¥ng ph·∫£n h·ªìi v·ªõi th√¥ng tin ƒë·∫ßu v√†o c·ªßa ng∆∞·ªùi d√πng ho·∫∑c ch·∫°y b·∫•t k·ª≥ m√£ R n√†o. B·∫°n c√≥ th·ªÉ h√¨nh dung gi·ªëng nh∆∞ b·∫°n ƒëang mu·ªën xem bi·ªÉu ƒë·ªì v·ªÅ doanh thu trong th√°ng ti·∫øp theo tr√™n 1 bi·ªÉu ƒë·ªì trong Word - kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c v√¨ n√≥ thu·ªôc d·∫°ng vƒÉn b·∫£n, b·∫°n ch·ªâ ƒë·ªçc ho·∫∑c nh√¨n ch·ª© kh√¥ng t∆∞∆°ng t√°c ƒë∆∞·ª£c.\n\nTuy v·∫≠y, sau m·ªôt th·ªùi gian t√¨m hi·ªÉu, m√¨nh c≈©ng t√¨m ƒë∆∞·ª£c c√°ch ƒë·ªÉ nh√∫ng **Shiny** v√†o R ƒë·ªÉ hi·ªÉn th·ªã tr√™n Quarto. Ngu·ªìn t√†i li·ªáu b·∫°n c√≥ th·ªÉ kham kh·∫£o ·ªü trang n√†y [r-shinylive-demo](https://github.com/coatless-quarto/r-shinylive-demo).\n\n:::{.column-page}\n\n```{shinylive-r}\n#| viewerHeight: 1000\n#| standalone: true\n#| fig-cap: \"Bi·ªÉu ƒë·ªì 3: Dashboard v·ªÅ l·ªãch tr√¨nh v·∫≠n chuy·ªÉn h√†ng d·ª± t√≠nh\"\npacman::p_load(\n  leaflet,\n  dplyr,\n  networkD3,\n  shiny,\n  bslib,\n  DT,\n  htmltools\n)\n\n# Add value:\n# Convert GA solution to a matrix\n# Optimal quantities matrix\noptimal_quantities <- matrix(c(\n  43.306058, 10.87137, 13.26283,\n  15.524054, 30.42748, 48.86716,\n  7.599769, 44.93531, 27.46289,\n  18.556927, 17.60396, 41.85203,\n  16.305016, 13.15498, 21.79634\n), nrow = 5, ncol = 3, byrow = TRUE)\n\n# Warehouse data:\nwarehouses <- data.frame(\n  ID = 1:5,\n  Latitude = c(21.0285, 16.0545, 10.7769, 14.0583, 19.8060),\n  Longitude = c(105.8040, 108.2022, 106.6957, 108.2772, 105.7460),\n  District = c(\"ƒê·ªëng ƒêa\", \"H·∫£i Ch√¢u\", \"Qu·∫≠n 1\", \"Mang Yang\", \"ƒê√¥ng S∆°n\"),\n  Province = c(\"H√† N·ªôi\", \"ƒê√† N·∫µng\", \"H·ªì Ch√≠ Minh\", \"Gia Lai\", \"Thanh H√≥a\"),\n  Address = c(\n    \"2RH3+9HX ƒê·ªëng ƒêa, H√† N·ªôi, Vi·ªát Nam\",\n    \"3632+RV4 H·∫£i Ch√¢u, ƒê√† N·∫µng, Vi·ªát Nam\",\n    \"QMGW+Q74 Qu·∫≠n 1, H·ªì Ch√≠ Minh, Vi·ªát Nam\",\n    \"375G+8VG Mang Yang, Gia Lai, Vi·ªát Nam\",\n    \"RP4W+99X ƒê√¥ng S∆°n, Thanh H√≥a, Vi·ªát Nam\"\n  )\n)\n\n# Distribution center data:\ndistribution_centers <- data.frame(\n  ID = 1:3,\n  Latitude = c(17.97486, 11.77690, 15.12233),\n  Longitude = c(102.6309, 106.6957, 108.7994),\n  District = c(\"Vi√™ng ChƒÉn\", \"L·ªôc Ninh\", \"Qu·∫£ng Ng√£i\"),\n  Province = c(\"L√†o\", \"B√¨nh Ph∆∞·ªõc\", \"Qu·∫£ng Ng√£i\"),\n  Address = c(\n    \"XJFJ+W8X Vi√™ng ChƒÉn, L√†o\",\n    \"QMGW+Q74 L·ªôc Ninh, B√¨nh Ph∆∞·ªõc, Vi·ªát Nam\",\n    \"4QCX+WPQ Qu·∫£ng Ng√£i, Vi·ªát Nam\"\n  )\n)\n\n# Create a data frame with the warehouse data\nresult <- data.frame(\n  Warehouse = c(\"WH 1\", \"WH 2\", \"WH 3\", \"WH 4\", \"WH 5\",\n                \"WH 1\", \"WH 2\", \"WH 3\", \"WH 4\", \"WH 5\",\n                \"WH 1\", \"WH 2\", \"WH 3\", \"WH 4\", \"WH 5\"),\n  DC = c(\"DC 1\", \"DC 1\", \"DC 1\", \"DC 1\", \"DC 1\",\n         \"DC 2\", \"DC 2\", \"DC 2\", \"DC 2\", \"DC 2\",\n         \"DC 3\", \"DC 3\", \"DC 3\", \"DC 3\", \"DC 3\"),\n  Has_Machine = c(\"Yes\", \"No\", \"No\", \"No\", \"No\",\n                  \"No\", \"No\", \"No\", \"No\", \"No\",\n                  \"No\", \"No\", \"No\", \"No\", \"No\"),\n  Total_Weight = c(4.3306058, 1.5524054, 0.7599769, 1.8556927, 1.6305016,\n                   1.0871366, 3.0427479, 4.4935308, 1.7603961, 1.3154977,\n                   1.3262832, 4.8867159, 2.7462887, 4.1852028, 2.1796338),\n  Weight_Category = c(\"2.5 to 5\", \"1.5 to 2.5\", \"< 1.5\", \"1.5 to 2.5\", \"1.5 to 2.5\",\n                      \"< 1.5\", \"2.5 to 5\", \"2.5 to 5\", \"1.5 to 2.5\", \"< 1.5\",\n                      \"< 1.5\", \"2.5 to 5\", \"2.5 to 5\", \"2.5 to 5\", \"1.5 to 2.5\"),\n  Loading_Cost = c(64300, 40680, 144640, 38790, 18750,\n                   11610, 97870, 36380, 69120, 70030,\n                   143740, 91150, 64990, 114230, 96240),\n  Transport_cost = c(3802097.2, 5037171.3, 7297102.2, 5952559.7, 3086494.5,\n                     8264855.3, 4021256.9, 889559.4, 2449208.3, 7188382.3,\n                     5831987.6, 974375.3, 4273915.6, 1047828.2, 4905804.6)\n)\n\n# Custom icon:\nwarehouse_icon <- makeIcon(\n  iconUrl = \"https://raw.githubusercontent.com/Loccx78vn/Genetic-Algorithm/refs/heads/main/warehouse_icon.png\",\n  iconWidth = 30,\n  iconHeight = 30\n)\n\ndc_icon <- makeIcon(\n  iconUrl = \"https://raw.githubusercontent.com/Loccx78vn/Genetic-Algorithm/refs/heads/main/distribution_center.png\",\n  iconWidth = 30,\n  iconHeight = 30\n)\n# Define a custom theme\nmy_theme <- bs_theme(\n  version = 5,\n  bootswatch = \"litera\",\n  primary = \"#3b5998\",\n  secondary = \"#5cb85c\",\n  success = \"#5cb85c\",\n  info = \"#5bc0de\",\n  warning = \"#f0ad4e\",\n  danger = \"#d9534f\"\n)\n\n# Define UI\nui <- page_fluid(\n  theme = my_theme,\n  \n  # Custom CSS for better visualization\n  tags$head(\n    tags$style(HTML(\"\n      .card-header {\n        background-color: #3b5998;\n        color: white;\n        font-weight: bold;\n      }\n      .nav-tabs .nav-link.active {\n        font-weight: bold;\n        color: #3b5998;\n        border-bottom: 2px solid #3b5998;\n      }\n      .nav-tabs .nav-link {\n        color: #6c757d;\n      }\n      .checkbox span {\n        font-weight: normal;\n      }\n      .checkbox input:checked + span {\n        font-weight: bold;\n        color: #3b5998;\n      }\n      .warehouse-selection {\n        border-left: 4px solid #3b5998;\n        padding-left: 10px;\n      }\n      .dataTables_wrapper {\n        padding: 10px;\n        border-radius: 5px;\n      }\n      .table thead th {\n        background-color: #e9ecef;\n      }\n      .leaflet-container {\n        border-radius: 8px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n      }\n      .sankey-container {\n        border: 1px solid #dee2e6;\n        border-radius: 8px;\n        padding: 10px;\n        background-color: #f8f9fa;\n      }\n      .summary-stats {\n        background-color: #f8f9fa;\n        border-radius: 5px;\n        padding: 10px;\n        margin-bottom: 15px;\n        border-left: 4px solid #3b5998;\n      }\n    \"))\n  ),\n  \n  # Page header - simplified\n  card(\n    card_header(\n      tags$div(\n        class = \"d-flex align-items-center\",\n        tags$img(\n          src = \"https://raw.githubusercontent.com/Loccx78vn/Genetic-Algorithm/refs/heads/main/warehouse_icon.png\", \n          height = \"30px\", \n          style = \"margin-right: 10px;\"\n        ),\n        h3(\"Warehouse Distribution Dashboard\", class = \"m-0\")\n      )\n    ),\n    card_body(\n      \"This dashboard shows the optimal distribution of goods from warehouses to distribution centers.\"\n    )\n  ),\n  \n  layout_sidebar(\n    sidebar = sidebar(\n      title = \"Controls\",\n      width = 300,\n      bg = \"#f8f9fa\",\n      class = \"warehouse-selection\",\n      \n      h4(\"Warehouse Selection\", class = \"mb-3 text-primary\"),\n      \n      p(\"Select one or more warehouses to view their distribution data on the map and in the charts.\"),\n      \n      checkboxGroupInput(\n        inputId = \"warehouse\", \n        label = NULL, \n        choices = setNames(\n          paste(\"Warehouse\", 1:5),\n          paste(\"Warehouse\", 1:5, \"-\", warehouses$District, \",\", warehouses$Province)\n        ),\n        selected = paste(\"Warehouse\", 1)\n      ),\n      \n      hr(),\n      \n      tags$div(\n        class = \"alert alert-info\",\n        icon(\"info-circle\"), \n        \"Click on the map markers for detailed location information.\"\n      )\n    ),\n    \n    # Main content - restructured to put summary above map\n    tabsetPanel(\n      tabPanel(\n        title = \"Interactive Map\", \n        icon = icon(\"map\"),\n        card(\n          full_screen = TRUE,\n          height = \"650px\", # Increased height\n          card_body(\n            # Summary stats placed above the map\n            tags$div(\n              class = \"summary-stats\",\n              uiOutput(\"summary_stats\")\n            ),\n            # Map with increased height\n            leafletOutput(\"map\", height = \"550px\") # Increased map height\n          )\n        )\n      ),\n      \n      tabPanel(\n        title = \"Cost Analysis\", \n        icon = icon(\"table\"),\n        card(\n          full_screen = TRUE,\n          height = \"650px\", # Increased to match\n          card_header(\"Cost Table\"),\n          DTOutput(\"cost_table\")\n        )\n      ),\n      \n      tabPanel(\n        title = \"Flow Diagram\", \n        icon = icon(\"diagram-project\"),\n        card(\n          full_screen = TRUE,\n          height = \"650px\", # Increased to match\n          card_header(\"Distribution Flow Diagram\"),\n          tags$div(\n            class = \"sankey-container\",\n            uiOutput(\"sankey_diagram\")\n          )\n        )\n      )\n    )\n  )\n)\n\n# Define server logic\nserver <- function(input, output, session) {\n  \n  location <- reactive({\n    req(input$warehouse) \n    as.numeric(sub(\"Warehouse \", \"\", input$warehouse))\n  })\n  \n  # Create the leaflet map\n  output$map <- renderLeaflet({\n    req(location())\n    \n    # Color palette for routes\n    route_colors <- c(\"#FF5733\", \"#33A8FF\", \"#33FF57\", \"#D433FF\", \"#FFD133\")\n    \n    # Initialize the map\n    map <- leaflet() %>%\n      addTiles() %>%\n      addProviderTiles(providers$CartoDB.Positron) %>%\n      addMarkers(data = warehouses %>% filter(ID %in% location()), \n                 lat = ~Latitude, \n                 lng = ~Longitude, \n                 label = ~paste0(\"<strong> ID Warehouse: </strong> \", ID, \"<br/> \",\n                                 \"<strong> Province: </strong> \", Province, \"<br/> \",\n                                 \"<strong> District: </strong> \", District, \"<br/> \",\n                                 \"<strong> Address: </strong> \", Address, \"<br/> \") %>% \n                   lapply(htmltools::HTML),\n                 icon = warehouse_icon) %>%\n      addMarkers(data = distribution_centers, \n                 lat = ~Latitude, \n                 lng = ~Longitude, \n                 label = ~paste0(\"<strong> ID Distribution Center: </strong> \", ID, \"<br/> \",\n                                 \"<strong> Province: </strong> \", Province, \"<br/> \",\n                                 \"<strong> District: </strong> \", District, \"<br/> \",\n                                 \"<strong> Address: </strong> \", Address, \"<br/> \") %>% \n                   lapply(htmltools::HTML),\n                 icon = dc_icon)\n    \n    qty_data <- optimal_quantities[location(), , drop = FALSE]  \n    \n    # Add routes based on the optimal quantities with different colors\n    route_colors <- c(\"#FF5733\", \"#33A8FF\", \"#33FF57\", \"#D433FF\", \"#FFD133\")\n    line_weights <- c(2, 3, 4, 5, 6)  # Variable line weights based on quantity\n    \n    # Add routes based on the optimal quantities\n    for (i in seq_along(location())) {\n      wh_id <- location()[i]\n      wh_idx <- which(warehouses$ID == wh_id)\n      color_idx <- (wh_id - 1) %% length(route_colors) + 1\n      \n      for (j in 1:ncol(qty_data)) {\n        if (qty_data[i, j] > 0) {\n          route_start <- warehouses[warehouses$ID == wh_id, c(\"Longitude\", \"Latitude\")]\n          route_end <- distribution_centers[distribution_centers$ID == j, c(\"Longitude\", \"Latitude\")]\n          \n          # Calculate line weight based on quantity (normalized)\n          weight_multiplier <- qty_data[i, j] / max(optimal_quantities) * 5\n          weight <- max(2, min(6, weight_multiplier + 2))  # Scale between 2-6\n          \n          map <- map %>%\n            addPolylines(\n              lat = c(route_start$Latitude, route_end$Latitude),\n              lng = c(route_start$Longitude, route_end$Longitude),\n              color = route_colors[color_idx],\n              weight = weight,\n              opacity = 0.7,\n              label = paste0(\"Quantity: \", round(qty_data[i, j], 2)),\n              dashArray = \"5, 5\",\n              popup = paste0(\n                \"<strong>From:</strong> Warehouse \", wh_id,\n                \"<br><strong>To:</strong> Distribution Center \", j,\n                \"<br><strong>Quantity:</strong> \", round(qty_data[i, j], 2)\n              )\n            )\n        }\n      }\n    }\n    \n    map  # Return the modified map\n  })\n  \n  # Render the cost table\n  output$cost_table <- renderDT({\n    req(location())\n    \n    cost_data <- result %>% \n      filter(Warehouse %in% paste(\"WH\", location())) %>% \n      select(c(Warehouse, DC, Loading_Cost, Transport_cost))\n    \n    # Add a Total Cost column\n    cost_data$Total_Cost <- cost_data$Loading_Cost + cost_data$Transport_cost\n    \n    # Format currency values\n    cost_data$Loading_Cost <- formatC(cost_data$Loading_Cost, format=\"f\", digits=0, big.mark=\",\")\n    cost_data$Transport_cost <- formatC(cost_data$Transport_cost, format=\"f\", digits=0, big.mark=\",\")\n    cost_data$Total_Cost <- formatC(cost_data$Total_Cost, format=\"f\", digits=0, big.mark=\",\")\n    \n    datatable(cost_data,\n              options = list(\n                pageLength = 10,\n                dom = 'Bfrtip',\n                buttons = c('copy', 'csv', 'excel'),\n                initComplete = JS(\n                  \"function(settings, json) {\",\n                  \"$(this.api().table().header()).css({'background-color': '#3b5998', 'color': 'white'});\",\n                  \"}\"\n                ),\n                columnDefs = list(\n                  list(className = 'dt-center', targets = \"_all\")\n                )\n              ),\n              rownames = FALSE,\n              class = 'compact stripe hover') %>%\n      formatStyle(\n        'Warehouse',\n        backgroundColor = styleEqual(\n          paste(\"WH\", 1:5), \n          c('#FFC3A0', '#A0D2FF', '#C8FFB0', '#D5A0FF', '#FFF0A0')\n        )\n      ) %>%\n      formatStyle(\n        'DC',\n        backgroundColor = styleEqual(\n          c(\"DC 1\", \"DC 2\", \"DC 3\"), \n          c('#FFDDC3', '#C3E5FF', '#DDFFC3')\n        )\n      )\n  })\n  \n  \n  # Create and render the Sankey diagram\n  selected_indices <- reactive({\n    as.numeric(sub(\"Warehouse \", \"\", input$warehouse))\n  })\n  \n  # Filter data based on selected warehouses\n  filtered_data <- reactive({\n    result %>%\n      filter(Warehouse %in% paste(\"WH\",input$warehouse))\n  })\n\n  # Create and render the Sankey diagram\n  output$sankey_diagram <- renderUI({\n    req(length(selected_indices()) > 0)\n    \n    # Create links data frame\n    links <- data.frame()\n    \n    # Add links for each selected warehouse\n    for (i in 1:length(selected_indices())) {\n      wh_idx <- selected_indices()[i]\n      wh_data <- optimal_quantities[wh_idx, , drop = FALSE]\n      \n      # Add links for each DC\n      for (j in 1:ncol(wh_data)) {\n        if (wh_data[1, j] > 0) {\n          links <- rbind(links, data.frame(\n            source = i - 1,  # Use index in selected warehouses (0-based)\n            target = length(selected_indices()) + j - 1,  # DCs come after warehouses\n            value = wh_data[1, j]\n          ))\n        }\n      }\n    }\n    \n    # Only proceed if we have links\n    req(nrow(links) > 0)\n    \n    # Create nodes data frame\n    nodes <- data.frame(\n      name = c(paste(\"Warehouse\", selected_indices()), paste(\"DC\", 1:3))\n    )\n    \n    # Create the Sankey network\n    sankey <- sankeyNetwork(\n      Links = links, \n      Nodes = nodes, \n      Source = \"source\", \n      Target = \"target\", \n      Value = \"value\",\n      NodeID = \"name\",\n      height = 500,  \n      width = 800,\n      fontSize = 12,\n      nodeWidth = 20,\n      sinksRight = TRUE\n    )\n    \n    # Customize tooltips and add click functionality to show a value panel\n    sankey <- htmlwidgets::onRender(sankey, \"\n    function(el, x) {\n      // Create a div for the value panel\n      var valuePanel = d3.select('body').append('div')\n        .attr('class', 'value-panel')\n        .style('position', 'absolute')\n        .style('padding', '8px')\n        .style('background', 'lightgray')\n        .style('border', '1px solid gray')\n        .style('border-radius', '4px')\n        .style('opacity', 0);  // Start hidden\n\n      // Append title for tooltips on hover\n      d3.selectAll('.link')\n        .append('title')\n        .text(function(d) { return 'Quantity: ' + d.value.toFixed(2); });  // Show value on hover\n\n      // Add click event to show the value panel\n      d3.selectAll('.link')\n        .on('click', function(event, d) {\n          // Ensure we get the correct value\n          var value = d3.select(this).datum().value;\n          var source = nodes.name[d.source.index];\n          var target = nodes.name[d.target.index];\n\n          // Position the value panel near the mouse cursor\n          valuePanel\n            .style('left', (event.pageX + 5) + 'px')\n            .style('top', (event.pageY + 5) + 'px')\n            .style('opacity', 1)  // Make it visible\n            .html('From: ' + source + '<br>To: ' + target + '<br>Quantity: ' + value.toFixed(2));  // Set the text with details\n\n          // Hide the panel after a delay\n          setTimeout(function() {\n            valuePanel.style('opacity', 0);\n          }, 3000);  // Change the delay as needed\n        });\n    }\n    \")\n    \n    # Add title and caption\n    tagList(\n      sankey,\n      tags$p(style = \"font-size: 12px; text-align: right;\", \n             \"A wider arrow indicates that a larger quantity is being sent from that warehouse to a distribution center.\")\n    )\n  })\n  \n  # Add a summary statistics output at the bottom of the map tab\n  output$summary_stats <- renderUI({\n    req(location())\n    \n    selected_data <- result %>% \n      filter(Warehouse %in% paste(\"WH\", location()))\n    \n    total_loading <- sum(selected_data$Loading_Cost)\n    total_transport <- sum(selected_data$Transport_cost)\n    total_weight <- sum(selected_data$Total_Weight)\n    \n    div(\n      class = \"mt-3 p-3 bg-light rounded\",\n      h4(\"Summary Statistics\", class = \"text-primary mb-3\"),\n      div(class = \"row\",\n          div(class = \"col-md-4\",\n              div(class = \"card text-white bg-primary mb-3\",\n                  div(class = \"card-body\",\n                      h5(class = \"card-title\", \"Total Weight\"),\n                      h3(class = \"card-text\", paste0(round(total_weight, 2), \" tons\"))\n                  )\n              )\n          ),\n          div(class = \"col-md-4\",\n              div(class = \"card text-white bg-success mb-3\",\n                  div(class = \"card-body\",\n                      h5(class = \"card-title\", \"Total Loading Cost\"),\n                      h3(class = \"card-text\", paste0(\"‚Ç´\", formatC(total_loading, format=\"f\", digits=0, big.mark=\",\")))\n                  )\n              )\n          ),\n          div(class = \"col-md-4\",\n              div(class = \"card text-white bg-info mb-3\",\n                  div(class = \"card-body\",\n                      h5(class = \"card-title\", \"Total Transport Cost\"),\n                      h3(class = \"card-text\", paste0(\"‚Ç´\", formatC(total_transport, format=\"f\", digits=0, big.mark=\",\")))\n                  )\n              )\n          )\n      )\n    )\n  })\n}\n\n# Run the application \nshinyApp(ui = ui, server = server)\n```\n:::\n\nB·∫°n c√≥ th·ªÉ th·∫•y v·ªõi **dashboard** nh∆∞ v·∫≠y, ta c√≥ th·ªÉ xem ƒë∆∞·ª£c nhi·ªÅu th√¥ng tin h∆°n nh∆∞:\n\n-   V·ªã tr√≠ c·ª• th·ªÉ c·ªßa t·ª´ng *WH* v√† *DC* c≈©ng nh∆∞ l√† c√°c tuy·∫øn ƒë∆∞·ªùng d·ª± ki·∫øn b·∫±ng c√°c ƒë∆∞·ªùng th·∫≥ng minh h·ªça. (Xem **Map tab**)\n\n-   Th√¥ng tin v·ªÅ chi ph√≠ *Loading cost* v√† *Transporation cost* c≈©ng nh∆∞ l∆∞·ª£ng h√†ng c·∫ßn v·∫≠n chuy·ªÉn cho t·ª´ng nh√† kho. (Xem **Table and Sankey tab**)\n\nB·∫°n c√≥ th·ªÉ xem cho 1 ho·∫∑c nhi·ªÅu nh√† kho b·∫±ng c√°ch *click* tr√™n thanh **Filter**. Ngo√†i ra, ƒë·∫∑c bi·ªát v·ªõi **Sankey chart**, b·∫°n c·∫ßn gi·ªØ ho·∫∑c *click* chu·ªôt v√†o tuy·∫øn ƒë·ªÉ xem ƒë∆∞·ª£c s·ªë l∆∞·ª£ng h√†ng.\n\nTuy r·∫•t th√≠ch R nh∆∞ng m√¨nh v·∫´n kh√¥ng th√≠ch x√¢y d·ª±ng dashboard b·∫±ng R l·∫Øm v√¨ qu√° n·∫∑ng v·ªÅ code v√† kh√¥ng hi·ªáu qu·∫£ v·ªÅ th·ªùi gian, ngu·ªìn l·ª±c. C√°c tools kh√°c m√¨nh ∆∞u ti√™n h∆°n nh∆∞ **Power BI**, **Tableau** ho·∫∑c c√°c **BIs** m√† c√¥ng ty b·∫°n s·ª≠ d·ª•ng trong c√¥ng vi·ªác h·∫±ng ng√†y.\n\n## M√¥ h√¨nh MILP:\n\nTi·∫øp theo ta s·∫Ω chuy·ªÉn sang thu·∫≠t to√°n tuy·∫øn t√≠nh m·ªõi l√† m√¥ h√¨nh MILP.\n\n### Gi·ªõi thi·ªáu s∆° l∆∞·ª£c:\n\n**MILP (Mixed Integer Linear Programming)** l√† m·ªôt ph∆∞∆°ng ph√°p t·ªëi ∆∞u h√≥a ƒë∆∞·ª£c s·ª≠ d·ª•ng trong c√°c b√†i to√°n l·∫≠p k·∫ø ho·∫°ch, ph√¢n b·ªï t√†i nguy√™n, v√† quy·∫øt ƒë·ªãnh trong c√°c lƒ©nh v·ª±c nh∆∞ logistics, s·∫£n xu·∫•t, t√†i ch√≠nh, v√† nhi·ªÅu lƒ©nh v·ª±c kh√°c. MILP l√† m·ªôt ph·∫ßn m·ªü r·ªông c·ªßa l·∫≠p tr√¨nh tuy·∫øn t√≠nh (Linear Programming - LP), trong ƒë√≥ c√≥ c√°c bi·∫øn l√† s·ªë nguy√™n (integer variables) b√™n c·∫°nh c√°c bi·∫øn li√™n t·ª•c (continuous variables).\n\nTrong ƒë√≥, c·∫•u tr√∫c c·ªßa m·ªôt b√†i to√°n MILP bao g·ªìm:\n\n1.  **H√†m m·ª•c ti√™u**: L√† m·ªôt h√†m tuy·∫øn t√≠nh m√† b·∫°n mu·ªën t·ªëi ∆∞u h√≥a (t·ªëi ƒëa h√≥a ho·∫∑c t·ªëi thi·ªÉu h√≥a).\n\n    $$\n    \\text{Maximize or Minimize } Z = c_1x_1 + c_2x_2 + \\ldots + c_nx_n\n    $$\n\n2.  **R√†ng bu·ªôc**: Bao g·ªìm c√°c ƒëi·ªÅu ki·ªán tuy·∫øn t√≠nh m√† c√°c bi·∫øn ph·∫£i th·ªèa m√£n.\n\n    $$\n    a_{11}x_1 + a_{12}x_2 + \\ldots + a_{1n}x_n \\leq b_1\n    $$\n\n    $$\n    a_{21}x_1 + a_{22}x_2 + \\ldots + a_{2n}x_n \\leq b_2\n    $$\n\n    ... v√† nhi·ªÅu r√†ng bu·ªôc kh√°c.\n\n3.  **Bi·∫øn quy·∫øt ƒë·ªãnh**: C√°c bi·∫øn trong b√†i to√°n c√≥ th·ªÉ l√†:\n\n    -   Bi·∫øn li√™n t·ª•c: C√≥ th·ªÉ nh·∫≠n m·ªçi gi√° tr·ªã th·ª±c (v√≠ d·ª•: s·ªë l∆∞·ª£ng s·∫£n ph·∫©m).\n    -   Bi·∫øn nguy√™n: Ch·ªâ nh·∫≠n gi√° tr·ªã nguy√™n (v√≠ d·ª•: s·ªë l∆∞·ª£ng xe t·∫£i).\n    -   Bi·∫øn nh·ªã ph√¢n: Ch·ªâ nh·∫≠n gi√° tr·ªã 0 ho·∫∑c 1 (v√≠ d·ª•: c√≥ ho·∫∑c kh√¥ng s·ª≠ d·ª•ng m·ªôt nh√† m√°y).\n\nM√¥ h√¨nh **MILP** l√† m·ªôt c√¥ng c·ª• m·∫°nh m·∫Ω cho vi·ªác t·ªëi ∆∞u h√≥a trong nhi·ªÅu lƒ©nh v·ª±c kh√°c nhau. V·ªõi kh·∫£ nƒÉng k·∫øt h·ª£p gi·ªØa c√°c bi·∫øn li√™n t·ª•c v√† s·ªë nguy√™n, MILP c√≥ th·ªÉ gi·∫£i quy·∫øt nhi·ªÅu b√†i to√°n ph·ª©c t·∫°p m√† c√°c ph∆∞∆°ng ph√°p t·ªëi ∆∞u h√≥a kh√°c kh√¥ng th·ªÉ th·ª±c hi·ªán hi·ªáu qu·∫£. C√°c ·ª©ng d·ª•ng ph·ªï bi·∫øn bao g·ªìm:\n\n-   **Qu·∫£n l√Ω chu·ªói cung ·ª©ng**: T·ªëi ∆∞u h√≥a vi·ªác ph√¢n ph·ªëi h√†ng h√≥a t·ª´ c√°c kho ƒë·∫øn c√°c kh√°ch h√†ng.\n-   **L·∫≠p k·∫ø ho·∫°ch s·∫£n xu·∫•t**: X√°c ƒë·ªãnh s·ªë l∆∞·ª£ng s·∫£n ph·∫©m c·∫ßn s·∫£n xu·∫•t ƒë·ªÉ t·ªëi ƒëa h√≥a l·ª£i nhu·∫≠n ho·∫∑c gi·∫£m chi ph√≠.\n-   **T·ªëi ∆∞u h√≥a l·ªãch tr√¨nh**: L·∫≠p l·ªãch cho nh√¢n vi√™n, m√°y m√≥c, ho·∫∑c t√†i nguy√™n ƒë·ªÉ t·ªëi ∆∞u h√≥a hi·ªáu su·∫•t.\n-   **Quy ho·∫°ch ƒë√¥ th·ªã**: T·ªëi ∆∞u h√≥a vi·ªác s·ª≠ d·ª•ng ƒë·∫•t v√† t√†i nguy√™n trong quy ho·∫°ch th√†nh ph·ªë.\n\nTrong R c√≥ c√°c th∆∞ vi·ªán nh∆∞ `lpSolve`, `ompr`, v√† `ROI` c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ gi·∫£i quy·∫øt c√°c b√†i to√°n MILP.\n\n### V√≠ d·ª• v·ªÅ m√¥ h√¨nh MILP:\n\nG·ªâa s·ª≠ ta c√≥ b√†i to√°n v·ªÅ v·∫•n ƒë·ªÅ **Transshipment** c√≥ y√™u c·∫ßu l√† t√¨m ra ph∆∞∆°ng √°n v·∫≠n t·∫£i t·ªëi ∆∞u nh·∫•t ƒë·ªÉ v·∫≠n chuy·ªÉn h√†ng h√≥a t·ª´ nh√† m√°y (**Factory**) th√¥ng qua **Crossdocking** v√† ƒë·∫øn ƒë∆∞·ª£c **Distribution Center** v·ªõi m·ª•c ti√™u l√† ƒë·∫°t **chi ph√≠ th·∫•p nh·∫•t**.\n\n```{=html}\n<div style=\"text-align: center; margin-bottom: 20px;\">\n  <img src=\"img/transshipment.png\" style=\"max-width: 100%; height: auto; display: block; margin: 0 auto;\">\n  \n  <!-- Picture Name -->\n  <div style=\"text-align: left; margin-top: 10px;\">\n    H√¨nh 5: V·∫•n ƒë·ªÅ Transshipment\n  </div>\n  \n  <!-- Source Link -->\n  <div style=\"text-align: right; font-style: italic; margin-top: 5px;\">\n    Source: <a href=\"https://posit.co/download/rstudio-desktop/\">Rstudio</a>\n  </div>\n</div>\n```\n\nV√¨ b√†i to√°n n√†y thu·ªôc d·∫°ng tuy·∫øn t√≠nh n√™n ph∆∞∆°ng ph√°p MILP s·∫Ω l√†m t·ªët h∆°n nhi·ªÅu so v·ªõi thu·∫≠t to√°n GA b√™n tr√™n. K·∫øt qu·∫£ ƒë∆∞·ª£c tr√¨nh b√†y b√™n d∆∞·ªõi ƒë√¢y\n\n```{r}\n#| warning: false\n#| message: false\n#| output: false\n#| fig-cap: \"Bi·ªÉu ƒë·ªì 4: K·∫øt qu·∫£ t·ª´ m√¥ h√¨nh MILP\"\nlibrary(ompr)\nlibrary(ompr.roi)\nlibrary(ROI.plugin.glpk)\n#Input:\nSupply <-c(200,300,100,150,220)\nDemand <-c(150,100,110,200,180)\nDC<-2\nm<-length(Supply)\nn<-length(Demand)\n\nCost_CD<-read.table(text = \n                    \"CD1 CD2\n                     30 50\n                     23 66\n                     35 14\n                     70 12\n                     65 70\",header = T)\nCost_DC<-read.table(text = \n                      \"DC1 DC2 DC3 DC4 DC5\n                       12 25 22 40 41\n                       65 22 23 12 15\",header = T)\n\n#MILP model from the \nmodel5 <- MIPModel() %>%\n  # Add variable\n  add_variable(x[i, j], i = 1:m, j = 1:DC) %>%\n  add_variable(y[j, k], j = 1:DC, k = 1:n) %>%\n  # minimize the cost of transshipment:\n  set_objective(sum_expr(x[i, j]*Cost_CD[i, j],i = 1:m, j = 1:DC)+ sum_expr(y[j, k]*Cost_DC[j, k], k = 1:n, j = 1:DC),\"min\") %>%\n  add_constraint(sum_expr(y[j, k], j = 1:DC) >= Demand[k], k = 1:n) %>%\n  # The amount of inventory in Crossdocking is smaller than production goods\n  add_constraint(sum_expr(x[i, j], j = 1:DC) <= Supply[i], i = 1:m) %>% \n  # The amount of is bigger than demand in DC\n  add_constraint(sum_expr(x[i, j], i = 1:m) - sum_expr(y[j, k], k = 1:n) >= 0,j = 1:DC) %>%\n  add_constraint(x[i, j] >= 0, j = 1:DC, i = 1:m)%>% \n  add_constraint(y[j, k] >= 0, j = 1:DC, k = 1:n)%>% \n  #Solve the model:\n  solve_model(with_ROI(solver = \"glpk\", verbose = TRUE))\n```\n\n```{r}\n#| layout: [[50,50]]\n#| warning: false\n#| message: false\n#| echo: false\n\n## Table:\nsolution <- get_solution(model5, x[i, j]) %>% \n     filter(value > 0)\n\nlibrary(gt)\nlibrary(dplyr)\nlibrary(scales)  \n\n# Assuming `solution` contains the results of x[i, j]\n# Transform the solution into a tidy format for the table\ntable_data <- solution %>%\n  rename(Manufacturer = i, DC = j, Flow = value) %>%\n  mutate(Manufacturer = paste(\"Manufacturer\", Manufacturer),\n         DC = paste(\"DC\", DC)) %>% \n  select(-variable)\n\n# Create a gt table\ntable_data %>%\n  gt() %>%\n  tab_header(\n    title = md(\"**Transshipment flows from Manufacturers to Distribution Centers**\")\n  ) %>%\n  cols_label(\n    Manufacturer = md(\"**Manufacturer**\"),\n    DC = md(\"**Distribution Center**\"),\n    Flow = md(\"**Flow Amount**\")) %>%\n  fmt_number(\n    columns = c(Flow),\n    decimals = 2\n  ) %>%\n  data_color(\n    columns = c(Flow),  # Use c() instead of vars()\n    colors = scales::col_numeric(palette = c(\"#2ca02c\",\"#ff7f0e\"), domain = NULL)\n  ) %>%\n  cols_align(\n    align = \"center\",\n    columns = everything()  # Applies to all columns\n  ) %>%\n  tab_options(\n    table.width = pct(100)\n  ) %>% \n  gt_theme_espn()\n\n## Barchart:\n\nlibrary(ggplot2)\nplot_data <- solution %>%\n  rename(Manufacter= i, DC = j, Flow = value) %>%\n  mutate(Manufacter = paste(\"Manufacter\", Manufacter),\n         DC = paste(\"DC\", DC))\n\n# Create a plot\nggplot(plot_data, aes(x = Manufacter, y = Flow, fill = DC)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  theme_minimal() +\n  labs(title = \"\",\n       x = \"Manufacters\",\n       y = \"Flow Amount\",\n       fill = \"Distribution Centers\") +\n  theme(text = element_text(size = 12),\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_brewer(palette = \"Set2\")\n```\n\nNh∆∞ v·∫≠y, ch√∫ng ta ƒë√£ ƒë∆∞·ª£c h·ªçc v·ªÅ thu·∫≠t to√°n Genetic v√† m√¥ h√¨nh MILP c≈©ng nh∆∞ c√°ch th·ª±c hi·ªán trong Rstudio.\n\nN·∫øu b·∫°n c√≥ c√¢u h·ªèi hay th·∫Øc m·∫Øc n√†o, ƒë·ª´ng ng·∫ßn ng·∫°i li√™n h·ªá v·ªõi m√¨nh qua Gmail. B√™n c·∫°nh ƒë√≥, n·∫øu b·∫°n mu·ªën xem l·∫°i c√°c b√†i vi·∫øt tr∆∞·ªõc ƒë√¢y c·ªßa m√¨nh, h√£y nh·∫•n v√†o hai n√∫t d∆∞·ªõi ƒë√¢y ƒë·ªÉ truy c·∫≠p trang **Rpubs** ho·∫∑c m√£ ngu·ªìn tr√™n **Github**. R·∫•t vui ƒë∆∞·ª£c ƒë·ªìng h√†nh c√πng b·∫°n, h·∫πn g·∫∑p l·∫°i! üòÑüòÑüòÑ\n\n```{=html}\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Contact Me</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css\">\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/simple-icons@v6.0.0/svgs/rstudio.svg\">\n    <style>\n        body { font-family: Arial, sans-serif; background-color: $secondary-color; }\n        .container { max-width: 400px; margin: auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); }\n        label { display: block; margin: 10px 0 5px; }\n        input[type=\"email\"] { width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px; }\n        .github-button, .rpubs-button { margin-top: 20px; text-align: center; }\n        .github-button button, .rpubs-button button { background-color: #333; color: white; border: none; padding: 10px; cursor: pointer; border-radius: 4px; width: 100%; }\n        .github-button button:hover, .rpubs-button button:hover { background-color: #555; }\n        .rpubs-button button { background-color: #75AADB; }\n        .rpubs-button button:hover { background-color: #5A9BC2; }\n        .rpubs-icon { margin-right: 5px; width: 20px; vertical-align: middle; filter: brightness(0) invert(1); }\n        .error-message { color: red; font-size: 0.9em; margin-top: 5px; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h2>Contact Me</h2>\n        <form id=\"emailForm\">\n            <label for=\"email\">Your Email:</label>\n            <input type=\"email\" id=\"email\" name=\"email\" required aria-label=\"Email Address\">\n            <div class=\"error-message\" id=\"error-message\" style=\"display: none;\">Please enter a valid email address.</div>\n            <button type=\"submit\">Send Email</button>\n        </form>\n        <div class=\"github-button\">\n            <button>\n                <a href=\"https://github.com/Loccx78vn\" target=\"_blank\" style=\"color: white; text-decoration: none;\">\n                    <i class=\"fab fa-github\"></i> View Code on GitHub\n                </a>\n            </button>\n        </div>\n        <div class=\"rpubs-button\">\n            <button>\n                <a href=\"https://rpubs.com/loccx\" target=\"_blank\" style=\"color: white; text-decoration: none;\">\n                    <img src=\"https://cdn.jsdelivr.net/npm/simple-icons@v6.0.0/icons/rstudio.svg\" alt=\"RStudio icon\" class=\"rpubs-icon\"> Visit my RPubs\n                </a>\n            </button>\n        </div>\n    </div>\n\n    <script>\n        document.getElementById('emailForm').addEventListener('submit', function(event) {\n            event.preventDefault(); // Prevent default form submission\n            const emailInput = document.getElementById('email');\n            const email = emailInput.value;\n            const errorMessage = document.getElementById('error-message');\n\n            // Simple email validation regex\n            const emailPattern = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n\n            if (emailPattern.test(email)) {\n                errorMessage.style.display = 'none'; // Hide error message\n                const yourEmail = 'loccaoxuan103@gmail.com'; // Your email\n                const gmailLink = `https://mail.google.com/mail/?view=cm&fs=1&to=${yourEmail}&su=Help%20Request%20from%20${encodeURIComponent(email)}`;\n                window.open(gmailLink, '_blank'); // Open in new tab\n            } else {\n                errorMessage.style.display = 'block'; // Show error message\n            }\n        });\n    </script>\n</body>\n</html>\n```\n","srcMarkdownNoYaml":"\n\n# Gi·ªõi thi·ªáu:\n\n```{r}\n#| warning: false\n#| message: false\n#| echo: false\n#Call packages\npacman::p_load(rio,\n               here,\n               janitor,\n               tidyverse,\n               dplyr,\n               magrittr,\n               ggplot2,\n               purrr,\n               lubridate,\n               mice,\n               plotly,\n               DiagrammeR,\n               shinylive)\n```\n\n## V√†i ƒëi·ªÉm v·ªÅ thu·∫≠t to√°n Genetic:\n\n**GA** hay **Genetic Algorithm** l√† 1 thu·∫≠t to√°n t·ªëi ∆∞u h√≥a ng·∫´u nhi√™n (**stochastic search algorithms**), ƒë∆∞·ª£c ph√°t tri·ªÉn d·ª±a tr√™n l√Ω thuy·∫øt ti·∫øn h√≥a v√† s·ª± ch·ªçn l·ªçc t·ª± nhi√™n c·ªßa sinh h·ªçc [@lucascrucca2013].\n\n·ªû th·ªùi c·∫•p 3, b·∫°n ƒë√£ t·ª´ng h·ªçc v·ªÅ l√Ω thuy·∫øt ti·∫øn h√≥a v√† ch·ªçn l·ªçc t·ª± nhi√™n c·ªßa [Charles Darwin](https://vi.wikipedia.org/wiki/Charles_Darwin) v√† [Alfred Russel](https://vi.wikipedia.org/wiki/Alfred_Russel_Wallace) ·ªü m√¥n Sinh h·ªçc. N·∫øu b·∫°n c≈©ng t·ª´ng li·ªát Sinh nh∆∞ t√¥i th√¨ b·∫°n qu√™n c≈©ng kh√¥ng sao üòÖüòÖ. V·∫≠y th√¨ ƒë·ªÉ t√¥i gi·∫£i th√≠ch l·∫°i nh∆∞ sau:\n\nS·ª± ti·∫øn h√≥a l√† s·ª± thay ƒë·ªïi ƒë·∫∑c ƒëi·ªÉm di truy·ªÅn c·ªßa 1 qu·∫ßn th·ªÉ sinh v·∫≠t, v√≠ d·ª• ƒëi·ªÉn h√¨nh ch√≠nh l√† t·ª´ lo·∫°i v∆∞·ª£n ƒë√£ ti·∫øn h√≥a th√†nh h√¨nh d·∫°ng con ng∆∞·ªùi vƒÉn minh nh∆∞ c√°c b·∫°n b√¢y gi·ªù. V·∫≠y qu√° tr√¨nh ti·∫øn h√≥a ƒë√≥ di·ªÖn ra khi c√≥ s·ª± ch·ªçn l·ªçc t·ª± nhi√™n t·∫°o ra c√°c bi·∫øn d·ªã di truy·ªÅn (V√≠ d·ª•: ƒë·ªôt bi·∫øn,...) v√† k·∫øt qu·∫£ l√† c√°c c√° th·ªÉ ƒë·ªôt bi·∫øn tr·ªü n√™n ph·ªï bi·∫øn h∆°n ho·∫∑c hi·∫øm g·∫∑p h∆°n trong qu·∫ßn th·ªÉ. V·∫≠y ƒëi·ªÅu ki·ªán ƒë·ªÉ x·∫£y ra s·ª± ch·ªçn l·ªçc t·ª± nhi√™n c√≥ th·ªÉ l√† s·ª± thay ƒë·ªïi v·ªÅ m√¥i tr∆∞·ªùng s·ªëng, ƒë·ªãa l√Ω,... d·∫´n t·ªõi s·ª± kh√°c nhau v·ªÅ kh·∫£ nƒÉng s·ªëng s√≥t v√† sinh s·∫£n.\n\nK·∫øt c·ª•c l√† xu·∫•t hi·ªán c√°c c√° th·ªÉ ƒë·ªôt bi·∫øn \"m·∫°nh m·∫Ω h∆°n\" ho·∫∑c ƒë√∫ng l√† \"ƒë·∫∑c bi·ªát h∆°n\" c√≥ kh·∫£ nƒÉng t·ªìn t·∫°i khi xu·∫•t hi·ªán s·ª± thay ƒë·ªïi l·ªõn, v√≠ d·ª• nh∆∞ d∆∞·ªõi ƒë√¢y, do s·ª± thay ƒë·ªïi v·ªÅ ƒë·ªãa ƒëi·ªÉm s·ªëng, t·ª´ m·ªôt lo·∫°i chim s·∫ª ƒë√£ ph√°t tri·ªÉn th√†nh 3 ph√¢n h·ªç kh√°c nhau.\n\n```{=html}\n<div style=\"text-align: center; margin-bottom: 20px;\">\n  <img src=\"img/Natural_selection.jpg\" style=\"max-width: 100%; height: auto; display: block; margin: 0 auto;\">\n  \n  <!-- Picture Name -->\n  <div style=\"text-align: left; margin-top: 10px;\">\n    H√¨nh 1: V√≠ d·ª• v·ªÅ ch·ªçn l·ªçc t·ª± nhi√™n\n  </div>\n  \n  <!-- Source Link -->\n  <div style=\"text-align: right; font-style: italic; margin-top: 5px;\">\n    Source: <a href=\"https://www.biologyonline.com/dictionary/natural-selection\">Link to Image</a>\n  </div>\n</div>\n```\n\nV·∫≠y l√≠ thuy·∫øt n√†y li√™n quan g√¨ t·ªõi v·∫•n ƒë·ªÅ t·ªëi ∆∞u h√≥a. Th√¥ng th∆∞·ªùng khi b·∫°n mu·ªën t·ªëi ∆∞u h√≥a m·ªôt v·∫•n ƒë·ªÅ g√¨ ƒë√≥, b·∫°n c·∫ßn x√¢y d·ª±ng m√¥ h√¨nh ƒë·ªãnh l∆∞·ª£ng n√≥, v√≠ d·ª• nh∆∞ d∆∞·ªõi ·∫£nh n√†y ta ƒëang c√≥ m√¥ h√¨nh [MILP](https://www.mathworks.com/help/optim/ug/mixed-integer-linear-programming-algorithms.html) nh·∫±m ho·∫°ch ƒë·ªãnh tuy·∫øn ƒë∆∞·ªùng v√† t·ªëi ∆∞u h√≥a qu√£ng ƒë∆∞·ªùng di chuy·ªÉn.\n\n```{=html}\n<div style=\"text-align: center; margin-bottom: 20px;\">\n  <img src=\"img/MILP.png\" style=\"max-width: 100%; height: auto; display: block; margin: 0 auto;\">\n  \n  <!-- Picture Name -->\n  <div style=\"text-align: left; margin-top: 10px;\">\n    H√¨nh 2: M√¥ h√¨nh VRP\n  </div>\n  \n  <!-- Source Link -->\n  <div style=\"text-align: right; font-style: italic; margin-top: 5px;\">\n    Source: <a href=\"https://medium.com/@rihot_gusron/capacitated-vehicle-routing-problem-with-lingo-427c2d3bf724\">Link to Image</a>\n  </div>\n</div>\n```\n\nM·ª•c ti√™u c·ªßa h√†m ch√≠nh l√† t√¨m ra gi√° tr·ªã nh·ªè nh·∫•t nghƒ©a l√† chi ph√≠ cho vi·ªác di chuy·ªÉn c·ªßa xe l√† nh·ªè nh·∫•t. Do ƒë√≥, b·∫°n c√≥ th·ªÉ h√¨nh dung r·∫±ng **gi√° tr·ªã nh·ªè nh·∫•t** ƒë√≥ nh∆∞ l√† c√°c **c√° th·ªÉ ƒë·ªôt bi·∫øn** c√≥ kh·∫£ nƒÉng s·ªëng s√≥t cao nh·∫•t trong qu·∫©n th·ªÉ.\n\nV√¨ v·∫≠y thu·∫≠t to√°n **Genetic** (GA) ch√≠nh l√† l·∫∑p ƒëi l·∫∑p l·∫°i s·ª± ch·ªçn l·ªçc t·ª± nhi√™n trong m·ªôt qu·∫ßn th·ªÉ ho·∫∑c m·ªôt m·∫´u ƒë·ªÉ ƒë·∫øn cu·ªëi c√πng t√¨m ra c√° th·ªÉ v∆∞·ª£t tr·ªôi nh·∫•t.\n\n## C√°ch ho·∫°t ƒë·ªông GA trong ML:\n\nTrong Machine Learning, GA nh·∫±m t√¨m ra ƒë√∫ng c√°c bi·∫øn c·∫ßn thi·∫øt ƒë·ªÉ x√¢y d·ª±ng m√¥ h√¨nh t·ªët nh·∫•t. G·ªâa s·ª≠ ch√∫ng ta c√≥ 2 m√¥ h√¨nh l√†:\n\n-   M√¥ h√¨nh 1: g·ªìm c√°c bi·∫øn A,C,D.\n-   M√¥ h√¨nh 2: g·ªìm bi·∫øn A,B,E.\n\nV·∫≠y m√¥ h√¨nh n√†o m·ªõi l√† t·ªët nh·∫•t cho m√¥ h√¨nh d·ª± ƒëo√°n ? Ch√∫ng ta ch∆∞a bi·∫øt ƒë∆∞·ª£c v√† ch·ªâ c√≥ th·ªÉ so s√°nh n√≥ th√¥ng qua thu·∫≠t to√°n Genetic.\n\nV·ªÅ quy tr√¨nh, thu·∫≠t to√°n Genetic s·∫Ω c√≥ c√°ch ho·∫°t ƒë·ªông nh∆∞ d∆∞·ªõi ƒë√¢y. Quy tr√¨nh n√†y m√¨nh tham kh·∫£o c·ªßa [@rohithgandhi2018].\n\n```{=html}\n<div style=\"text-align: center; margin-bottom: 20px;\">\n  <img src=\"img/Genetic_Algorithm.png\" style=\"max-width: 100%; height: auto; display: block; margin: 0 auto;\">\n  \n  <!-- Picture Name -->\n  <div style=\"text-align: left; margin-top: 10px;\">\n    H√¨nh 3: Thu·∫≠t to√°n Genetic\n  </div>\n  \n  <!-- Source Link -->\n  <div style=\"text-align: right; font-style: italic; margin-top: 5px;\">\n    Source: <a href=\"https://medium.datadriveninvestor.com/genetic-algorithms-9f920939f7cc\">Link to Image</a>\n  </div>\n</div>\n```\n\nDi·ªÖn gi·∫£i c√°ch ho·∫°t ƒë·ªông:\n\n-   B∆∞·ªõc 1 (**Initialisation**): m·ªói bi·∫øn ƒë∆∞·ª£c xem l√† *Gene* v√† nhi·ªÅu *Gene* g·ªôp l·∫°i th√†nh m·ªôt m√¥ h√¨nh hay g·ªçi l√† *Chromosome* v√† nhi·ªÅu *Chromosome* s·∫Ω t·∫°o th√†nh m·ªôt qu·∫ßn th·ªÉ (*Population*). Vi·ªác n√†y gi·ªëng nh∆∞ l√† b·∫°n ƒëang tr√¨nh b√†y h·∫øt c√°c ph∆∞∆°ng √°n c√≥ th·ªÉ s·ª≠ d·ª•ng.\n\n```{=html}\n<div style=\"text-align: center; margin-bottom: 20px;\">\n  <img src=\"img/Term.png\" style=\"max-width: 100%; height: auto; display: block; margin: 0 auto;\">\n  \n  <!-- Picture Name -->\n  <div style=\"text-align: left; margin-top: 10px;\">\n    H√¨nh 4: C√°c thu·∫≠t ng·ªØ trong GA\n  </div>\n  \n  <!-- Source Link -->\n  <div style=\"text-align: right; font-style: italic; margin-top: 5px;\">\n    Source: <a href=\"https://www.doc.ic.ac.uk/research/technicalreports/2003/DTR03-4.pdf\">Link to Image</a>\n  </div>\n</div>\n```\n\n-   B∆∞·ªõc 2 (**Fitness Function**): B·∫°n c·∫ßn x√¢y d·ª±ng m·ªôt h√†m m·ª•c ti√™u ƒë·ªÉ t√≠nh to√°n gi√° tr·ªã cho c√°c m√¥ h√¨nh ·ªü b∆∞·ªõc 1.\n\n-   B∆∞·ªõc 3 (**Selection**): Bi·∫øn n√†o c√≥ gi√° tr·ªã y·∫øu k√©m s·∫Ω b·ªã lo·∫°i v√† qu√° tr√¨nh t√≠nh to√°n s·∫Ω ti·∫øp t·ª•c ·ªü th·∫ø h·ªá c·ªßa n√≥ ti·∫øp theo. Di·ªÖn gi·∫£i ƒë∆°n gi·∫£n h∆°n l√† ch√∫ng ta th·ª≠ m·ªôt c√°ch kh√°c v√† c·ªë g·∫Øng c·∫£i thi·ªán k·∫øt qu·∫£.\n\n-   B∆∞·ªõc 4 (**Crossover**): T·∫°o ra m√¥ h√¨nh g·ªìm c√°c bi·∫øn t·ªët ƒë√£ l·ª±a ch·ªçn ·ªü b∆∞·ªõc 3. V√≠ d·ª• nh∆∞ bi·∫øn A, B l√† t·ªët cho m√¥ h√¨nh.\n\n-   B∆∞·ªõc 5 (**Mutation**): Thay ƒë·ªïi m√¥ h√¨nh ƒë·∫ßu v√†o ƒë√£ bao g·ªìm c√°c bi·∫øn ·ªü b∆∞·ªõc 4 v√† b·∫Øt ƒë·∫ßu l·∫°i t·ª´ b∆∞·ªõc 1. V√≠ d·ª• m√¥ h√¨nh c·∫ßn ch·ªçn g·ªìm 5 bi·∫øn v√† ta ƒë√£ ch·ªçn ƒë∆∞·ª£c bi·∫øn A,B l√† t·ªët. Do ƒë√≥, khi quay l·∫°i b∆∞·ªõc 1, ta ch·ªâ c·∫ßn ch·ªçn th√™m 3 bi·∫øn thay v√¨ 5 bi·∫øn nh∆∞ th√¥ng th∆∞·ªùng.\n\n# Th·ª±c h√†nh trong R:\n\nSau khi ƒë√£ s∆° l∆∞·ª£c v·ªÅ thu·∫≠t to√°n, b√¢y gi·ªù ta s·∫Ω v√†o ph·∫ßn th·ª±c h√†nh trong R. V·∫≠y l√†m sao ƒë·ªÉ ·ª©ng d·ª•ng thu·∫≠t to√°n Genetic trong R, m√¨nh ƒë√£ kham kh·∫£o qua nhi·ªÅu ngu·ªìn t√†i li·ªáu v√† t·ªïng h·ª£p d∆∞·ªõi ƒë√¢y:\n\n**X√¢y d·ª±ng h√†m m·ª•c ti√™u**: h√†m m·ª•c ti√™u l√† b∆∞·ªõc quan tr·ªçng nh·∫•t trong thu·∫≠t to√°n Genetic v√¨ n√≥ l√† c∆° s·ªü ƒë·ªÉ ƒë√°nh gi√° v√† l·ª±a ch·ªçn c√° th·ªÉ v∆∞·ª£t tr·ªôi nh·∫•t. V√† h√†m m·ª•c ti√™u s·∫Ω lu√¥n kh√°c nhau t√πy v√†o v·∫•n ƒë·ªÅ m√† ta ƒë·∫∑t ra. Gi·∫£ s·ª≠ ch√∫ng ta mu·ªën t·ªëi ∆∞u chi ph√≠ th√¨ n√≥ l√† h√†m Min, c√≤n ta mu·ªën t·ªëi ƒëa l·ª£i nhu·∫≠n th√¨ n√≥ s·∫Ω l√† h√†m Max.\n\nV·∫≠y h√†m m·ª•c ti√™u c·ªßa b√†i to√°n tr√™n trong R, b·∫°n c√≥ th·ªÉ tham kh·∫£o ph·∫ßn code b√™n d∆∞·ªõi m√¨nh:\n\n::: callout-important\n### Type of fitness function\n\nƒê·ªëi s·ªë `type` trong h√†m c√≥ 3 gi√° tr·ªã:\n\n-   `\"binary\"`: ƒë·∫°i di·ªán cho bi·∫øn quy·∫øt ƒë·ªãnh d·∫°ng ph√¢n lo·∫°i, v√≠ d·ª•: c√≥/kh√¥ng\n-   `\"real-valued\"`: d√πng d·ªÉ t·ªëi ∆∞u cho c√°c bi·∫øn quy·∫øt ƒë·ªãnh l√† d·∫°ng s·ªë th·ª±c, s·ªë t·ª± nhi√™n.\n-   `\"permutation\"`: cho c√°c v·∫•n ƒë·ªÅ li√™n quan ƒë·∫øn vi·ªác s·∫Øp x·∫øp l·∫°i c√°c bi·∫øn th√†nh danh s√°ch, v√≠ d·ª•: thang ƒëo Likert.\n:::\n\nChi ti·∫øt v·ªÅ h√†m `ga()`, b·∫°n c√≥ th·ªÉ tham kh·∫£o t√†i li·ªáu c·ªßa [@lucascrucca2013].\n\n## Thu·∫≠t to√°n Genetic:\n\nV·∫≠y b√¢y gi·ªù ch√∫ng ta s·∫Ω x·ª≠ l√≠ b√†i to√°n tr√™n theo thu·∫≠t to√°n **Genetic**\n\nG·ªâa s·ª≠ ch√∫ng ta c√≥ b√†i to√°n v·ªÅ v·∫≠n chuy·ªÉn h√†ng t·ª´ nh√† kho ƒë·ªÉ th·ªèa m√£n nhu c·∫ßu ·ªü c√°c ƒëi·ªÉm **DC (Distribution center)**. V√† c√¥ng th·ª©c ƒë·ªÉ t√≠nh to√°n ƒë∆∞·ª£c chi ph√≠ l√†:\n\nH√†m chi ph√≠ t·ªïng th·ªÉ ƒë∆∞·ª£c x√°c ƒë·ªãnh nh∆∞ sau:\n\n$$\nTC = \\sum_{i=1}^{m} \\left( D_{ij} \\times \\frac{P}{F} \\times 0.4 + LC_i \\right) \\times Q_j\n$$\n\nTrong b√†i to√°n n√†y, b·∫°n s·∫Ω c·∫ßn d·ªØ li·ªáu ƒë·ªÉ t√≠nh to√°n 2 th√¥ng s·ªë l√†: **Ph√≠ b·ªëc x·∫øp (Loading cost)** v√† **Chi ph√≠ v·∫≠n chuy·ªÉn (Transportation cost)**.\n\nN·∫øu trong c√¥ng vi·ªác th∆∞·ªùng ng√†y ·ªü c√¥ng ty, ch√∫ng ta s·∫Ω c·∫ßn l·∫•y d·ªØ li·ªáu t·ª´ **Data warehouse** b·∫±ng SQL ho·∫∑c c√°c ph·∫ßn m·ªÅm **Business Intelligence** kh√°c. ·ªû ƒë√¢y, nh·∫±m m·ª•c ƒë√≠ch h·ªçc t·∫≠p, m√¨nh ƒë√£ t·∫°o ra code ·ªü ph√≠a d∆∞·ªõi ƒë·ªÉ x√¢y d·ª±ng d·ªØ li·ªáu cho c√°c b·∫°n luy·ªán t·∫≠p.\n\n```{r}\n# Create a data frame for loading costs\nloading_costs <- data.frame(\n  Warehouse = rep(paste(\"WH\", 1:5), each = 4),\n  ID = rep(1:5, times = 4),\n  Weight_Category = rep(c(\"< 2 tons\", \"2 to 5 tons\", \"5 to 10 tons\", \"> 10 tons\"), times = 5),\n  Has_Machine = rep(c(\"Yes\", \"No\", \"Yes\", \"No\", \"No\"), each = 4),\n  Loading_Cost = c(80, 100, 120, 160,  # Warehouse 1 (with machine)\n                   110, 150, 180, 210,  # Warehouse 2 (without machine)\n                   85, 105, 125, 140,  # Warehouse 3 (with machine)\n                   150, 170, 190, 210,  # Warehouse 4 (without machine)\n                   140, 165, 185, 215)   # Warehouse 5 (without machine)\n)\n\n# Set seed for reproducibility\nset.seed(123)\n\n# Define parameters\nweight_categories <- c(\"< 1.5\", \"1.5 to 2.5\", \"2.5 to 5\", \"5 to 10\", \"> 10\")\n# Create the data frame\nloading_costs <- data.frame(\n  Warehouse = rep(1:5, each = 15),  # 5 warehouses, 15 rows each\n  DC = rep(rep(1:3, each = 5), times = 5),  # Repeat 1, 2, 3 for each warehouse\n  Weight_Category = rep(weight_categories, times = 15),  # Repeat categories for 15 rows\n  Loading_Cost = round(runif(75, 5, 150), 2),\n  Has_Machine = sample(c(\"Yes\", \"No\"), 75, replace = TRUE)\n)\n\n# Define warehouses with coordinates (latitude, longitude)\nwarehouses <- data.frame(\n  ID = 1:5,\n  Latitude = c(21.0285, 16.0545, 10.7769, 14.0583, 19.8060), # Example latitudes (Hanoi, HCMC, Da Nang, etc.)\n  Longitude = c(105.804, 108.2022, 106.6957, 108.2772, 105.7460) # Example longitudes\n)\n\n# Define distribution centers data in Vietnam (example coordinates)\ndistribution_centers <- data.frame(\n  ID = 1:3,\n  Demand = c(90, 30, 150),\n  Latitude = c(17.974855, 11.7769, 15.122327), # Example latitudes (Hanoi, Da Nang, HCMC)\n  Longitude = c(102.630867, 106.6957, 108.799357) # Example longitudes\n)\n```\n\nN·∫øu b·∫°n t·ª´ng g·∫∑p kh√≥ khƒÉn trong vi·ªác ph·∫£i ƒë·ªëi m·∫∑t v·ªõi c·∫£ ƒë·ªëng d·ªØ li·ªáu t·ª´ h·ªá th·ªëng v√† ch∆∞a bi·∫øt l·∫•y d·ªØ li·ªáu n√†o ƒë·ªÉ ph√¢n t√≠ch ho·∫∑c g·ªôp b·∫£ng n√†o qua b·∫£ng n√†o th√¨ l·ªùi khuy√™n c·ªßa m√¨nh l√† h√£y v·∫Ω b·∫£ng **Entity relation diagram (ERD)**.\n\n**ERD** l√† m·ªôt c√¥ng c·ª• tr·ª±c quan d√πng ƒë·ªÉ m√¥ t·∫£ c·∫•u tr√∫c d·ªØ li·ªáu trong c∆° s·ªü d·ªØ li·ªáu. ERD th·ªÉ hi·ªán c√°c th·ª±c th·ªÉ (*entities*), thu·ªôc t√≠nh (*attributes*), v√† c√°c m·ªëi quan h·ªá (*relationships*) gi·ªØa ch√∫ng. C√°c th·ª±c th·ªÉ th∆∞·ªùng ƒë∆∞·ª£c bi·ªÉu di·ªÖn d∆∞·ªõi d·∫°ng h√¨nh ch·ªØ nh·∫≠t, thu·ªôc t√≠nh d∆∞·ªõi d·∫°ng h√¨nh ellips, v√† m·ªëi quan h·ªá b·∫±ng h√¨nh thoi ho·∫∑c ƒë∆∞·ªùng n·ªëi. ERD gi√∫p l·∫≠p k·∫ø ho·∫°ch cho thi·∫øt k·∫ø c∆° s·ªü d·ªØ li·ªáu, ƒë·∫£m b·∫£o r·∫±ng c√°c y·∫øu t·ªë d·ªØ li·ªáu v√† quan h·ªá gi·ªØa ch√∫ng ƒë∆∞·ª£c x√°c ƒë·ªãnh r√µ r√†ng, t·∫°o n·ªÅn t·∫£ng cho vi·ªác ph√°t tri·ªÉn v√† qu·∫£n l√Ω d·ªØ li·ªáu hi·ªáu qu·∫£.\n\nNh∆∞ bi·ªÉu ƒë·ªì d∆∞·ªõi ƒë√¢y, m√¨nh ƒëang c√≥ 3 b·∫£ng g·ªìm:\n\n-   B·∫£ng th√¥ng tin chi ti·∫øt v·ªÅ DC.\n\n-   B·∫£ng th√¥ng tin chi ti·∫øt v·ªÅ WH.\n\n-   B·∫£ng gi√° v·ªÅ loading cost v√† transportation cost t·ª´ WH ƒë·∫øn DC.\n\nV√† c√°c b·∫°n c√≥ th·ªÉ d·ªÖ d√†ng h√¨nh dung c√°c m·ªëi quan h·ªá th√¥ng qua b·∫£ng **Entity relation diagram (ERD)** d∆∞·ªõi ƒë√¢y:\n\n```{r}\n#| echo: false\n#| fig-subcap: \"Bi·ªÉu ƒë·ªì 1: EDR model\"\nlibrary(datamodelr)\n# Create the data model from your data frames\ndm1 <- dm_from_data_frames(list(\n  Warehouses = warehouses,\n  Loading_Costs = loading_costs,\n  Distribution_Centers = distribution_centers\n)) %>%\n  dm_set_key(\"Warehouses\", \"ID\") %>%\n  dm_set_key(\"Loading_Costs\", c(\"Warehouse\", \"DC\")) %>%\n  dm_set_key(\"Distribution_Centers\", \"ID\") %>%\n  dm_add_references(\n    Loading_Costs$Warehouse == Warehouses$ID,  # Correct reference\n    Loading_Costs$DC == Distribution_Centers$ID  # Assuming this is the correct reference\n  )\n\n# Create and render the ERD\ndm_create_graph(dm1, rankdir = \"LR\", columnArrows = TRUE) %>%\n  dm_render_graph()\n```\n\n::: callout-tip\n### T·∫£i package datamodelr:\n\nM√¨nh t·∫°o bi·ªÉu ƒë·ªì n√†y b·∫±ng th∆∞ vi·ªán `datamodelr`. B·∫°n c√≥ th·ªÉ t·∫£i b·∫±ng c√∫ ph√°p: `devtools::install_github(\"bergant/datamodelr\")`\n:::\n\n### D·ªØ li·ªáu ƒë·∫ßu v√†o:\n\nNh∆∞ v·∫≠y, d·ª±a v√†o ƒë√≥, ta s·∫Ω t√≠nh to√°n ƒë∆∞·ª£c 2 *matrix* v·ªÅ chi ph√≠:\n\n-   B·∫£ng gi√° loading ·ªü c√°c kho. (H√¨nh b√™n tr√°i)\n\n-   B·∫£ng chi ph√≠ v·∫≠n chuy·ªÉn t·ª´ t·ª´ng WH ƒë·∫øn c√°c DCs. (H√¨nh b√™n ph·∫£i)\n\n```{r}\n#| warning: false\n#| message: false\n## Calculate the transportation cost:\n# Haversine distance function\nhaversine <- function(lat1, lon1, lat2, lon2) {\n  R <- 6371 # Radius of Earth in kilometers\n  dlat <- (lat2 - lat1) * pi / 180\n  dlon <- (lon2 - lon1) * pi / 180\n  a <- sin(dlat / 2) * sin(dlat / 2) +\n       cos(lat1 * pi / 180) * cos(lat2 * pi / 180) * \n       sin(dlon / 2) * sin(dlon / 2)\n  c <- 2 * atan2(sqrt(a), sqrt(1 - a))\n  R * c # Distance in kilometers\n}\n\n# Calculate distance matrix based on coordinates\ndistance_matrix <- matrix(0, nrow = nrow(warehouses), ncol = nrow(distribution_centers))\n\nfor (i in 1:nrow(warehouses)) {\n  for (j in 1:nrow(distribution_centers)) {\n    distance_matrix[i, j] <- haversine(\n      warehouses$Latitude[i], warehouses$Longitude[i],\n      distribution_centers$Latitude[j], distribution_centers$Longitude[j]\n    )\n  }\n}\n\n# Define the fuel price (example value)\nfuel_price <- 20 # Fuel price per kilometer\n\n# Calculate transportation costs\ntransportation_costs <- distance_matrix * fuel_price * 0.4\n\n## Calculate the loading cost:\nweights_per_good <- 0.1\n\nmean_loading_cost<-loading_costs %>% \n  group_by(DC, Warehouse) %>% \n  summarise(mean = mean(Loading_Cost,na.rm = TRUE)/1000/weights_per_good) %>% # Assumes weighted of goods is 0.1kg \n  ungroup()\n\nlibrary(data.table)\n# Reshape the data frame to a wide format\nmean_cost_matrix <- reshape2::dcast(mean_loading_cost,\n                          Warehouse ~ DC, \n                          value.var = \"mean\")\n\n# Convert the data frame to a matrix and remove the Warehouse column\nloading_costs_per_dc <- as.matrix(mean_cost_matrix[,-1])\n\n# Set row names as the warehouse names\nrownames(loading_costs_per_dc) <- mean_loading_cost$Warehouse[!duplicated(mean_loading_cost$Warehouse)]\n```\n\n```{r}\n#| warning: false\n#| message: false\n#| echo: false\n#| fig-cap: \"T·ªïng c√°c phi ph√≠ cho vi·ªác b·ªëc x·∫øp v√† v·∫≠n chuy·ªÉn h√†ng h√≥a\"\n#| fig-subcap: [\"Bi·ªÉu ƒë·ªì 2: Heatmap cho b·∫£ng chi ph√≠ b·ªëc x·∫øp\", \"Bi·ªÉu ƒë·ªì 3: B·∫£ng gi√° v·∫≠n chuy·ªÉn t·ª´ WH ƒë·∫øn DC\"]\n#| layout-ncol: 2\n# Code t·∫°o hai bi·ªÉu ƒë·ªì\n\nlibrary(ggplot2)\n\n# Convert the distance matrix to a data frame\ndistance_df <- reshape2::melt(transportation_costs)\ncolnames(distance_df) <- c(\"Warehouse\", \"Distribution_Center\", \"Transportation_Cost\")\n\n# Plot the distance matrix with updated colors\nggplot(distance_df, aes(x = Warehouse, \n                        y = Distribution_Center, \n                        fill = Transportation_Cost)) +\n  geom_tile(color = \"white\", linewidth = 0.5) +  # Add borders to tiles\n  geom_text(aes(label = scales::comma(Transportation_Cost, accuracy = 1)), \n            color = ifelse(distance_df$Transportation_Cost > \n                           max(distance_df$Transportation_Cost)/2, \"white\", \"black\"),\n            size = 3.5) +  # Adaptive text color\n  scale_fill_gradient2(\n    low = \"#f7fbff\", \n    mid = \"#6baed6\", \n    high = \"#08519c\",\n    midpoint = median(distance_df$Transportation_Cost),\n    name = \"Cost (VNƒê)\",\n    labels = scales::comma\n  ) +\n  theme_minimal() +\n  labs(\n    title = \"Transportation Costs Between Facilities\",\n    subtitle = \"Costs shown in Vietnamese Dong (VNƒê)\",\n    x = \"Warehouse\",\n    y = \"Distribution Center\"\n  ) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1, face = \"bold\", size = 12),\n    axis.text.y = element_text(face = \"bold\", size = 12),\n    axis.title.x = element_text(size = 14, face = \"bold\", margin = margin(t = 15)),\n    axis.title.y = element_text(size = 14, face = \"bold\", margin = margin(r = 15)),\n    plot.title = element_text(face = \"bold\", size = 16),\n    plot.subtitle = element_text(size = 12, color = \"gray30\"),\n    panel.grid = element_blank(),  # Remove grid lines\n    legend.position = \"right\"\n  )\n\n# Convert the transportation costs matrix to a data frame\nlibrary(gt)\nlibrary(gtExtras)\n# Create a gt table\nm<-loading_costs %>%\n  mutate(Loading_Cost = Loading_Cost * 1000,\n         DC = paste(\"DC\",DC),\n         Warehouse = paste(\"WH\",Warehouse)) # Convert to currency\n  \nhead(m[order(-m$Loading_Cost),]) %>% \n  gt() %>%\n  fmt_currency(\n    columns = Loading_Cost,\n    currency = \"VND\",\n    decimals = 0,\n    use_seps = TRUE\n  ) %>%\n  tab_header(\n    title = md(\"**Loading Costs by weight category in each warehouses**\"),\n    subtitle = md(\"Table just contains **expected loading cost**\")\n  ) %>%  \n  opt_align_table_header(align = \"center\") %>% \n  cols_label(\n    Loading_Cost = \"Loading Cost (VNƒê)\",\n    Weight_Category = \"Weight Category\",\n    Has_Machine = \"Has Machine\",\n    DC = \"Distribution Center\"\n  ) %>% \n  data_color(method = \"numeric\",\n             palette = \"viridis\",\n             reverse = TRUE) %>% \n  gt_theme_pff() %>% \n  tab_style(style = list(cell_text(align = \"center\")),\n            locations = cells_body(columns = everything())) %>%\n  tab_style(\n    style = list(\n      cell_text(align = \"center\")\n    ),\n    locations = list(\n      cells_column_labels(everything())\n    )\n  ) %>% \n  tab_source_note(source = md(\"*Source: package gt in R*\")) %>% \n  tab_style(\n    style = \"font-weight: bold\",\n    locations = cells_body(Weight_Category)\n  )\n  \n```\n\n### X√¢y d·ª±ng h√†m m·ª•c ti√™u:\n\nSau khi ƒë√£ c√≥ ƒë·ªß d·ªØ li·ªáu, b·∫°n s·∫Ω b·∫Øt ƒë·∫ßu vi·∫øt h√†m m·ª•c ti√™u v√† d√πng thu·∫≠t to√°n GA ƒë·ªÉ t√¨m ra gi√° tr·ªã t·ªëi ∆∞u nh·∫•t.\n\nTrong h√†m `ga` t·ª´ g√≥i **GA** trong R, c√≥ m·ªôt s·ªë ƒë·ªëi s·ªë quan tr·ªçng cho ph√©p b·∫°n t√πy ch·ªânh thu·∫≠t to√°n di truy·ªÅn. D∆∞·ªõi ƒë√¢y l√† m·ªôt c√°i nh√¨n t·ªïng quan v·ªÅ m·ªôt s·ªë ƒë·ªëi s·ªë quan tr·ªçng:\n\n-   **type**: Ch·ªâ ƒë·ªãnh lo·∫°i t·ªëi ∆∞u h√≥a (v√≠ d·ª•: `\"real-valued\"`, `\"binary\"` ho·∫∑c `\"permutation\"`).\n\n-   **fitness**: H√†m ƒë√°nh gi√° ƒë·ªô ph√π h·ª£p; n√≥ n√™n nh·∫≠n m·ªôt vector tham s·ªë l√†m ƒë·∫ßu v√†o v√† tr·∫£ v·ªÅ m·ªôt gi√° tr·ªã s·ªë.\n\n-   **lower** v√† **upper**: ƒê·ªãnh nghƒ©a gi·ªõi h·∫°n cho c√°c bi·∫øn n·∫øu b·∫°n ƒëang t·ªëi ∆∞u h√≥a trong kh√¥ng gian li√™n t·ª•c (d√πng cho c√°c lo·∫°i gi√° tr·ªã th·ª±c).\n\n-   **popSize**: Thi·∫øt l·∫≠p k√≠ch th∆∞·ªõc qu·∫ßn th·ªÉ cho m·ªói th·∫ø h·ªá.\n\n-   **maxiter**: Ch·ªâ ƒë·ªãnh s·ªë th·∫ø h·ªá t·ªëi ƒëa ƒë·ªÉ ch·∫°y thu·∫≠t to√°n.\n\n-   **run**: Ch·ªâ ƒë·ªãnh s·ªë th·∫ø h·ªá ƒë·ªÉ ch·∫°y thu·∫≠t to√°n m√† kh√¥ng c√≥ s·ª± c·∫£i thi·ªán tr∆∞·ªõc khi d·ª´ng l·∫°i.\n\n-   **pmutation**: X√°c su·∫•t x·∫£y ra ƒë·ªôt bi·∫øn trong qu·∫ßn th·ªÉ.\n\n-   **elitism**: X√°c ƒë·ªãnh xem c√°c c√° th·ªÉ t·ªët nh·∫•t c√≥ n√™n ƒë∆∞·ª£c gi·ªØ l·∫°i trong th·∫ø h·ªá ti·∫øp theo hay kh√¥ng.\n\nNh·ªØng ƒë·ªëi s·ªë n√†y gi√∫p ƒëi·ªÅu ch·ªânh thu·∫≠t to√°n di truy·ªÅn cho c√°c nhu c·∫ßu t·ªëi ∆∞u h√≥a c·ª• th·ªÉ c·ªßa b·∫°n, cho ph√©p hi·ªáu su·∫•t t·ªët h∆°n v√† h·ªôi t·ª• v·ªÅ c√°c gi·∫£i ph√°p t·ªëi ∆∞u.\n\nNgo√†i ra, c√≤n c√≥ c√°c l∆∞u √Ω cho b·∫°n khi s·ª≠ d·ª•ng R nh∆∞ sau:\n\n::: callout-caution\n### L∆∞u √Ω khi d√πng h√†m ga():\n\nH√†m `ga()` ph·∫£i c√≥ √≠t nh·∫•t 2 ƒë·ªëi s·ªë l√† `type` v√† `fitness th√¨ R m·ªõi ch·∫°y ƒë∆∞·ª£c.`\n\n-   Ri√™ng khi type = \"binary\" th√¨ c·∫ßn th√™m ƒë·ªëi s·ªë `nBits.`\n\n-   C√≤n khi `type = \"real-valued\"/\"permutation\"` th√¨ c·∫ßn th√™m ƒë·ªëi s·ªë `min` v√† `max`.\n:::\n\n```{r}\n#| message: false\n#| warning: false\n#| output: false\n# Load necessary library\nlibrary(GA)\ndemand<-c(distribution_centers$Demand)\n\n# Define the objective function\nobjective_function <- function(quantities) {\n    quantities_matrix <- matrix(quantities, \n                                nrow = 5, \n                                ncol = 3, \n                                byrow = TRUE)\n    \n    # Calculate total loading costs\n    loading_costs <- rowSums(quantities_matrix) * loading_costs_per_dc  # Total loading costs for each DC\n    # Calculate total transportation costs\n    transportation_costs <- sum(quantities_matrix * transportation_costs)\n    \n    # Combine both costs\n    total_cost <- sum(loading_costs) + transportation_costs\n    \n    # Check if demands are met\n    if (any(colSums(quantities_matrix) < demand)) {\n        return(Inf)  # Penalize if demands are not met\n    }\n    \n    return(total_cost)\n}\n\n# Set up the Genetic Algorithm\nnum_vars <- 5 * 3  # 5 warehouses, 3 distribution centers\nga_result <- ga(\n    type = \"real-valued\",\n    fitness = function(x) -objective_function(x),  # Negate for minimization\n    lower = rep(0, num_vars),  # Minimum quantity\n    upper = rep(100, num_vars),  # Maximum quantity (adjust as needed)\n    popSize = 50,\n    maxiter = 100,\n    run = 10,\n    monitor = TRUE\n)\n```\n\n```{r}\n#| echo: false\n#| warning: false\n#| message: false\nlibrary(leaflet)\n## Update flag of countries in each locations:\nlibrary(readxl)\nwrite <- read_excel(\"write.xlsx\")\nwarehouses<-write[1:5,]\ndistribution_centers<-write[6:8,]\n```\n\n```{r}\n#| warning: false\n#| message: false\n# Assuming ga_result@solution contains optimal quantities\nga_result_solution <- c(ga_result@solution)\n\n# Reshape the solution into a matrix (5 warehouses x 3 DCs)\noptimal_quantities <- matrix(ga_result@solution,\n                             nrow = 5, \n                             ncol = 3, \n                             byrow = TRUE)\n\n# Convert the matrix to a data frame\nweights<-optimal_quantities* weights_per_good\n\nrownames(weights) <- 1:5\ncolnames(weights) <- 1:3\n\nlibrary(reshape2)\nreal_weighted <- melt(weights)\n\n# Rename the columns\ncolnames(real_weighted) <- c(\"Warehouse\", \"DC\", \"Total_Weight\")\n\n# Perform left join\nresult <- real_weighted %>%\n  left_join(loading_costs, by = c(\"Warehouse\", \"DC\"))\n\nresult <-result %>% \n  mutate(Price = case_when(\n    Total_Weight < 1.5 ~ \"< 1.5\",\n    Total_Weight <2.5 ~ \"1.5 to 2.5\",\n    Total_Weight < 5 ~ \"2.5 to 5\",\n    Total_Weight < 10 ~ \"5 to 10\",\n    Total_Weight >= 10 ~ \"> 10\",\n      is.na(Total_Weight) ~ NA_character_  # Handle NA explicitly if needed\n  ))\n  \nresult<-result %>% \n  filter(Weight_Category == Price) %>% \n  select(-Price)\n\n# Join with tranportation cost table:\nrownames(transportation_costs) <- 1:5\ncolnames(transportation_costs) <- 1:3\n\ntransport<-melt(transportation_costs)\n\n# Rename the columns\ncolnames(transport) <- c(\"Warehouse\", \"DC\", \"Transport_cost\")\n\n\nresult<-left_join(result,\n                  transport,\n                  by=c(\"Warehouse\", \"DC\"))\n\n# Adjust:\n\nresult<-result %>% \n      mutate(Loading_Cost = Loading_Cost*1000,\n             Transport_cost = Transport_cost*1000,\n             DC = paste(\"DC\",DC),\n             Warehouse = paste(\"WH\",Warehouse)) \n\n# Reorder cols in table:\nresult<-result[,c(\"Warehouse\",\n                 \"DC\",\n                 \"Has_Machine\",\n                 \"Total_Weight\",\n                 \"Weight_Category\",\n                 \"Loading_Cost\",\n                 \"Transport_cost\")]\n```\n\n### B√°o c√°o:\n\nV√† cu·ªëi c√πng, sau khi c√≥ k·∫øt qu·∫£, m√¨nh s·∫Ω d√πng c√°c th∆∞ vi·ªán g·ªìm: **Leaflet**, **gt**, v√† **bi·ªÉu ƒë·ªì Sankey** ph·ª•c v·ª• nh·ªØng m·ª•c ƒë√≠ch kh√°c nhau cho tr·ª±c quan h√≥a d·ªØ li·ªáu.\n\n1.  **Leaflet**: ƒê√¢y l√† m·ªôt th∆∞ vi·ªán m·∫°nh m·∫Ω ƒë·ªÉ t·∫°o b·∫£n ƒë·ªì t∆∞∆°ng t√°c. N√≥ cho ph√©p ng∆∞·ªùi d√πng d·ªÖ d√†ng th√™m c√°c l·ªõp, ƒëi·ªÉm ƒë√°nh d·∫•u v√† pop-up, r·∫•t l√Ω t∆∞·ªüng ƒë·ªÉ tr·ª±c quan h√≥a d·ªØ li·ªáu ƒë·ªãa l√Ω. Leaflet ƒë·∫∑c bi·ªát h·ªØu √≠ch ƒë·ªÉ hi·ªÉn th·ªã c√°c d·ªØ li·ªáu nh∆∞ v·ªã tr√≠, l·ªô tr√¨nh, ho·∫∑c ph√¢n b·ªë kh√¥ng gian.\n\n2.  **gt**: G√≥i **gt** ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ t·∫°o ra c√°c b·∫£ng ch·∫•t l∆∞·ª£ng cao trong R. N√≥ cho ph√©p ng∆∞·ªùi d√πng ƒë·ªãnh d·∫°ng v√† t·∫°o ki·ªÉu cho b·∫£ng m·ªôt c√°ch d·ªÖ d√†ng, gi√∫p ch√∫ng tr·ªü n√™n h·∫•p d·∫´n v√† d·ªÖ ƒë·ªçc. gt h·ªó tr·ª£ c√°c t√≠nh nƒÉng nh∆∞ ƒë·ªãnh d·∫°ng t√πy ch·ªânh, d√≤ng t√≥m t·∫Øt, v√† th·∫≠m ch√≠ th√™m ch√∫ th√≠ch, n√¢ng cao c√°ch tr√¨nh b√†y d·ªØ li·ªáu trong b√°o c√°o.\n\n3.  **Bi·ªÉu ƒë·ªì Sankey**: Nh·ªØng bi·ªÉu ƒë·ªì n√†y ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ tr·ª±c quan h√≥a lu·ªìng v√† m·ªëi quan h·ªá gi·ªØa c√°c danh m·ª•c kh√°c nhau. Trong R, g√≥i **networkD3** ho·∫∑c **ggalluvial** c√≥ th·ªÉ t·∫°o ra bi·ªÉu ƒë·ªì Sankey, gi√∫p hi·ªÉu c√°ch c√°c gi√° tr·ªã di chuy·ªÉn gi·ªØa c√°c n√∫t, ch·∫≥ng h·∫°n nh∆∞ theo d√µi h√†nh tr√¨nh ng∆∞·ªùi d√πng ho·∫∑c hi·ªÉn th·ªã ph√¢n b·ªï t√†i nguy√™n.\n\nƒê·ªÉ k·∫øt n·ªëi c√°c bi·ªÉu ƒë·ªì l·∫°i v·ªõi nhau, ta th∆∞·ªùng nghƒ© ƒë·∫øn `Shiny` trong **R** nh∆∞ng v√¨ ch√∫ng ta ƒëang t·∫°o website b·∫±ng **Quarto** n√™n output cu·ªëi c√πng s·∫Ω l√† m·ªôt trang web tƒ©nh - *static website*. Do ƒë√≥, n√≥ s·∫Ω kh√¥ng ph·∫£n h·ªìi v·ªõi th√¥ng tin ƒë·∫ßu v√†o c·ªßa ng∆∞·ªùi d√πng ho·∫∑c ch·∫°y b·∫•t k·ª≥ m√£ R n√†o. B·∫°n c√≥ th·ªÉ h√¨nh dung gi·ªëng nh∆∞ b·∫°n ƒëang mu·ªën xem bi·ªÉu ƒë·ªì v·ªÅ doanh thu trong th√°ng ti·∫øp theo tr√™n 1 bi·ªÉu ƒë·ªì trong Word - kh√¥ng th·ªÉ l√†m ƒë∆∞·ª£c v√¨ n√≥ thu·ªôc d·∫°ng vƒÉn b·∫£n, b·∫°n ch·ªâ ƒë·ªçc ho·∫∑c nh√¨n ch·ª© kh√¥ng t∆∞∆°ng t√°c ƒë∆∞·ª£c.\n\nTuy v·∫≠y, sau m·ªôt th·ªùi gian t√¨m hi·ªÉu, m√¨nh c≈©ng t√¨m ƒë∆∞·ª£c c√°ch ƒë·ªÉ nh√∫ng **Shiny** v√†o R ƒë·ªÉ hi·ªÉn th·ªã tr√™n Quarto. Ngu·ªìn t√†i li·ªáu b·∫°n c√≥ th·ªÉ kham kh·∫£o ·ªü trang n√†y [r-shinylive-demo](https://github.com/coatless-quarto/r-shinylive-demo).\n\n:::{.column-page}\n\n```{shinylive-r}\n#| viewerHeight: 1000\n#| standalone: true\n#| fig-cap: \"Bi·ªÉu ƒë·ªì 3: Dashboard v·ªÅ l·ªãch tr√¨nh v·∫≠n chuy·ªÉn h√†ng d·ª± t√≠nh\"\npacman::p_load(\n  leaflet,\n  dplyr,\n  networkD3,\n  shiny,\n  bslib,\n  DT,\n  htmltools\n)\n\n# Add value:\n# Convert GA solution to a matrix\n# Optimal quantities matrix\noptimal_quantities <- matrix(c(\n  43.306058, 10.87137, 13.26283,\n  15.524054, 30.42748, 48.86716,\n  7.599769, 44.93531, 27.46289,\n  18.556927, 17.60396, 41.85203,\n  16.305016, 13.15498, 21.79634\n), nrow = 5, ncol = 3, byrow = TRUE)\n\n# Warehouse data:\nwarehouses <- data.frame(\n  ID = 1:5,\n  Latitude = c(21.0285, 16.0545, 10.7769, 14.0583, 19.8060),\n  Longitude = c(105.8040, 108.2022, 106.6957, 108.2772, 105.7460),\n  District = c(\"ƒê·ªëng ƒêa\", \"H·∫£i Ch√¢u\", \"Qu·∫≠n 1\", \"Mang Yang\", \"ƒê√¥ng S∆°n\"),\n  Province = c(\"H√† N·ªôi\", \"ƒê√† N·∫µng\", \"H·ªì Ch√≠ Minh\", \"Gia Lai\", \"Thanh H√≥a\"),\n  Address = c(\n    \"2RH3+9HX ƒê·ªëng ƒêa, H√† N·ªôi, Vi·ªát Nam\",\n    \"3632+RV4 H·∫£i Ch√¢u, ƒê√† N·∫µng, Vi·ªát Nam\",\n    \"QMGW+Q74 Qu·∫≠n 1, H·ªì Ch√≠ Minh, Vi·ªát Nam\",\n    \"375G+8VG Mang Yang, Gia Lai, Vi·ªát Nam\",\n    \"RP4W+99X ƒê√¥ng S∆°n, Thanh H√≥a, Vi·ªát Nam\"\n  )\n)\n\n# Distribution center data:\ndistribution_centers <- data.frame(\n  ID = 1:3,\n  Latitude = c(17.97486, 11.77690, 15.12233),\n  Longitude = c(102.6309, 106.6957, 108.7994),\n  District = c(\"Vi√™ng ChƒÉn\", \"L·ªôc Ninh\", \"Qu·∫£ng Ng√£i\"),\n  Province = c(\"L√†o\", \"B√¨nh Ph∆∞·ªõc\", \"Qu·∫£ng Ng√£i\"),\n  Address = c(\n    \"XJFJ+W8X Vi√™ng ChƒÉn, L√†o\",\n    \"QMGW+Q74 L·ªôc Ninh, B√¨nh Ph∆∞·ªõc, Vi·ªát Nam\",\n    \"4QCX+WPQ Qu·∫£ng Ng√£i, Vi·ªát Nam\"\n  )\n)\n\n# Create a data frame with the warehouse data\nresult <- data.frame(\n  Warehouse = c(\"WH 1\", \"WH 2\", \"WH 3\", \"WH 4\", \"WH 5\",\n                \"WH 1\", \"WH 2\", \"WH 3\", \"WH 4\", \"WH 5\",\n                \"WH 1\", \"WH 2\", \"WH 3\", \"WH 4\", \"WH 5\"),\n  DC = c(\"DC 1\", \"DC 1\", \"DC 1\", \"DC 1\", \"DC 1\",\n         \"DC 2\", \"DC 2\", \"DC 2\", \"DC 2\", \"DC 2\",\n         \"DC 3\", \"DC 3\", \"DC 3\", \"DC 3\", \"DC 3\"),\n  Has_Machine = c(\"Yes\", \"No\", \"No\", \"No\", \"No\",\n                  \"No\", \"No\", \"No\", \"No\", \"No\",\n                  \"No\", \"No\", \"No\", \"No\", \"No\"),\n  Total_Weight = c(4.3306058, 1.5524054, 0.7599769, 1.8556927, 1.6305016,\n                   1.0871366, 3.0427479, 4.4935308, 1.7603961, 1.3154977,\n                   1.3262832, 4.8867159, 2.7462887, 4.1852028, 2.1796338),\n  Weight_Category = c(\"2.5 to 5\", \"1.5 to 2.5\", \"< 1.5\", \"1.5 to 2.5\", \"1.5 to 2.5\",\n                      \"< 1.5\", \"2.5 to 5\", \"2.5 to 5\", \"1.5 to 2.5\", \"< 1.5\",\n                      \"< 1.5\", \"2.5 to 5\", \"2.5 to 5\", \"2.5 to 5\", \"1.5 to 2.5\"),\n  Loading_Cost = c(64300, 40680, 144640, 38790, 18750,\n                   11610, 97870, 36380, 69120, 70030,\n                   143740, 91150, 64990, 114230, 96240),\n  Transport_cost = c(3802097.2, 5037171.3, 7297102.2, 5952559.7, 3086494.5,\n                     8264855.3, 4021256.9, 889559.4, 2449208.3, 7188382.3,\n                     5831987.6, 974375.3, 4273915.6, 1047828.2, 4905804.6)\n)\n\n# Custom icon:\nwarehouse_icon <- makeIcon(\n  iconUrl = \"https://raw.githubusercontent.com/Loccx78vn/Genetic-Algorithm/refs/heads/main/warehouse_icon.png\",\n  iconWidth = 30,\n  iconHeight = 30\n)\n\ndc_icon <- makeIcon(\n  iconUrl = \"https://raw.githubusercontent.com/Loccx78vn/Genetic-Algorithm/refs/heads/main/distribution_center.png\",\n  iconWidth = 30,\n  iconHeight = 30\n)\n# Define a custom theme\nmy_theme <- bs_theme(\n  version = 5,\n  bootswatch = \"litera\",\n  primary = \"#3b5998\",\n  secondary = \"#5cb85c\",\n  success = \"#5cb85c\",\n  info = \"#5bc0de\",\n  warning = \"#f0ad4e\",\n  danger = \"#d9534f\"\n)\n\n# Define UI\nui <- page_fluid(\n  theme = my_theme,\n  \n  # Custom CSS for better visualization\n  tags$head(\n    tags$style(HTML(\"\n      .card-header {\n        background-color: #3b5998;\n        color: white;\n        font-weight: bold;\n      }\n      .nav-tabs .nav-link.active {\n        font-weight: bold;\n        color: #3b5998;\n        border-bottom: 2px solid #3b5998;\n      }\n      .nav-tabs .nav-link {\n        color: #6c757d;\n      }\n      .checkbox span {\n        font-weight: normal;\n      }\n      .checkbox input:checked + span {\n        font-weight: bold;\n        color: #3b5998;\n      }\n      .warehouse-selection {\n        border-left: 4px solid #3b5998;\n        padding-left: 10px;\n      }\n      .dataTables_wrapper {\n        padding: 10px;\n        border-radius: 5px;\n      }\n      .table thead th {\n        background-color: #e9ecef;\n      }\n      .leaflet-container {\n        border-radius: 8px;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n      }\n      .sankey-container {\n        border: 1px solid #dee2e6;\n        border-radius: 8px;\n        padding: 10px;\n        background-color: #f8f9fa;\n      }\n      .summary-stats {\n        background-color: #f8f9fa;\n        border-radius: 5px;\n        padding: 10px;\n        margin-bottom: 15px;\n        border-left: 4px solid #3b5998;\n      }\n    \"))\n  ),\n  \n  # Page header - simplified\n  card(\n    card_header(\n      tags$div(\n        class = \"d-flex align-items-center\",\n        tags$img(\n          src = \"https://raw.githubusercontent.com/Loccx78vn/Genetic-Algorithm/refs/heads/main/warehouse_icon.png\", \n          height = \"30px\", \n          style = \"margin-right: 10px;\"\n        ),\n        h3(\"Warehouse Distribution Dashboard\", class = \"m-0\")\n      )\n    ),\n    card_body(\n      \"This dashboard shows the optimal distribution of goods from warehouses to distribution centers.\"\n    )\n  ),\n  \n  layout_sidebar(\n    sidebar = sidebar(\n      title = \"Controls\",\n      width = 300,\n      bg = \"#f8f9fa\",\n      class = \"warehouse-selection\",\n      \n      h4(\"Warehouse Selection\", class = \"mb-3 text-primary\"),\n      \n      p(\"Select one or more warehouses to view their distribution data on the map and in the charts.\"),\n      \n      checkboxGroupInput(\n        inputId = \"warehouse\", \n        label = NULL, \n        choices = setNames(\n          paste(\"Warehouse\", 1:5),\n          paste(\"Warehouse\", 1:5, \"-\", warehouses$District, \",\", warehouses$Province)\n        ),\n        selected = paste(\"Warehouse\", 1)\n      ),\n      \n      hr(),\n      \n      tags$div(\n        class = \"alert alert-info\",\n        icon(\"info-circle\"), \n        \"Click on the map markers for detailed location information.\"\n      )\n    ),\n    \n    # Main content - restructured to put summary above map\n    tabsetPanel(\n      tabPanel(\n        title = \"Interactive Map\", \n        icon = icon(\"map\"),\n        card(\n          full_screen = TRUE,\n          height = \"650px\", # Increased height\n          card_body(\n            # Summary stats placed above the map\n            tags$div(\n              class = \"summary-stats\",\n              uiOutput(\"summary_stats\")\n            ),\n            # Map with increased height\n            leafletOutput(\"map\", height = \"550px\") # Increased map height\n          )\n        )\n      ),\n      \n      tabPanel(\n        title = \"Cost Analysis\", \n        icon = icon(\"table\"),\n        card(\n          full_screen = TRUE,\n          height = \"650px\", # Increased to match\n          card_header(\"Cost Table\"),\n          DTOutput(\"cost_table\")\n        )\n      ),\n      \n      tabPanel(\n        title = \"Flow Diagram\", \n        icon = icon(\"diagram-project\"),\n        card(\n          full_screen = TRUE,\n          height = \"650px\", # Increased to match\n          card_header(\"Distribution Flow Diagram\"),\n          tags$div(\n            class = \"sankey-container\",\n            uiOutput(\"sankey_diagram\")\n          )\n        )\n      )\n    )\n  )\n)\n\n# Define server logic\nserver <- function(input, output, session) {\n  \n  location <- reactive({\n    req(input$warehouse) \n    as.numeric(sub(\"Warehouse \", \"\", input$warehouse))\n  })\n  \n  # Create the leaflet map\n  output$map <- renderLeaflet({\n    req(location())\n    \n    # Color palette for routes\n    route_colors <- c(\"#FF5733\", \"#33A8FF\", \"#33FF57\", \"#D433FF\", \"#FFD133\")\n    \n    # Initialize the map\n    map <- leaflet() %>%\n      addTiles() %>%\n      addProviderTiles(providers$CartoDB.Positron) %>%\n      addMarkers(data = warehouses %>% filter(ID %in% location()), \n                 lat = ~Latitude, \n                 lng = ~Longitude, \n                 label = ~paste0(\"<strong> ID Warehouse: </strong> \", ID, \"<br/> \",\n                                 \"<strong> Province: </strong> \", Province, \"<br/> \",\n                                 \"<strong> District: </strong> \", District, \"<br/> \",\n                                 \"<strong> Address: </strong> \", Address, \"<br/> \") %>% \n                   lapply(htmltools::HTML),\n                 icon = warehouse_icon) %>%\n      addMarkers(data = distribution_centers, \n                 lat = ~Latitude, \n                 lng = ~Longitude, \n                 label = ~paste0(\"<strong> ID Distribution Center: </strong> \", ID, \"<br/> \",\n                                 \"<strong> Province: </strong> \", Province, \"<br/> \",\n                                 \"<strong> District: </strong> \", District, \"<br/> \",\n                                 \"<strong> Address: </strong> \", Address, \"<br/> \") %>% \n                   lapply(htmltools::HTML),\n                 icon = dc_icon)\n    \n    qty_data <- optimal_quantities[location(), , drop = FALSE]  \n    \n    # Add routes based on the optimal quantities with different colors\n    route_colors <- c(\"#FF5733\", \"#33A8FF\", \"#33FF57\", \"#D433FF\", \"#FFD133\")\n    line_weights <- c(2, 3, 4, 5, 6)  # Variable line weights based on quantity\n    \n    # Add routes based on the optimal quantities\n    for (i in seq_along(location())) {\n      wh_id <- location()[i]\n      wh_idx <- which(warehouses$ID == wh_id)\n      color_idx <- (wh_id - 1) %% length(route_colors) + 1\n      \n      for (j in 1:ncol(qty_data)) {\n        if (qty_data[i, j] > 0) {\n          route_start <- warehouses[warehouses$ID == wh_id, c(\"Longitude\", \"Latitude\")]\n          route_end <- distribution_centers[distribution_centers$ID == j, c(\"Longitude\", \"Latitude\")]\n          \n          # Calculate line weight based on quantity (normalized)\n          weight_multiplier <- qty_data[i, j] / max(optimal_quantities) * 5\n          weight <- max(2, min(6, weight_multiplier + 2))  # Scale between 2-6\n          \n          map <- map %>%\n            addPolylines(\n              lat = c(route_start$Latitude, route_end$Latitude),\n              lng = c(route_start$Longitude, route_end$Longitude),\n              color = route_colors[color_idx],\n              weight = weight,\n              opacity = 0.7,\n              label = paste0(\"Quantity: \", round(qty_data[i, j], 2)),\n              dashArray = \"5, 5\",\n              popup = paste0(\n                \"<strong>From:</strong> Warehouse \", wh_id,\n                \"<br><strong>To:</strong> Distribution Center \", j,\n                \"<br><strong>Quantity:</strong> \", round(qty_data[i, j], 2)\n              )\n            )\n        }\n      }\n    }\n    \n    map  # Return the modified map\n  })\n  \n  # Render the cost table\n  output$cost_table <- renderDT({\n    req(location())\n    \n    cost_data <- result %>% \n      filter(Warehouse %in% paste(\"WH\", location())) %>% \n      select(c(Warehouse, DC, Loading_Cost, Transport_cost))\n    \n    # Add a Total Cost column\n    cost_data$Total_Cost <- cost_data$Loading_Cost + cost_data$Transport_cost\n    \n    # Format currency values\n    cost_data$Loading_Cost <- formatC(cost_data$Loading_Cost, format=\"f\", digits=0, big.mark=\",\")\n    cost_data$Transport_cost <- formatC(cost_data$Transport_cost, format=\"f\", digits=0, big.mark=\",\")\n    cost_data$Total_Cost <- formatC(cost_data$Total_Cost, format=\"f\", digits=0, big.mark=\",\")\n    \n    datatable(cost_data,\n              options = list(\n                pageLength = 10,\n                dom = 'Bfrtip',\n                buttons = c('copy', 'csv', 'excel'),\n                initComplete = JS(\n                  \"function(settings, json) {\",\n                  \"$(this.api().table().header()).css({'background-color': '#3b5998', 'color': 'white'});\",\n                  \"}\"\n                ),\n                columnDefs = list(\n                  list(className = 'dt-center', targets = \"_all\")\n                )\n              ),\n              rownames = FALSE,\n              class = 'compact stripe hover') %>%\n      formatStyle(\n        'Warehouse',\n        backgroundColor = styleEqual(\n          paste(\"WH\", 1:5), \n          c('#FFC3A0', '#A0D2FF', '#C8FFB0', '#D5A0FF', '#FFF0A0')\n        )\n      ) %>%\n      formatStyle(\n        'DC',\n        backgroundColor = styleEqual(\n          c(\"DC 1\", \"DC 2\", \"DC 3\"), \n          c('#FFDDC3', '#C3E5FF', '#DDFFC3')\n        )\n      )\n  })\n  \n  \n  # Create and render the Sankey diagram\n  selected_indices <- reactive({\n    as.numeric(sub(\"Warehouse \", \"\", input$warehouse))\n  })\n  \n  # Filter data based on selected warehouses\n  filtered_data <- reactive({\n    result %>%\n      filter(Warehouse %in% paste(\"WH\",input$warehouse))\n  })\n\n  # Create and render the Sankey diagram\n  output$sankey_diagram <- renderUI({\n    req(length(selected_indices()) > 0)\n    \n    # Create links data frame\n    links <- data.frame()\n    \n    # Add links for each selected warehouse\n    for (i in 1:length(selected_indices())) {\n      wh_idx <- selected_indices()[i]\n      wh_data <- optimal_quantities[wh_idx, , drop = FALSE]\n      \n      # Add links for each DC\n      for (j in 1:ncol(wh_data)) {\n        if (wh_data[1, j] > 0) {\n          links <- rbind(links, data.frame(\n            source = i - 1,  # Use index in selected warehouses (0-based)\n            target = length(selected_indices()) + j - 1,  # DCs come after warehouses\n            value = wh_data[1, j]\n          ))\n        }\n      }\n    }\n    \n    # Only proceed if we have links\n    req(nrow(links) > 0)\n    \n    # Create nodes data frame\n    nodes <- data.frame(\n      name = c(paste(\"Warehouse\", selected_indices()), paste(\"DC\", 1:3))\n    )\n    \n    # Create the Sankey network\n    sankey <- sankeyNetwork(\n      Links = links, \n      Nodes = nodes, \n      Source = \"source\", \n      Target = \"target\", \n      Value = \"value\",\n      NodeID = \"name\",\n      height = 500,  \n      width = 800,\n      fontSize = 12,\n      nodeWidth = 20,\n      sinksRight = TRUE\n    )\n    \n    # Customize tooltips and add click functionality to show a value panel\n    sankey <- htmlwidgets::onRender(sankey, \"\n    function(el, x) {\n      // Create a div for the value panel\n      var valuePanel = d3.select('body').append('div')\n        .attr('class', 'value-panel')\n        .style('position', 'absolute')\n        .style('padding', '8px')\n        .style('background', 'lightgray')\n        .style('border', '1px solid gray')\n        .style('border-radius', '4px')\n        .style('opacity', 0);  // Start hidden\n\n      // Append title for tooltips on hover\n      d3.selectAll('.link')\n        .append('title')\n        .text(function(d) { return 'Quantity: ' + d.value.toFixed(2); });  // Show value on hover\n\n      // Add click event to show the value panel\n      d3.selectAll('.link')\n        .on('click', function(event, d) {\n          // Ensure we get the correct value\n          var value = d3.select(this).datum().value;\n          var source = nodes.name[d.source.index];\n          var target = nodes.name[d.target.index];\n\n          // Position the value panel near the mouse cursor\n          valuePanel\n            .style('left', (event.pageX + 5) + 'px')\n            .style('top', (event.pageY + 5) + 'px')\n            .style('opacity', 1)  // Make it visible\n            .html('From: ' + source + '<br>To: ' + target + '<br>Quantity: ' + value.toFixed(2));  // Set the text with details\n\n          // Hide the panel after a delay\n          setTimeout(function() {\n            valuePanel.style('opacity', 0);\n          }, 3000);  // Change the delay as needed\n        });\n    }\n    \")\n    \n    # Add title and caption\n    tagList(\n      sankey,\n      tags$p(style = \"font-size: 12px; text-align: right;\", \n             \"A wider arrow indicates that a larger quantity is being sent from that warehouse to a distribution center.\")\n    )\n  })\n  \n  # Add a summary statistics output at the bottom of the map tab\n  output$summary_stats <- renderUI({\n    req(location())\n    \n    selected_data <- result %>% \n      filter(Warehouse %in% paste(\"WH\", location()))\n    \n    total_loading <- sum(selected_data$Loading_Cost)\n    total_transport <- sum(selected_data$Transport_cost)\n    total_weight <- sum(selected_data$Total_Weight)\n    \n    div(\n      class = \"mt-3 p-3 bg-light rounded\",\n      h4(\"Summary Statistics\", class = \"text-primary mb-3\"),\n      div(class = \"row\",\n          div(class = \"col-md-4\",\n              div(class = \"card text-white bg-primary mb-3\",\n                  div(class = \"card-body\",\n                      h5(class = \"card-title\", \"Total Weight\"),\n                      h3(class = \"card-text\", paste0(round(total_weight, 2), \" tons\"))\n                  )\n              )\n          ),\n          div(class = \"col-md-4\",\n              div(class = \"card text-white bg-success mb-3\",\n                  div(class = \"card-body\",\n                      h5(class = \"card-title\", \"Total Loading Cost\"),\n                      h3(class = \"card-text\", paste0(\"‚Ç´\", formatC(total_loading, format=\"f\", digits=0, big.mark=\",\")))\n                  )\n              )\n          ),\n          div(class = \"col-md-4\",\n              div(class = \"card text-white bg-info mb-3\",\n                  div(class = \"card-body\",\n                      h5(class = \"card-title\", \"Total Transport Cost\"),\n                      h3(class = \"card-text\", paste0(\"‚Ç´\", formatC(total_transport, format=\"f\", digits=0, big.mark=\",\")))\n                  )\n              )\n          )\n      )\n    )\n  })\n}\n\n# Run the application \nshinyApp(ui = ui, server = server)\n```\n:::\n\nB·∫°n c√≥ th·ªÉ th·∫•y v·ªõi **dashboard** nh∆∞ v·∫≠y, ta c√≥ th·ªÉ xem ƒë∆∞·ª£c nhi·ªÅu th√¥ng tin h∆°n nh∆∞:\n\n-   V·ªã tr√≠ c·ª• th·ªÉ c·ªßa t·ª´ng *WH* v√† *DC* c≈©ng nh∆∞ l√† c√°c tuy·∫øn ƒë∆∞·ªùng d·ª± ki·∫øn b·∫±ng c√°c ƒë∆∞·ªùng th·∫≥ng minh h·ªça. (Xem **Map tab**)\n\n-   Th√¥ng tin v·ªÅ chi ph√≠ *Loading cost* v√† *Transporation cost* c≈©ng nh∆∞ l∆∞·ª£ng h√†ng c·∫ßn v·∫≠n chuy·ªÉn cho t·ª´ng nh√† kho. (Xem **Table and Sankey tab**)\n\nB·∫°n c√≥ th·ªÉ xem cho 1 ho·∫∑c nhi·ªÅu nh√† kho b·∫±ng c√°ch *click* tr√™n thanh **Filter**. Ngo√†i ra, ƒë·∫∑c bi·ªát v·ªõi **Sankey chart**, b·∫°n c·∫ßn gi·ªØ ho·∫∑c *click* chu·ªôt v√†o tuy·∫øn ƒë·ªÉ xem ƒë∆∞·ª£c s·ªë l∆∞·ª£ng h√†ng.\n\nTuy r·∫•t th√≠ch R nh∆∞ng m√¨nh v·∫´n kh√¥ng th√≠ch x√¢y d·ª±ng dashboard b·∫±ng R l·∫Øm v√¨ qu√° n·∫∑ng v·ªÅ code v√† kh√¥ng hi·ªáu qu·∫£ v·ªÅ th·ªùi gian, ngu·ªìn l·ª±c. C√°c tools kh√°c m√¨nh ∆∞u ti√™n h∆°n nh∆∞ **Power BI**, **Tableau** ho·∫∑c c√°c **BIs** m√† c√¥ng ty b·∫°n s·ª≠ d·ª•ng trong c√¥ng vi·ªác h·∫±ng ng√†y.\n\n## M√¥ h√¨nh MILP:\n\nTi·∫øp theo ta s·∫Ω chuy·ªÉn sang thu·∫≠t to√°n tuy·∫øn t√≠nh m·ªõi l√† m√¥ h√¨nh MILP.\n\n### Gi·ªõi thi·ªáu s∆° l∆∞·ª£c:\n\n**MILP (Mixed Integer Linear Programming)** l√† m·ªôt ph∆∞∆°ng ph√°p t·ªëi ∆∞u h√≥a ƒë∆∞·ª£c s·ª≠ d·ª•ng trong c√°c b√†i to√°n l·∫≠p k·∫ø ho·∫°ch, ph√¢n b·ªï t√†i nguy√™n, v√† quy·∫øt ƒë·ªãnh trong c√°c lƒ©nh v·ª±c nh∆∞ logistics, s·∫£n xu·∫•t, t√†i ch√≠nh, v√† nhi·ªÅu lƒ©nh v·ª±c kh√°c. MILP l√† m·ªôt ph·∫ßn m·ªü r·ªông c·ªßa l·∫≠p tr√¨nh tuy·∫øn t√≠nh (Linear Programming - LP), trong ƒë√≥ c√≥ c√°c bi·∫øn l√† s·ªë nguy√™n (integer variables) b√™n c·∫°nh c√°c bi·∫øn li√™n t·ª•c (continuous variables).\n\nTrong ƒë√≥, c·∫•u tr√∫c c·ªßa m·ªôt b√†i to√°n MILP bao g·ªìm:\n\n1.  **H√†m m·ª•c ti√™u**: L√† m·ªôt h√†m tuy·∫øn t√≠nh m√† b·∫°n mu·ªën t·ªëi ∆∞u h√≥a (t·ªëi ƒëa h√≥a ho·∫∑c t·ªëi thi·ªÉu h√≥a).\n\n    $$\n    \\text{Maximize or Minimize } Z = c_1x_1 + c_2x_2 + \\ldots + c_nx_n\n    $$\n\n2.  **R√†ng bu·ªôc**: Bao g·ªìm c√°c ƒëi·ªÅu ki·ªán tuy·∫øn t√≠nh m√† c√°c bi·∫øn ph·∫£i th·ªèa m√£n.\n\n    $$\n    a_{11}x_1 + a_{12}x_2 + \\ldots + a_{1n}x_n \\leq b_1\n    $$\n\n    $$\n    a_{21}x_1 + a_{22}x_2 + \\ldots + a_{2n}x_n \\leq b_2\n    $$\n\n    ... v√† nhi·ªÅu r√†ng bu·ªôc kh√°c.\n\n3.  **Bi·∫øn quy·∫øt ƒë·ªãnh**: C√°c bi·∫øn trong b√†i to√°n c√≥ th·ªÉ l√†:\n\n    -   Bi·∫øn li√™n t·ª•c: C√≥ th·ªÉ nh·∫≠n m·ªçi gi√° tr·ªã th·ª±c (v√≠ d·ª•: s·ªë l∆∞·ª£ng s·∫£n ph·∫©m).\n    -   Bi·∫øn nguy√™n: Ch·ªâ nh·∫≠n gi√° tr·ªã nguy√™n (v√≠ d·ª•: s·ªë l∆∞·ª£ng xe t·∫£i).\n    -   Bi·∫øn nh·ªã ph√¢n: Ch·ªâ nh·∫≠n gi√° tr·ªã 0 ho·∫∑c 1 (v√≠ d·ª•: c√≥ ho·∫∑c kh√¥ng s·ª≠ d·ª•ng m·ªôt nh√† m√°y).\n\nM√¥ h√¨nh **MILP** l√† m·ªôt c√¥ng c·ª• m·∫°nh m·∫Ω cho vi·ªác t·ªëi ∆∞u h√≥a trong nhi·ªÅu lƒ©nh v·ª±c kh√°c nhau. V·ªõi kh·∫£ nƒÉng k·∫øt h·ª£p gi·ªØa c√°c bi·∫øn li√™n t·ª•c v√† s·ªë nguy√™n, MILP c√≥ th·ªÉ gi·∫£i quy·∫øt nhi·ªÅu b√†i to√°n ph·ª©c t·∫°p m√† c√°c ph∆∞∆°ng ph√°p t·ªëi ∆∞u h√≥a kh√°c kh√¥ng th·ªÉ th·ª±c hi·ªán hi·ªáu qu·∫£. C√°c ·ª©ng d·ª•ng ph·ªï bi·∫øn bao g·ªìm:\n\n-   **Qu·∫£n l√Ω chu·ªói cung ·ª©ng**: T·ªëi ∆∞u h√≥a vi·ªác ph√¢n ph·ªëi h√†ng h√≥a t·ª´ c√°c kho ƒë·∫øn c√°c kh√°ch h√†ng.\n-   **L·∫≠p k·∫ø ho·∫°ch s·∫£n xu·∫•t**: X√°c ƒë·ªãnh s·ªë l∆∞·ª£ng s·∫£n ph·∫©m c·∫ßn s·∫£n xu·∫•t ƒë·ªÉ t·ªëi ƒëa h√≥a l·ª£i nhu·∫≠n ho·∫∑c gi·∫£m chi ph√≠.\n-   **T·ªëi ∆∞u h√≥a l·ªãch tr√¨nh**: L·∫≠p l·ªãch cho nh√¢n vi√™n, m√°y m√≥c, ho·∫∑c t√†i nguy√™n ƒë·ªÉ t·ªëi ∆∞u h√≥a hi·ªáu su·∫•t.\n-   **Quy ho·∫°ch ƒë√¥ th·ªã**: T·ªëi ∆∞u h√≥a vi·ªác s·ª≠ d·ª•ng ƒë·∫•t v√† t√†i nguy√™n trong quy ho·∫°ch th√†nh ph·ªë.\n\nTrong R c√≥ c√°c th∆∞ vi·ªán nh∆∞ `lpSolve`, `ompr`, v√† `ROI` c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ gi·∫£i quy·∫øt c√°c b√†i to√°n MILP.\n\n### V√≠ d·ª• v·ªÅ m√¥ h√¨nh MILP:\n\nG·ªâa s·ª≠ ta c√≥ b√†i to√°n v·ªÅ v·∫•n ƒë·ªÅ **Transshipment** c√≥ y√™u c·∫ßu l√† t√¨m ra ph∆∞∆°ng √°n v·∫≠n t·∫£i t·ªëi ∆∞u nh·∫•t ƒë·ªÉ v·∫≠n chuy·ªÉn h√†ng h√≥a t·ª´ nh√† m√°y (**Factory**) th√¥ng qua **Crossdocking** v√† ƒë·∫øn ƒë∆∞·ª£c **Distribution Center** v·ªõi m·ª•c ti√™u l√† ƒë·∫°t **chi ph√≠ th·∫•p nh·∫•t**.\n\n```{=html}\n<div style=\"text-align: center; margin-bottom: 20px;\">\n  <img src=\"img/transshipment.png\" style=\"max-width: 100%; height: auto; display: block; margin: 0 auto;\">\n  \n  <!-- Picture Name -->\n  <div style=\"text-align: left; margin-top: 10px;\">\n    H√¨nh 5: V·∫•n ƒë·ªÅ Transshipment\n  </div>\n  \n  <!-- Source Link -->\n  <div style=\"text-align: right; font-style: italic; margin-top: 5px;\">\n    Source: <a href=\"https://posit.co/download/rstudio-desktop/\">Rstudio</a>\n  </div>\n</div>\n```\n\nV√¨ b√†i to√°n n√†y thu·ªôc d·∫°ng tuy·∫øn t√≠nh n√™n ph∆∞∆°ng ph√°p MILP s·∫Ω l√†m t·ªët h∆°n nhi·ªÅu so v·ªõi thu·∫≠t to√°n GA b√™n tr√™n. K·∫øt qu·∫£ ƒë∆∞·ª£c tr√¨nh b√†y b√™n d∆∞·ªõi ƒë√¢y\n\n```{r}\n#| warning: false\n#| message: false\n#| output: false\n#| fig-cap: \"Bi·ªÉu ƒë·ªì 4: K·∫øt qu·∫£ t·ª´ m√¥ h√¨nh MILP\"\nlibrary(ompr)\nlibrary(ompr.roi)\nlibrary(ROI.plugin.glpk)\n#Input:\nSupply <-c(200,300,100,150,220)\nDemand <-c(150,100,110,200,180)\nDC<-2\nm<-length(Supply)\nn<-length(Demand)\n\nCost_CD<-read.table(text = \n                    \"CD1 CD2\n                     30 50\n                     23 66\n                     35 14\n                     70 12\n                     65 70\",header = T)\nCost_DC<-read.table(text = \n                      \"DC1 DC2 DC3 DC4 DC5\n                       12 25 22 40 41\n                       65 22 23 12 15\",header = T)\n\n#MILP model from the \nmodel5 <- MIPModel() %>%\n  # Add variable\n  add_variable(x[i, j], i = 1:m, j = 1:DC) %>%\n  add_variable(y[j, k], j = 1:DC, k = 1:n) %>%\n  # minimize the cost of transshipment:\n  set_objective(sum_expr(x[i, j]*Cost_CD[i, j],i = 1:m, j = 1:DC)+ sum_expr(y[j, k]*Cost_DC[j, k], k = 1:n, j = 1:DC),\"min\") %>%\n  add_constraint(sum_expr(y[j, k], j = 1:DC) >= Demand[k], k = 1:n) %>%\n  # The amount of inventory in Crossdocking is smaller than production goods\n  add_constraint(sum_expr(x[i, j], j = 1:DC) <= Supply[i], i = 1:m) %>% \n  # The amount of is bigger than demand in DC\n  add_constraint(sum_expr(x[i, j], i = 1:m) - sum_expr(y[j, k], k = 1:n) >= 0,j = 1:DC) %>%\n  add_constraint(x[i, j] >= 0, j = 1:DC, i = 1:m)%>% \n  add_constraint(y[j, k] >= 0, j = 1:DC, k = 1:n)%>% \n  #Solve the model:\n  solve_model(with_ROI(solver = \"glpk\", verbose = TRUE))\n```\n\n```{r}\n#| layout: [[50,50]]\n#| warning: false\n#| message: false\n#| echo: false\n\n## Table:\nsolution <- get_solution(model5, x[i, j]) %>% \n     filter(value > 0)\n\nlibrary(gt)\nlibrary(dplyr)\nlibrary(scales)  \n\n# Assuming `solution` contains the results of x[i, j]\n# Transform the solution into a tidy format for the table\ntable_data <- solution %>%\n  rename(Manufacturer = i, DC = j, Flow = value) %>%\n  mutate(Manufacturer = paste(\"Manufacturer\", Manufacturer),\n         DC = paste(\"DC\", DC)) %>% \n  select(-variable)\n\n# Create a gt table\ntable_data %>%\n  gt() %>%\n  tab_header(\n    title = md(\"**Transshipment flows from Manufacturers to Distribution Centers**\")\n  ) %>%\n  cols_label(\n    Manufacturer = md(\"**Manufacturer**\"),\n    DC = md(\"**Distribution Center**\"),\n    Flow = md(\"**Flow Amount**\")) %>%\n  fmt_number(\n    columns = c(Flow),\n    decimals = 2\n  ) %>%\n  data_color(\n    columns = c(Flow),  # Use c() instead of vars()\n    colors = scales::col_numeric(palette = c(\"#2ca02c\",\"#ff7f0e\"), domain = NULL)\n  ) %>%\n  cols_align(\n    align = \"center\",\n    columns = everything()  # Applies to all columns\n  ) %>%\n  tab_options(\n    table.width = pct(100)\n  ) %>% \n  gt_theme_espn()\n\n## Barchart:\n\nlibrary(ggplot2)\nplot_data <- solution %>%\n  rename(Manufacter= i, DC = j, Flow = value) %>%\n  mutate(Manufacter = paste(\"Manufacter\", Manufacter),\n         DC = paste(\"DC\", DC))\n\n# Create a plot\nggplot(plot_data, aes(x = Manufacter, y = Flow, fill = DC)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  theme_minimal() +\n  labs(title = \"\",\n       x = \"Manufacters\",\n       y = \"Flow Amount\",\n       fill = \"Distribution Centers\") +\n  theme(text = element_text(size = 12),\n        axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_brewer(palette = \"Set2\")\n```\n\nNh∆∞ v·∫≠y, ch√∫ng ta ƒë√£ ƒë∆∞·ª£c h·ªçc v·ªÅ thu·∫≠t to√°n Genetic v√† m√¥ h√¨nh MILP c≈©ng nh∆∞ c√°ch th·ª±c hi·ªán trong Rstudio.\n\nN·∫øu b·∫°n c√≥ c√¢u h·ªèi hay th·∫Øc m·∫Øc n√†o, ƒë·ª´ng ng·∫ßn ng·∫°i li√™n h·ªá v·ªõi m√¨nh qua Gmail. B√™n c·∫°nh ƒë√≥, n·∫øu b·∫°n mu·ªën xem l·∫°i c√°c b√†i vi·∫øt tr∆∞·ªõc ƒë√¢y c·ªßa m√¨nh, h√£y nh·∫•n v√†o hai n√∫t d∆∞·ªõi ƒë√¢y ƒë·ªÉ truy c·∫≠p trang **Rpubs** ho·∫∑c m√£ ngu·ªìn tr√™n **Github**. R·∫•t vui ƒë∆∞·ª£c ƒë·ªìng h√†nh c√πng b·∫°n, h·∫πn g·∫∑p l·∫°i! üòÑüòÑüòÑ\n\n```{=html}\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Contact Me</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css\">\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/simple-icons@v6.0.0/svgs/rstudio.svg\">\n    <style>\n        body { font-family: Arial, sans-serif; background-color: $secondary-color; }\n        .container { max-width: 400px; margin: auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); }\n        label { display: block; margin: 10px 0 5px; }\n        input[type=\"email\"] { width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px; }\n        .github-button, .rpubs-button { margin-top: 20px; text-align: center; }\n        .github-button button, .rpubs-button button { background-color: #333; color: white; border: none; padding: 10px; cursor: pointer; border-radius: 4px; width: 100%; }\n        .github-button button:hover, .rpubs-button button:hover { background-color: #555; }\n        .rpubs-button button { background-color: #75AADB; }\n        .rpubs-button button:hover { background-color: #5A9BC2; }\n        .rpubs-icon { margin-right: 5px; width: 20px; vertical-align: middle; filter: brightness(0) invert(1); }\n        .error-message { color: red; font-size: 0.9em; margin-top: 5px; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h2>Contact Me</h2>\n        <form id=\"emailForm\">\n            <label for=\"email\">Your Email:</label>\n            <input type=\"email\" id=\"email\" name=\"email\" required aria-label=\"Email Address\">\n            <div class=\"error-message\" id=\"error-message\" style=\"display: none;\">Please enter a valid email address.</div>\n            <button type=\"submit\">Send Email</button>\n        </form>\n        <div class=\"github-button\">\n            <button>\n                <a href=\"https://github.com/Loccx78vn\" target=\"_blank\" style=\"color: white; text-decoration: none;\">\n                    <i class=\"fab fa-github\"></i> View Code on GitHub\n                </a>\n            </button>\n        </div>\n        <div class=\"rpubs-button\">\n            <button>\n                <a href=\"https://rpubs.com/loccx\" target=\"_blank\" style=\"color: white; text-decoration: none;\">\n                    <img src=\"https://cdn.jsdelivr.net/npm/simple-icons@v6.0.0/icons/rstudio.svg\" alt=\"RStudio icon\" class=\"rpubs-icon\"> Visit my RPubs\n                </a>\n            </button>\n        </div>\n    </div>\n\n    <script>\n        document.getElementById('emailForm').addEventListener('submit', function(event) {\n            event.preventDefault(); // Prevent default form submission\n            const emailInput = document.getElementById('email');\n            const email = emailInput.value;\n            const errorMessage = document.getElementById('error-message');\n\n            // Simple email validation regex\n            const emailPattern = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n\n            if (emailPattern.test(email)) {\n                errorMessage.style.display = 'none'; // Hide error message\n                const yourEmail = 'loccaoxuan103@gmail.com'; // Your email\n                const gmailLink = `https://mail.google.com/mail/?view=cm&fs=1&to=${yourEmail}&su=Help%20Request%20from%20${encodeURIComponent(email)}`;\n                window.open(gmailLink, '_blank'); // Open in new tab\n            } else {\n                errorMessage.style.display = 'block'; // Show error message\n            }\n        });\n    </script>\n</body>\n</html>\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"include-in-header":["toc-filter.html",{"text":"<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css\">\n"}],"number-sections":true,"filters":["quarto-ext/shinylive"],"output-file":"GA.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.31","theme":"theme.scss","title":"Genetic Algorithms in R","subtitle":"Vi·ªát Nam, 2024","categories":["SupplyChainManagement","Logistics","Genetic Algorithm"],"description":"ƒê√¢y l√† b√†i vi·∫øt c·ªßa t√¥i v·ªÅ c√°ch s·ª≠ d·ª•ng R trong ·ª©ng d·ª•ng Genetic Algorithm trong Supply Chain","bibliography":["references.bib"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}