<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Đây là bài viết của tôi về cách sử dụng R trong ứng dụng Genetic Algorithm trong Supply Chain">

<title>Genetic Algorithms in R – Cao Xuân Lộc</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-17f353342b47b0021f2114b007a947a2.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dc6a4911c1f8cf9cbeadb5f542715996.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<meta name="shinylive:serviceworker_dir" content=".">
<script src="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/load-shinylive-sw.js" type="module"></script>
<script src="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/run-python-blocks.js" type="module"></script>
<link href="site_libs/quarto-contrib/shinylive-0.9.1/shinylive/shinylive.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/shinylive-quarto-css/shinylive-quarto.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<!-- toc-filter.html -->

<script>

  document.addEventListener('DOMContentLoaded', function () {

    const sidebar = document.querySelector('.sidebar nav[role="doc-toc"]');

    if (!sidebar) return;



    // Create and insert search input

    const input = document.createElement('input');

    input.type = 'text';

    input.id = 'toc-search';

    input.placeholder = 'Search...';

    input.classList.add('toc-search'); // for styling

    sidebar.prepend(input);



    // Select all TOC links and list items, all nested levels

    const allLinks = sidebar.querySelectorAll('ul li a');

    const allItems = sidebar.querySelectorAll('ul li');



    input.addEventListener('input', function () {

      const query = this.value.trim().toLowerCase();



      // Hide all items initially

      allItems.forEach(item => {

        item.dataset.searchHidden = 'true';

      });



      // Show matching items and all their ancestor <li>s recursively

      allLinks.forEach(link => {

        const text = link.textContent.toLowerCase();

        if (text.includes(query)) {

          let current = link.closest('li');

          while (current && current.tagName === 'LI') {

            current.dataset.searchHidden = 'false';

            // Move up: parent <li> if nested, else null

            current = current.parentElement.closest('li');

          }

        }

      });



      // Show or hide items based on dataset flag

      allItems.forEach(item => {

        // If search is empty, show all items

        if (query === '') {

          item.style.display = '';

        } else {

          item.style.display = (item.dataset.searchHidden === 'true') ? 'none' : '';

        }

      });

    });

  });

</script>

<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/viz-1.8.2/viz.js"></script>

<link href="site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">

<script src="site_libs/grViz-binding-1.0.11/grViz.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Cao Xuân Lộc</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text"><i class="fa-solid fa-house"></i> Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./GA.html" aria-current="page"> 
<span class="menu-text"><i class="fa-solid fa-dna"></i> Genetic Algorithm</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./MILP.html"> 
<span class="menu-text"><i class="fa-solid fa-calculator"></i> MILP model</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/Loccx78vn/genetic-algorithm-method"> 
<span class="menu-text"><i class="fab fa-github"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.facebook.com/cao.loc.9693"> 
<span class="menu-text"><i class="fab fa-facebook"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://rpubs.com/loccx"> 
<span class="menu-text"><img src="https://www.r-project.org/Rlogo.png" width="20" style="margin-right:5px;"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#giới-thiệu" id="toc-giới-thiệu" class="nav-link active" data-scroll-target="#giới-thiệu"><span class="header-section-number">1</span> Giới thiệu:</a>
  <ul class="collapse">
  <li><a href="#vài-điểm-về-thuật-toán-genetic" id="toc-vài-điểm-về-thuật-toán-genetic" class="nav-link" data-scroll-target="#vài-điểm-về-thuật-toán-genetic"><span class="header-section-number">1.1</span> Vài điểm về thuật toán Genetic:</a></li>
  <li><a href="#cách-hoạt-động-ga-trong-ml" id="toc-cách-hoạt-động-ga-trong-ml" class="nav-link" data-scroll-target="#cách-hoạt-động-ga-trong-ml"><span class="header-section-number">1.2</span> Cách hoạt động GA trong ML:</a></li>
  </ul></li>
  <li><a href="#thực-hành-trong-r" id="toc-thực-hành-trong-r" class="nav-link" data-scroll-target="#thực-hành-trong-r"><span class="header-section-number">2</span> Thực hành trong R:</a>
  <ul class="collapse">
  <li><a href="#thuật-toán-genetic" id="toc-thuật-toán-genetic" class="nav-link" data-scroll-target="#thuật-toán-genetic"><span class="header-section-number">2.1</span> Thuật toán Genetic:</a>
  <ul class="collapse">
  <li><a href="#dữ-liệu-đầu-vào" id="toc-dữ-liệu-đầu-vào" class="nav-link" data-scroll-target="#dữ-liệu-đầu-vào"><span class="header-section-number">2.1.1</span> Dữ liệu đầu vào:</a></li>
  <li><a href="#xây-dựng-hàm-mục-tiêu" id="toc-xây-dựng-hàm-mục-tiêu" class="nav-link" data-scroll-target="#xây-dựng-hàm-mục-tiêu"><span class="header-section-number">2.1.2</span> Xây dựng hàm mục tiêu:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#báo-cáo" id="toc-báo-cáo" class="nav-link" data-scroll-target="#báo-cáo"><span class="header-section-number">3</span> Báo cáo:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Genetic Algorithms in R</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Việt Nam, 2024</p>
  <div class="quarto-categories">
    <div class="quarto-category">SupplyChainManagement</div>
    <div class="quarto-category">Logistics</div>
    <div class="quarto-category">Genetic Algorithm</div>
  </div>
  </div>

<div>
  <div class="description">
    Đây là bài viết của tôi về cách sử dụng R trong ứng dụng Genetic Algorithm trong Supply Chain
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="giới-thiệu" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Giới thiệu:</h1>
<section id="vài-điểm-về-thuật-toán-genetic" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="vài-điểm-về-thuật-toán-genetic"><span class="header-section-number">1.1</span> Vài điểm về thuật toán Genetic:</h2>
<p><strong>GA</strong> hay <strong>Genetic Algorithm</strong> là 1 thuật toán tối ưu hóa ngẫu nhiên (<strong>stochastic search algorithms</strong>), được phát triển dựa trên lý thuyết tiến hóa và sự chọn lọc tự nhiên của sinh học <span class="citation" data-cites="lucascrucca2013">(<a href="#ref-lucascrucca2013" role="doc-biblioref">Luca Scrucca 2013</a>)</span>.</p>
<p>Ở thời cấp 3, bạn đã từng học về lý thuyết tiến hóa và chọn lọc tự nhiên của <a href="https://vi.wikipedia.org/wiki/Charles_Darwin">Charles Darwin</a> và <a href="https://vi.wikipedia.org/wiki/Alfred_Russel_Wallace">Alfred Russel</a> ở môn Sinh học. Nếu bạn cũng từng liệt Sinh như tôi thì bạn quên cũng không sao 😅😅. Vậy thì để tôi giải thích lại như sau:</p>
<p>Sự tiến hóa là sự thay đổi đặc điểm di truyền của 1 quần thể sinh vật, ví dụ điển hình chính là từ loại vượn đã tiến hóa thành hình dạng con người văn minh như các bạn bây giờ. Vậy quá trình tiến hóa đó diễn ra khi có sự chọn lọc tự nhiên tạo ra các biến dị di truyền (Ví dụ: đột biến,…) và kết quả là các cá thể đột biến trở nên phổ biến hơn hoặc hiếm gặp hơn trong quần thể. Vậy điều kiện để xảy ra sự chọn lọc tự nhiên có thể là sự thay đổi về môi trường sống, địa lý,… dẫn tới sự khác nhau về khả năng sống sót và sinh sản.</p>
<p>Kết cục là xuất hiện các cá thể đột biến “mạnh mẽ hơn” hoặc đúng là “đặc biệt hơn” có khả năng tồn tại khi xuất hiện sự thay đổi lớn, ví dụ như dưới đây, do sự thay đổi về địa điểm sống, từ một loại chim sẻ đã phát triển thành 3 phân họ khác nhau.</p>
<div style="text-align: center; margin-bottom: 20px;">
  <img src="img/Natural_selection.jpg" style="max-width: 80%; height: auto; display: block; margin: 0 auto;">
  
  <!-- Picture Name -->
  <div style="text-align: left; margin-top: 10px;">
    Hình 1: Ví dụ về chọn lọc tự nhiên
  </div>
  
  <!-- Source Link -->
  <div style="text-align: right; font-style: italic; margin-top: 5px;">
    Source: <a href="https://www.biologyonline.com/dictionary/natural-selection">Link to Image</a>
  </div>
</div>
<p>Vậy lí thuyết này liên quan gì tới vấn đề tối ưu hóa. Thông thường khi bạn muốn tối ưu hóa một vấn đề gì đó, bạn cần xây dựng mô hình định lượng nó, ví dụ như dưới ảnh này ta đang có mô hình <a href="https://www.mathworks.com/help/optim/ug/mixed-integer-linear-programming-algorithms.html">MILP</a> nhằm hoạch định tuyến đường và tối ưu hóa quãng đường di chuyển.</p>
<div style="text-align: center; margin-bottom: 20px;">
  <img src="img/MILP.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;">
  
  <!-- Picture Name -->
  <div style="text-align: left; margin-top: 10px;">
    Hình 2: Mô hình VRP
  </div>
  
  <!-- Source Link -->
  <div style="text-align: right; font-style: italic; margin-top: 5px;">
    Source: <a href="https://medium.com/@rihot_gusron/capacitated-vehicle-routing-problem-with-lingo-427c2d3bf724">Link to Image</a>
  </div>
</div>
<p>Mục tiêu của hàm chính là tìm ra giá trị nhỏ nhất nghĩa là chi phí cho việc di chuyển của xe là nhỏ nhất. Do đó, bạn có thể hình dung rằng <strong>giá trị nhỏ nhất</strong> đó như là các <strong>cá thể đột biến</strong> có khả năng sống sót cao nhất trong quẩn thể.</p>
<p>Vì vậy thuật toán <strong>Genetic</strong> (GA) chính là lặp đi lặp lại sự chọn lọc tự nhiên trong một quần thể hoặc một mẫu để đến cuối cùng tìm ra cá thể vượt trội nhất.</p>
</section>
<section id="cách-hoạt-động-ga-trong-ml" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="cách-hoạt-động-ga-trong-ml"><span class="header-section-number">1.2</span> Cách hoạt động GA trong ML:</h2>
<p>Trong Machine Learning, GA nhằm tìm ra đúng các biến cần thiết để xây dựng mô hình tốt nhất. Gỉa sử chúng ta có 2 mô hình là:</p>
<ul>
<li>Mô hình 1: gồm các biến A,C,D.</li>
<li>Mô hình 2: gồm biến A,B,E.</li>
</ul>
<p>Vậy mô hình nào mới là tốt nhất cho mô hình dự đoán ? Chúng ta chưa biết được và chỉ có thể so sánh nó thông qua thuật toán Genetic.</p>
<p>Về quy trình, thuật toán Genetic sẽ có cách hoạt động như dưới đây. Quy trình này mình tham khảo của <span class="citation" data-cites="rohithgandhi2018">(<a href="#ref-rohithgandhi2018" role="doc-biblioref">Rohith Gandhi 2018</a>)</span>.</p>
<div style="text-align: center; margin-bottom: 20px;">
  <img src="img/Genetic_Algorithm.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;">
  
  <!-- Picture Name -->
  <div style="text-align: left; margin-top: 10px;">
    Hình 3: Thuật toán Genetic
  </div>
  
  <!-- Source Link -->
  <div style="text-align: right; font-style: italic; margin-top: 5px;">
    Source: <a href="https://medium.datadriveninvestor.com/genetic-algorithms-9f920939f7cc">Link to Image</a>
  </div>
</div>
<p>Diễn giải cách hoạt động:</p>
<ul>
<li>Bước 1 (<strong>Initialisation</strong>): mỗi biến được xem là <em>Gene</em> và nhiều <em>Gene</em> gộp lại thành một mô hình hay gọi là <em>Chromosome</em> và nhiều <em>Chromosome</em> sẽ tạo thành một quần thể (<em>Population</em>). Việc này giống như là bạn đang trình bày hết các phương án có thể sử dụng.</li>
</ul>
<div style="text-align: center; margin-bottom: 20px;">
  <img src="img/Term.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;">
  
  <!-- Picture Name -->
  <div style="text-align: left; margin-top: 10px;">
    Hình 4: Các thuật ngữ trong GA
  </div>
  
  <!-- Source Link -->
  <div style="text-align: right; font-style: italic; margin-top: 5px;">
    Source: <a href="https://www.doc.ic.ac.uk/research/technicalreports/2003/DTR03-4.pdf">Link to Image</a>
  </div>
</div>
<ul>
<li><p>Bước 2 (<strong>Fitness Function</strong>): Bạn cần xây dựng một hàm mục tiêu để tính toán giá trị cho các mô hình ở bước 1.</p></li>
<li><p>Bước 3 (<strong>Selection</strong>): Biến nào có giá trị yếu kém sẽ bị loại và quá trình tính toán sẽ tiếp tục ở thế hệ của nó tiếp theo. Diễn giải đơn giản hơn là chúng ta thử một cách khác và cố gắng cải thiện kết quả.</p></li>
<li><p>Bước 4 (<strong>Crossover</strong>): Tạo ra mô hình gồm các biến tốt đã lựa chọn ở bước 3. Ví dụ như biến A, B là tốt cho mô hình.</p></li>
<li><p>Bước 5 (<strong>Mutation</strong>): Thay đổi mô hình đầu vào đã bao gồm các biến ở bước 4 và bắt đầu lại từ bước 1. Ví dụ mô hình cần chọn gồm 5 biến và ta đã chọn được biến A,B là tốt. Do đó, khi quay lại bước 1, ta chỉ cần chọn thêm 3 biến thay vì 5 biến như thông thường.</p></li>
</ul>
</section>
</section>
<section id="thực-hành-trong-r" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Thực hành trong R:</h1>
<p>Sau khi đã sơ lược về thuật toán, bây giờ ta sẽ vào phần thực hành trong R. Vậy làm sao để ứng dụng thuật toán Genetic trong R, mình đã kham khảo qua nhiều nguồn tài liệu và tổng hợp dưới đây:</p>
<p><strong>Xây dựng hàm mục tiêu</strong>: hàm mục tiêu là bước quan trọng nhất trong thuật toán Genetic vì nó là cơ sở để đánh giá và lựa chọn cá thể vượt trội nhất. Và hàm mục tiêu sẽ luôn khác nhau tùy vào vấn đề mà ta đặt ra. Giả sử chúng ta muốn tối ưu chi phí thì nó là hàm Min, còn ta muốn tối đa lợi nhuận thì nó sẽ là hàm Max.</p>
<p>Vậy hàm mục tiêu của bài toán trên trong R, bạn có thể tham khảo phần code bên dưới mình:</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Type of fitness function
</div>
</div>
<div class="callout-body-container callout-body">
<p>Đối số <code>type</code> trong hàm có 3 giá trị:</p>
<ul>
<li><code>"binary"</code>: đại diện cho biến quyết định dạng phân loại, ví dụ: có/không</li>
<li><code>"real-valued"</code>: dùng dể tối ưu cho các biến quyết định là dạng số thực, số tự nhiên.</li>
<li><code>"permutation"</code>: cho các vấn đề liên quan đến việc sắp xếp lại các biến thành danh sách, ví dụ: thang đo Likert.</li>
</ul>
</div>
</div>
<p>Chi tiết về hàm <code>ga()</code>, bạn có thể tham khảo tài liệu của <span class="citation" data-cites="lucascrucca2013">(<a href="#ref-lucascrucca2013" role="doc-biblioref">Luca Scrucca 2013</a>)</span>.</p>
<section id="thuật-toán-genetic" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="thuật-toán-genetic"><span class="header-section-number">2.1</span> Thuật toán Genetic:</h2>
<p>Vậy bây giờ chúng ta sẽ xử lí bài toán trên theo thuật toán <strong>Genetic</strong></p>
<p>Gỉa sử chúng ta có bài toán về vận chuyển hàng từ nhà kho để thỏa mãn nhu cầu ở các điểm <strong>DC (Distribution center)</strong>. Và công thức để tính toán được chi phí là:</p>
<p>Hàm chi phí tổng thể được xác định như sau:</p>
<p><span class="math display">\[
TC = \sum_{i=1}^{m} \left( D_{ij} \times \frac{P}{F} \times 0.4 + LC_i \right) \times Q_j
\]</span></p>
<p>Trong bài toán này, bạn sẽ cần dữ liệu để tính toán 2 thông số là: <strong>Phí bốc xếp (Loading cost)</strong> và <strong>Chi phí vận chuyển (Transportation cost)</strong>.</p>
<p>Nếu trong công việc thường ngày ở công ty, chúng ta sẽ cần lấy dữ liệu từ <strong>Data warehouse</strong> bằng SQL hoặc các phần mềm <strong>Business Intelligence</strong> khác. Ở đây, nhằm mục đích học tập, mình đã tạo ra code ở phía dưới để xây dựng dữ liệu cho các bạn luyện tập.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for loading costs</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>loading_costs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Warehouse =</span> <span class="fu">rep</span>(<span class="fu">paste</span>(<span class="st">"WH"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">times =</span> <span class="dv">4</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Weight_Category =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"&lt; 2 tons"</span>, <span class="st">"2 to 5 tons"</span>, <span class="st">"5 to 10 tons"</span>, <span class="st">"&gt; 10 tons"</span>), <span class="at">times =</span> <span class="dv">5</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Has_Machine =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"No"</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Loading_Cost =</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">100</span>, <span class="dv">120</span>, <span class="dv">160</span>,  <span class="co"># Warehouse 1 (with machine)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">110</span>, <span class="dv">150</span>, <span class="dv">180</span>, <span class="dv">210</span>,  <span class="co"># Warehouse 2 (without machine)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">85</span>, <span class="dv">105</span>, <span class="dv">125</span>, <span class="dv">140</span>,  <span class="co"># Warehouse 3 (with machine)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">150</span>, <span class="dv">170</span>, <span class="dv">190</span>, <span class="dv">210</span>,  <span class="co"># Warehouse 4 (without machine)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">140</span>, <span class="dv">165</span>, <span class="dv">185</span>, <span class="dv">215</span>)   <span class="co"># Warehouse 5 (without machine)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Define parameters</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>weight_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"&lt; 1.5"</span>, <span class="st">"1.5 to 2.5"</span>, <span class="st">"2.5 to 5"</span>, <span class="st">"5 to 10"</span>, <span class="st">"&gt; 10"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>loading_costs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Warehouse =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">each =</span> <span class="dv">15</span>),  <span class="co"># 5 warehouses, 15 rows each</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">DC =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">5</span>), <span class="at">times =</span> <span class="dv">5</span>),  <span class="co"># Repeat 1, 2, 3 for each warehouse</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Weight_Category =</span> <span class="fu">rep</span>(weight_categories, <span class="at">times =</span> <span class="dv">15</span>),  <span class="co"># Repeat categories for 15 rows</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Loading_Cost =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">75</span>, <span class="dv">5</span>, <span class="dv">150</span>), <span class="dv">2</span>),</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Has_Machine =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>), <span class="dv">75</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Define warehouses with coordinates (latitude, longitude)</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>warehouses <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">Latitude =</span> <span class="fu">c</span>(<span class="fl">21.0285</span>, <span class="fl">16.0545</span>, <span class="fl">10.7769</span>, <span class="fl">14.0583</span>, <span class="fl">19.8060</span>), <span class="co"># Example latitudes (Hanoi, HCMC, Da Nang, etc.)</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">Longitude =</span> <span class="fu">c</span>(<span class="fl">105.804</span>, <span class="fl">108.2022</span>, <span class="fl">106.6957</span>, <span class="fl">108.2772</span>, <span class="fl">105.7460</span>) <span class="co"># Example longitudes</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Define distribution centers data in Vietnam (example coordinates)</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>distribution_centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">Demand =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">30</span>, <span class="dv">150</span>),</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">Latitude =</span> <span class="fu">c</span>(<span class="fl">17.974855</span>, <span class="fl">11.7769</span>, <span class="fl">15.122327</span>), <span class="co"># Example latitudes (Hanoi, Da Nang, HCMC)</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">Longitude =</span> <span class="fu">c</span>(<span class="fl">102.630867</span>, <span class="fl">106.6957</span>, <span class="fl">108.799357</span>) <span class="co"># Example longitudes</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Nếu bạn từng gặp khó khăn trong việc phải đối mặt với cả đống dữ liệu từ hệ thống và chưa biết lấy dữ liệu nào để phân tích hoặc gộp bảng nào qua bảng nào thì lời khuyên của mình là hãy vẽ bảng <strong>Entity relation diagram (ERD)</strong>.</p>
<p><strong>ERD</strong> là một công cụ trực quan dùng để mô tả cấu trúc dữ liệu trong cơ sở dữ liệu. ERD thể hiện các thực thể (<em>entities</em>), thuộc tính (<em>attributes</em>), và các mối quan hệ (<em>relationships</em>) giữa chúng. Các thực thể thường được biểu diễn dưới dạng hình chữ nhật, thuộc tính dưới dạng hình ellips, và mối quan hệ bằng hình thoi hoặc đường nối. ERD giúp lập kế hoạch cho thiết kế cơ sở dữ liệu, đảm bảo rằng các yếu tố dữ liệu và quan hệ giữa chúng được xác định rõ ràng, tạo nền tảng cho việc phát triển và quản lý dữ liệu hiệu quả.</p>
<p>Như biểu đồ dưới đây, mình đang có 3 bảng gồm:</p>
<ul>
<li><p>Bảng thông tin chi tiết về DC.</p></li>
<li><p>Bảng thông tin chi tiết về WH.</p></li>
<li><p>Bảng giá về loading cost và transportation cost từ WH đến DC.</p></li>
</ul>
<p>Và các bạn có thể dễ dàng hình dung các mối quan hệ thông qua bảng <strong>Entity relation diagram (ERD)</strong> dưới đây:</p>
<div class="cell">
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item" id="htmlwidget-f25d4e1770d66a86dcce" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f25d4e1770d66a86dcce">{"x":{"diagram":"#data_model\ndigraph {\ngraph [rankdir=LR tooltip=\"Data Model\" ]\n\nnode [margin=0 fontcolor = \"#444444\" ]\n\nedge [color = \"#555555\", arrowsize = 1, ]\n\n\n  \"Distribution_Centers\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">Distribution_Centers<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"ID\"><U>ID<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">Demand<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">Latitude<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">Longitude<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"Loading_Costs\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">Loading_Costs<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"Warehouse\"><U>Warehouse<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"DC\"><U>DC<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">Weight_Category<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">Loading_Cost<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">Has_Machine<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"Warehouses\" [label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">Warehouses<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"ID\"><U>ID<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">Latitude<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">Longitude<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n\"Loading_Costs\":\"Warehouse\"->\"Warehouses\":\"ID\"\n\"Loading_Costs\":\"DC\"->\"Distribution_Centers\":\"ID\"\n}","config":{"engine":null,"options":null}},"evals":[],"jsHooks":[]}</script>
<p>Biểu đồ 1: EDR model</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tải package datamodelr:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Mình tạo biểu đồ này bằng thư viện <code>datamodelr</code>. Bạn có thể tải bằng cú pháp: <code>devtools::install_github("bergant/datamodelr")</code></p>
</div>
</div>
<section id="dữ-liệu-đầu-vào" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="dữ-liệu-đầu-vào"><span class="header-section-number">2.1.1</span> Dữ liệu đầu vào:</h3>
<p>Như vậy, dựa vào đó, ta sẽ tính toán được 2 <em>matrix</em> về chi phí:</p>
<ul>
<li><p>Bảng giá loading ở các kho. (Hình bên trái)</p></li>
<li><p>Bảng chi phí vận chuyển từ từng WH đến các DCs. (Hình bên phải)</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the transportation cost:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Haversine distance function</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>haversine <span class="ot">&lt;-</span> <span class="cf">function</span>(lat1, lon1, lat2, lon2) {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="dv">6371</span> <span class="co"># Radius of Earth in kilometers</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  dlat <span class="ot">&lt;-</span> (lat2 <span class="sc">-</span> lat1) <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  dlon <span class="ot">&lt;-</span> (lon2 <span class="sc">-</span> lon1) <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">sin</span>(dlat <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sin</span>(dlat <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">cos</span>(lat1 <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span>) <span class="sc">*</span> <span class="fu">cos</span>(lat2 <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span>) <span class="sc">*</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">sin</span>(dlon <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sin</span>(dlon <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">atan2</span>(<span class="fu">sqrt</span>(a), <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> a))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  R <span class="sc">*</span> c <span class="co"># Distance in kilometers</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate distance matrix based on coordinates</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(warehouses), <span class="at">ncol =</span> <span class="fu">nrow</span>(distribution_centers))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(warehouses)) {</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(distribution_centers)) {</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    distance_matrix[i, j] <span class="ot">&lt;-</span> <span class="fu">haversine</span>(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      warehouses<span class="sc">$</span>Latitude[i], warehouses<span class="sc">$</span>Longitude[i],</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      distribution_centers<span class="sc">$</span>Latitude[j], distribution_centers<span class="sc">$</span>Longitude[j]</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the fuel price (example value)</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>fuel_price <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># Fuel price per kilometer</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate transportation costs</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>transportation_costs <span class="ot">&lt;-</span> distance_matrix <span class="sc">*</span> fuel_price <span class="sc">*</span> <span class="fl">0.4</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the loading cost:</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>weights_per_good <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>mean_loading_cost<span class="ot">&lt;-</span>loading_costs <span class="sc">|&gt;</span> </span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(DC, Warehouse) <span class="sc">|&gt;</span> </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Loading_Cost,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">1000</span><span class="sc">/</span>weights_per_good) <span class="sc">|&gt;</span> <span class="co"># Assumes weighted of goods is 0.1kg </span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data frame to a wide format</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>mean_cost_matrix <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">dcast</span>(mean_loading_cost,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>                          Warehouse <span class="sc">~</span> DC, </span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>                          <span class="at">value.var =</span> <span class="st">"mean"</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the data frame to a matrix and remove the Warehouse column</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>loading_costs_per_dc <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(mean_cost_matrix[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names as the warehouse names</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(loading_costs_per_dc) <span class="ot">&lt;-</span> mean_loading_cost<span class="sc">$</span>Warehouse[<span class="sc">!</span><span class="fu">duplicated</span>(mean_loading_cost<span class="sc">$</span>Warehouse)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Bảng chi phí bốc xếp</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Bảng giá vận chuyển:</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="GA_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Biểu đồ 2: Heatmap cho bảng chi phí bốc xếp</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output-display">
<div id="soxqwkgowz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#soxqwkgowz table {
  font-family: Roboto, system-ui, 'Segoe UI', Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#soxqwkgowz thead, #soxqwkgowz tbody, #soxqwkgowz tfoot, #soxqwkgowz tr, #soxqwkgowz td, #soxqwkgowz th {
  border-style: none;
}

#soxqwkgowz p {
  margin: 0;
  padding: 0;
}

#soxqwkgowz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: rgba(255, 255, 255, 0);
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#soxqwkgowz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#soxqwkgowz .gt_title {
  color: #333333;
  font-size: 30px;
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#soxqwkgowz .gt_subtitle {
  color: #333333;
  font-size: 16px;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#soxqwkgowz .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#soxqwkgowz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#soxqwkgowz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: rgba(255, 255, 255, 0);
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#soxqwkgowz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 6px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#soxqwkgowz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#soxqwkgowz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#soxqwkgowz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#soxqwkgowz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 3px;
  border-bottom-color: rgba(255, 255, 255, 0);
  vertical-align: bottom;
  padding-top: 6px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#soxqwkgowz .gt_spanner_row {
  border-bottom-style: hidden;
}

#soxqwkgowz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#soxqwkgowz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#soxqwkgowz .gt_from_md > :first-child {
  margin-top: 0;
}

#soxqwkgowz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#soxqwkgowz .gt_row {
  padding-top: 6px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: rgba(255, 255, 255, 0);
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#soxqwkgowz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#soxqwkgowz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#soxqwkgowz .gt_row_group_first td {
  border-top-width: 2px;
}

#soxqwkgowz .gt_row_group_first th {
  border-top-width: 2px;
}

#soxqwkgowz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#soxqwkgowz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#soxqwkgowz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#soxqwkgowz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#soxqwkgowz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#soxqwkgowz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#soxqwkgowz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#soxqwkgowz .gt_striped {
  background-color: #F5F5F5;
}

#soxqwkgowz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#soxqwkgowz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#soxqwkgowz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#soxqwkgowz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#soxqwkgowz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#soxqwkgowz .gt_left {
  text-align: left;
}

#soxqwkgowz .gt_center {
  text-align: center;
}

#soxqwkgowz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#soxqwkgowz .gt_font_normal {
  font-weight: normal;
}

#soxqwkgowz .gt_font_bold {
  font-weight: bold;
}

#soxqwkgowz .gt_font_italic {
  font-style: italic;
}

#soxqwkgowz .gt_super {
  font-size: 65%;
}

#soxqwkgowz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#soxqwkgowz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#soxqwkgowz .gt_indent_1 {
  text-indent: 5px;
}

#soxqwkgowz .gt_indent_2 {
  text-indent: 10px;
}

#soxqwkgowz .gt_indent_3 {
  text-indent: 15px;
}

#soxqwkgowz .gt_indent_4 {
  text-indent: 20px;
}

#soxqwkgowz .gt_indent_5 {
  text-indent: 25px;
}

#soxqwkgowz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#soxqwkgowz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal" style="text-align: center;"><strong>Loading Costs by weight category in each warehouses</strong></th>
</tr>
<tr class="gt_heading even">
<th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="text-align: center;">Table just contains <strong>expected loading cost</strong></th>
</tr>
<tr class="gt_col_headings header">
<th id="Warehouse" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="text-align: center; background-color: #585D63; color: #FFFFFF; font-size: 10px; font-weight: bold; border-bottom-width: 2.5px; border-bottom-style: solid; border-bottom-color: #585d63;" scope="col">Warehouse</th>
<th id="DC" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="text-align: center; background-color: #585D63; color: #FFFFFF; font-size: 10px; font-weight: bold; border-bottom-width: 2.5px; border-bottom-style: solid; border-bottom-color: #585d63;" scope="col">Distribution Center</th>
<th id="Weight_Category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="text-align: center; background-color: #585D63; color: #FFFFFF; font-size: 10px; font-weight: bold; border-bottom-width: 2.5px; border-bottom-style: solid; border-bottom-color: #585d63;" scope="col">Weight Category</th>
<th id="Loading_Cost" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="text-align: center; background-color: #585D63; color: #FFFFFF; font-size: 10px; font-weight: bold; border-bottom-width: 2.5px; border-bottom-style: solid; border-bottom-color: #585d63;" scope="col">Loading Cost (VNĐ)</th>
<th id="Has_Machine" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="text-align: center; background-color: #585D63; color: #FFFFFF; font-size: 10px; font-weight: bold; border-bottom-width: 2.5px; border-bottom-style: solid; border-bottom-color: #585d63;" scope="col">Has Machine</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" style="text-align: center;" headers="Warehouse">WH 2</td>
<td class="gt_row gt_left" style="text-align: center;" headers="DC">DC 2</td>
<td class="gt_row gt_left" headers="Weight_Category" style="text-align: center; font-weight: bold;">5 to 10</td>
<td class="gt_row gt_right" headers="Loading_Cost" style="text-align: center; background-color: #440154; color: #FFFFFF;">₫149,170</td>
<td class="gt_row gt_left" style="text-align: center;" headers="Has_Machine">Yes</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" style="text-align: center;" headers="Warehouse">WH 3</td>
<td class="gt_row gt_left gt_striped" style="text-align: center;" headers="DC">DC 1</td>
<td class="gt_row gt_left gt_striped" headers="Weight_Category" style="text-align: center; font-weight: bold;">&lt; 1.5</td>
<td class="gt_row gt_right gt_striped" headers="Loading_Cost" style="text-align: center; background-color: #306A8E; color: #FFFFFF;">₫144,640</td>
<td class="gt_row gt_left gt_striped" style="text-align: center;" headers="Has_Machine">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="text-align: center;" headers="Warehouse">WH 1</td>
<td class="gt_row gt_left" style="text-align: center;" headers="DC">DC 3</td>
<td class="gt_row gt_left" headers="Weight_Category" style="text-align: center; font-weight: bold;">&lt; 1.5</td>
<td class="gt_row gt_right" headers="Loading_Cost" style="text-align: center; background-color: #297A8E; color: #FFFFFF;">₫143,740</td>
<td class="gt_row gt_left" style="text-align: center;" headers="Has_Machine">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" style="text-align: center;" headers="Warehouse">WH 2</td>
<td class="gt_row gt_left gt_striped" style="text-align: center;" headers="DC">DC 1</td>
<td class="gt_row gt_left gt_striped" headers="Weight_Category" style="text-align: center; font-weight: bold;">&gt; 10</td>
<td class="gt_row gt_right gt_striped" headers="Loading_Cost" style="text-align: center; background-color: #27808E; color: #FFFFFF;">₫143,400</td>
<td class="gt_row gt_left gt_striped" style="text-align: center;" headers="Has_Machine">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="text-align: center;" headers="Warehouse">WH 1</td>
<td class="gt_row gt_left" style="text-align: center;" headers="DC">DC 1</td>
<td class="gt_row gt_left" headers="Weight_Category" style="text-align: center; font-weight: bold;">&gt; 10</td>
<td class="gt_row gt_right" headers="Loading_Cost" style="text-align: center; background-color: #20A486; color: #FFFFFF;">₫141,370</td>
<td class="gt_row gt_left" style="text-align: center;" headers="Has_Machine">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" style="text-align: center;" headers="Warehouse">WH 3</td>
<td class="gt_row gt_left gt_striped" style="text-align: center;" headers="DC">DC 1</td>
<td class="gt_row gt_left gt_striped" headers="Weight_Category" style="text-align: center; font-weight: bold;">1.5 to 2.5</td>
<td class="gt_row gt_right gt_striped" headers="Loading_Cost" style="text-align: center; background-color: #FDE725; color: #000000;">₫135,830</td>
<td class="gt_row gt_left gt_striped" style="text-align: center;" headers="Has_Machine">Yes</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="5" class="gt_sourcenote" style="text-align: center;"><em>Source: package gt in R</em></td>
</tr>
</tfoot>

</table>

</div>
<p>Biểu đồ 3: Bảng giá vận chuyển từ WH đến DC</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="xây-dựng-hàm-mục-tiêu" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="xây-dựng-hàm-mục-tiêu"><span class="header-section-number">2.1.2</span> Xây dựng hàm mục tiêu:</h3>
<p>Sau khi đã có đủ dữ liệu, bạn sẽ bắt đầu viết hàm mục tiêu và dùng thuật toán GA để tìm ra giá trị tối ưu nhất.</p>
<p>Trong hàm <code>ga</code> từ gói <strong>GA</strong> trong R, có một số đối số quan trọng cho phép bạn tùy chỉnh thuật toán di truyền. Dưới đây là một cái nhìn tổng quan về một số đối số quan trọng:</p>
<ul>
<li><p><strong>type</strong>: Chỉ định loại tối ưu hóa (ví dụ: <code>"real-valued"</code>, <code>"binary"</code> hoặc <code>"permutation"</code>).</p></li>
<li><p><strong>fitness</strong>: Hàm đánh giá độ phù hợp; nó nên nhận một vector tham số làm đầu vào và trả về một giá trị số.</p></li>
<li><p><strong>lower</strong> và <strong>upper</strong>: Định nghĩa giới hạn cho các biến nếu bạn đang tối ưu hóa trong không gian liên tục (dùng cho các loại giá trị thực).</p></li>
<li><p><strong>popSize</strong>: Thiết lập kích thước quần thể cho mỗi thế hệ.</p></li>
<li><p><strong>maxiter</strong>: Chỉ định số thế hệ tối đa để chạy thuật toán.</p></li>
<li><p><strong>run</strong>: Chỉ định số thế hệ để chạy thuật toán mà không có sự cải thiện trước khi dừng lại.</p></li>
<li><p><strong>pmutation</strong>: Xác suất xảy ra đột biến trong quần thể.</p></li>
<li><p><strong>elitism</strong>: Xác định xem các cá thể tốt nhất có nên được giữ lại trong thế hệ tiếp theo hay không.</p></li>
</ul>
<p>Những đối số này giúp điều chỉnh thuật toán di truyền cho các nhu cầu tối ưu hóa cụ thể của bạn, cho phép hiệu suất tốt hơn và hội tụ về các giải pháp tối ưu.</p>
<p>Ngoài ra, còn có các lưu ý cho bạn khi sử dụng R như sau:</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Lưu ý khi dùng hàm ga():
</div>
</div>
<div class="callout-body-container callout-body">
<p>Hàm <code>ga()</code> phải có ít nhất 2 đối số là <code>type</code> và <code>fitness thì R mới chạy được.</code></p>
<ul>
<li><p>Riêng khi type = “binary” thì cần thêm đối số <code>nBits.</code></p></li>
<li><p>Còn khi <code>type = "real-valued"/"permutation"</code> thì cần thêm đối số <code>min</code> và <code>max</code>.</p></li>
</ul>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GA)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>demand<span class="ot">&lt;-</span><span class="fu">c</span>(distribution_centers<span class="sc">$</span>Demand)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the objective function</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>objective_function <span class="ot">&lt;-</span> <span class="cf">function</span>(quantities) {</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    quantities_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(quantities, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">nrow =</span> <span class="dv">5</span>, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total loading costs</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    loading_costs <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(quantities_matrix) <span class="sc">*</span> loading_costs_per_dc  <span class="co"># Total loading costs for each DC</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total transportation costs</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    transportation_costs <span class="ot">&lt;-</span> <span class="fu">sum</span>(quantities_matrix <span class="sc">*</span> transportation_costs)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine both costs</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    total_cost <span class="ot">&lt;-</span> <span class="fu">sum</span>(loading_costs) <span class="sc">+</span> transportation_costs</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if demands are met</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">colSums</span>(quantities_matrix) <span class="sc">&lt;</span> demand)) {</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="cn">Inf</span>)  <span class="co"># Penalize if demands are not met</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(total_cost)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the Genetic Algorithm</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>num_vars <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">3</span>  <span class="co"># 5 warehouses, 3 distribution centers</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>ga_result <span class="ot">&lt;-</span> <span class="fu">ga</span>(</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"real-valued"</span>,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitness =</span> <span class="cf">function</span>(x) <span class="sc">-</span><span class="fu">objective_function</span>(x),  <span class="co"># Negate for minimization</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_vars),  <span class="co"># Minimum quantity</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">rep</span>(<span class="dv">100</span>, num_vars),  <span class="co"># Maximum quantity (adjust as needed)</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">popSize =</span> <span class="dv">50</span>,</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxiter =</span> <span class="dv">100</span>,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">run =</span> <span class="dv">10</span>,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">monitor =</span> <span class="cn">TRUE</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="GA_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Kết quả tối ưu sẽ được trình bày ở bảng này (hơi màu mè 1 tí!!!)</p>
<div class="cell">
<div class="cell-output-display">
<div id="gdviiwgshj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gdviiwgshj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gdviiwgshj thead, #gdviiwgshj tbody, #gdviiwgshj tfoot, #gdviiwgshj tr, #gdviiwgshj td, #gdviiwgshj th {
  border-style: none;
}

#gdviiwgshj p {
  margin: 0;
  padding: 0;
}

#gdviiwgshj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gdviiwgshj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gdviiwgshj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gdviiwgshj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gdviiwgshj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gdviiwgshj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gdviiwgshj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gdviiwgshj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gdviiwgshj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gdviiwgshj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gdviiwgshj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gdviiwgshj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gdviiwgshj .gt_spanner_row {
  border-bottom-style: hidden;
}

#gdviiwgshj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gdviiwgshj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gdviiwgshj .gt_from_md > :first-child {
  margin-top: 0;
}

#gdviiwgshj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gdviiwgshj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gdviiwgshj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gdviiwgshj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gdviiwgshj .gt_row_group_first td {
  border-top-width: 2px;
}

#gdviiwgshj .gt_row_group_first th {
  border-top-width: 2px;
}

#gdviiwgshj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gdviiwgshj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gdviiwgshj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gdviiwgshj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gdviiwgshj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gdviiwgshj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gdviiwgshj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gdviiwgshj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gdviiwgshj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gdviiwgshj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gdviiwgshj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gdviiwgshj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gdviiwgshj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gdviiwgshj .gt_left {
  text-align: left;
}

#gdviiwgshj .gt_center {
  text-align: center;
}

#gdviiwgshj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gdviiwgshj .gt_font_normal {
  font-weight: normal;
}

#gdviiwgshj .gt_font_bold {
  font-weight: bold;
}

#gdviiwgshj .gt_font_italic {
  font-style: italic;
}

#gdviiwgshj .gt_super {
  font-size: 65%;
}

#gdviiwgshj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gdviiwgshj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gdviiwgshj .gt_indent_1 {
  text-indent: 5px;
}

#gdviiwgshj .gt_indent_2 {
  text-indent: 10px;
}

#gdviiwgshj .gt_indent_3 {
  text-indent: 15px;
}

#gdviiwgshj .gt_indent_4 {
  text-indent: 20px;
}

#gdviiwgshj .gt_indent_5 {
  text-indent: 25px;
}

#gdviiwgshj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gdviiwgshj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="8" class="gt_heading gt_title gt_font_normal"><strong>📦 Warehouse Shipment Summary</strong></th>
</tr>
<tr class="gt_heading even">
<th colspan="8" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Cost Breakdown &amp; Machine Availability</th>
</tr>
<tr class="gt_col_headings header">
<th id="Warehouse" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">🏢 Warehouse</th>
<th id="DC" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">🏬 Distribution Center</th>
<th id="Total_Weight" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">📦 Total Weight (kg)</th>
<th id="Weight_Category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">⚖️ Weight Category</th>
<th id="Loading_Cost" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">💼 Loading Cost</th>
<th id="Transport_cost" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">🚚 Transport Cost</th>
<th id="Total_Cost" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">💰 Total Cost</th>
<th id="Has_Machine_Icon" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">🛠 Machine</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Warehouse">WH 1</td>
<td class="gt_row gt_left" headers="DC">DC 1</td>
<td class="gt_row gt_right" headers="Total_Weight" style="background-color: #8D86F3; color: #FFFFFF">3.36</td>
<td class="gt_row gt_left" headers="Weight_Category">2.5 to 5</td>
<td class="gt_row gt_right" headers="Loading_Cost" style="background-color: #FFDB95; color: #000000">$64,300.00</td>
<td class="gt_row gt_right" headers="Transport_cost" style="background-color: #FF88AF; color: #000000">$3,802,097.23</td>
<td class="gt_row gt_right" headers="Total_Cost" style="background-color: #67C664; color: #000000">$3,866,397.23</td>
<td class="gt_row gt_left" headers="Has_Machine_Icon" style="background-color: #D3D3D3">✅</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Warehouse">WH 2</td>
<td class="gt_row gt_left gt_striped" headers="DC">DC 1</td>
<td class="gt_row gt_right gt_striped" headers="Total_Weight" style="background-color: #A4BAEB; color: #000000">1.88</td>
<td class="gt_row gt_left gt_striped" headers="Weight_Category">1.5 to 2.5</td>
<td class="gt_row gt_right gt_striped" headers="Loading_Cost" style="background-color: #FFEBB6; color: #000000">$40,680.00</td>
<td class="gt_row gt_right gt_striped" headers="Transport_cost" style="background-color: #FF72A7; color: #000000">$5,037,171.35</td>
<td class="gt_row gt_right gt_striped" headers="Total_Cost" style="background-color: #56B552; color: #FFFFFF">$5,077,851.35</td>
<td class="gt_row gt_left gt_striped" headers="Has_Machine_Icon" style="background-color: #F5E1F7">❌</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Warehouse">WH 3</td>
<td class="gt_row gt_left" headers="DC">DC 1</td>
<td class="gt_row gt_right" headers="Total_Weight" style="background-color: #ADD8E6; color: #000000">1.03</td>
<td class="gt_row gt_left" headers="Weight_Category">&lt; 1.5</td>
<td class="gt_row gt_right" headers="Loading_Cost" style="background-color: #FFA500; color: #000000">$144,640.00</td>
<td class="gt_row gt_right" headers="Transport_cost" style="background-color: #FF3E99; color: #FFFFFF">$7,297,102.21</td>
<td class="gt_row gt_right" headers="Total_Cost" style="background-color: #31962F; color: #FFFFFF">$7,441,742.21</td>
<td class="gt_row gt_left" headers="Has_Machine_Icon" style="background-color: #F5E1F7">❌</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Warehouse">WH 4</td>
<td class="gt_row gt_left gt_striped" headers="DC">DC 1</td>
<td class="gt_row gt_right gt_striped" headers="Total_Weight" style="background-color: #ADD8E6; color: #000000">1.04</td>
<td class="gt_row gt_left gt_striped" headers="Weight_Category">&lt; 1.5</td>
<td class="gt_row gt_right gt_striped" headers="Loading_Cost" style="background-color: #FFF6CD; color: #000000">$25,130.00</td>
<td class="gt_row gt_right gt_striped" headers="Transport_cost" style="background-color: #FF5FA1; color: #FFFFFF">$5,952,559.68</td>
<td class="gt_row gt_right gt_striped" headers="Total_Cost" style="background-color: #48A945; color: #FFFFFF">$5,977,689.68</td>
<td class="gt_row gt_left gt_striped" headers="Has_Machine_Icon" style="background-color: #D3D3D3">✅</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Warehouse">WH 5</td>
<td class="gt_row gt_left" headers="DC">DC 1</td>
<td class="gt_row gt_right" headers="Total_Weight" style="background-color: #A3B8EC; color: #000000">1.92</td>
<td class="gt_row gt_left" headers="Weight_Category">1.5 to 2.5</td>
<td class="gt_row gt_right" headers="Loading_Cost" style="background-color: #FFFAD6; color: #000000">$18,750.00</td>
<td class="gt_row gt_right" headers="Transport_cost" style="background-color: #FF94B3; color: #000000">$3,086,494.54</td>
<td class="gt_row gt_right" headers="Total_Cost" style="background-color: #72D06F; color: #000000">$3,105,244.54</td>
<td class="gt_row gt_left" headers="Has_Machine_Icon" style="background-color: #F5E1F7">❌</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Warehouse">WH 1</td>
<td class="gt_row gt_left gt_striped" headers="DC">DC 2</td>
<td class="gt_row gt_right gt_striped" headers="Total_Weight" style="background-color: #ACD3E7; color: #000000">1.17</td>
<td class="gt_row gt_left gt_striped" headers="Weight_Category">&lt; 1.5</td>
<td class="gt_row gt_right gt_striped" headers="Loading_Cost" style="background-color: #FFFFE0; color: #000000">$11,610.00</td>
<td class="gt_row gt_right gt_striped" headers="Transport_cost" style="background-color: #FF1493; color: #FFFFFF">$8,264,855.30</td>
<td class="gt_row gt_right gt_striped" headers="Total_Cost" style="background-color: #228B22; color: #FFFFFF; font-weight: bold">$8,276,465.30</td>
<td class="gt_row gt_left gt_striped" headers="Has_Machine_Icon" style="background-color: #F5E1F7">❌</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Warehouse">WH 2</td>
<td class="gt_row gt_left" headers="DC">DC 2</td>
<td class="gt_row gt_right" headers="Total_Weight" style="background-color: #A7C2EA; color: #000000">1.65</td>
<td class="gt_row gt_left" headers="Weight_Category">1.5 to 2.5</td>
<td class="gt_row gt_right" headers="Loading_Cost" style="background-color: #FFBF59; color: #000000">$105,460.00</td>
<td class="gt_row gt_right" headers="Transport_cost" style="background-color: #FF84AD; color: #000000">$4,021,256.86</td>
<td class="gt_row gt_right" headers="Total_Cost" style="background-color: #63C260; color: #000000">$4,126,716.86</td>
<td class="gt_row gt_left" headers="Has_Machine_Icon" style="background-color: #D3D3D3">✅</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Warehouse">WH 3</td>
<td class="gt_row gt_left gt_striped" headers="DC">DC 2</td>
<td class="gt_row gt_right gt_striped" headers="Total_Weight" style="background-color: #5E46FB; color: #FFFFFF">5.09</td>
<td class="gt_row gt_left gt_striped" headers="Weight_Category">5 to 10</td>
<td class="gt_row gt_right gt_striped" headers="Loading_Cost" style="background-color: #FFE4A7; color: #000000">$51,140.00</td>
<td class="gt_row gt_right gt_striped" headers="Transport_cost" style="background-color: #FFB6C1; color: #000000">$889,559.41</td>
<td class="gt_row gt_right gt_striped" headers="Total_Cost" style="background-color: #90EE90; color: #000000">$940,699.41</td>
<td class="gt_row gt_left gt_striped" headers="Has_Machine_Icon" style="background-color: #D3D3D3">✅</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Warehouse">WH 4</td>
<td class="gt_row gt_left" headers="DC">DC 2</td>
<td class="gt_row gt_right" headers="Total_Weight" style="background-color: #8376F6; color: #FFFFFF">3.80</td>
<td class="gt_row gt_left" headers="Weight_Category">2.5 to 5</td>
<td class="gt_row gt_right" headers="Loading_Cost" style="background-color: #FFB540; color: #000000">$120,840.00</td>
<td class="gt_row gt_right" headers="Transport_cost" style="background-color: #FF9EB7; color: #000000">$2,449,208.30</td>
<td class="gt_row gt_right" headers="Total_Cost" style="background-color: #79D777; color: #000000">$2,570,048.30</td>
<td class="gt_row gt_left" headers="Has_Machine_Icon" style="background-color: #D3D3D3">✅</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Warehouse">WH 5</td>
<td class="gt_row gt_left gt_striped" headers="DC">DC 2</td>
<td class="gt_row gt_right gt_striped" headers="Total_Weight" style="background-color: #ABD2E7; color: #000000">1.21</td>
<td class="gt_row gt_left gt_striped" headers="Weight_Category">&lt; 1.5</td>
<td class="gt_row gt_right gt_striped" headers="Loading_Cost" style="background-color: #FFD78C; color: #000000">$70,030.00</td>
<td class="gt_row gt_right gt_striped" headers="Transport_cost" style="background-color: #FF429A; color: #FFFFFF">$7,188,382.30</td>
<td class="gt_row gt_right gt_striped" headers="Total_Cost" style="background-color: #349832; color: #FFFFFF">$7,258,412.30</td>
<td class="gt_row gt_left gt_striped" headers="Has_Machine_Icon" style="background-color: #F5E1F7">❌</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Warehouse">WH 1</td>
<td class="gt_row gt_left" headers="DC">DC 3</td>
<td class="gt_row gt_right" headers="Total_Weight" style="background-color: #A7C3EA; color: #000000">1.61</td>
<td class="gt_row gt_left" headers="Weight_Category">1.5 to 2.5</td>
<td class="gt_row gt_right" headers="Loading_Cost" style="background-color: #FFD78B; color: #000000">$70,730.00</td>
<td class="gt_row gt_right" headers="Transport_cost" style="background-color: #FF62A2; color: #FFFFFF">$5,831,987.58</td>
<td class="gt_row gt_right" headers="Total_Cost" style="background-color: #49AA46; color: #FFFFFF">$5,902,717.58</td>
<td class="gt_row gt_left" headers="Has_Machine_Icon" style="background-color: #D3D3D3">✅</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Warehouse">WH 2</td>
<td class="gt_row gt_left gt_striped" headers="DC">DC 3</td>
<td class="gt_row gt_right gt_striped" headers="Total_Weight" style="background-color: #A3B8EC; color: #000000">1.92</td>
<td class="gt_row gt_left gt_striped" headers="Weight_Category">1.5 to 2.5</td>
<td class="gt_row gt_right gt_striped" headers="Loading_Cost" style="background-color: #FFCE79; color: #000000">$83,890.00</td>
<td class="gt_row gt_right gt_striped" headers="Transport_cost" style="background-color: #FFB5C0; color: #000000">$974,375.33</td>
<td class="gt_row gt_right gt_striped" headers="Total_Cost" style="background-color: #8EEC8E; color: #000000">$1,058,265.33</td>
<td class="gt_row gt_left gt_striped" headers="Has_Machine_Icon" style="background-color: #F5E1F7">❌</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Warehouse">WH 3</td>
<td class="gt_row gt_left" headers="DC">DC 3</td>
<td class="gt_row gt_right" headers="Total_Weight" style="background-color: #7F6FF6; color: #FFFFFF">3.99</td>
<td class="gt_row gt_left" headers="Weight_Category">2.5 to 5</td>
<td class="gt_row gt_right" headers="Loading_Cost" style="background-color: #FFDA94; color: #000000">$64,990.00</td>
<td class="gt_row gt_right" headers="Transport_cost" style="background-color: #FF7FAC; color: #000000">$4,273,915.59</td>
<td class="gt_row gt_right" headers="Total_Cost" style="background-color: #60BF5D; color: #000000">$4,338,905.59</td>
<td class="gt_row gt_left" headers="Has_Machine_Icon" style="background-color: #F5E1F7">❌</td>
</tr>
<tr class="even">
<td class="gt_row gt_left gt_striped" headers="Warehouse">WH 4</td>
<td class="gt_row gt_left gt_striped" headers="DC">DC 3</td>
<td class="gt_row gt_right gt_striped" headers="Total_Weight" style="background-color: #0000FF; color: #FFFFFF">6.26</td>
<td class="gt_row gt_left gt_striped" headers="Weight_Category">5 to 10</td>
<td class="gt_row gt_right gt_striped" headers="Loading_Cost" style="background-color: #FFAC24; color: #000000">$134,780.00</td>
<td class="gt_row gt_right gt_striped" headers="Transport_cost" style="background-color: #FFB4C0; color: #000000">$1,047,828.18</td>
<td class="gt_row gt_right gt_striped" headers="Total_Cost" style="background-color: #8DEB8C; color: #000000">$1,182,608.18</td>
<td class="gt_row gt_left gt_striped" headers="Has_Machine_Icon" style="background-color: #F5E1F7">❌</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Warehouse">WH 5</td>
<td class="gt_row gt_left" headers="DC">DC 3</td>
<td class="gt_row gt_right" headers="Total_Weight" style="background-color: #A0AFED; color: #000000">2.18</td>
<td class="gt_row gt_left" headers="Weight_Category">1.5 to 2.5</td>
<td class="gt_row gt_right" headers="Loading_Cost" style="background-color: #FFC566; color: #000000">$96,240.00</td>
<td class="gt_row gt_right" headers="Transport_cost" style="background-color: #FF74A8; color: #000000">$4,905,804.62</td>
<td class="gt_row gt_right" headers="Total_Cost" style="background-color: #57B653; color: #FFFFFF">$5,002,044.62</td>
<td class="gt_row gt_left" headers="Has_Machine_Icon" style="background-color: #F5E1F7">❌</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
</section>
<section id="báo-cáo" class="level1 page-columns page-full" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Báo cáo:</h1>
<p>Và cuối cùng, sau khi có kết quả, mình sẽ dùng các thư viện gồm: <strong>Leaflet</strong>, <strong>gt</strong>, và <strong>biểu đồ Sankey</strong> phục vụ những mục đích khác nhau cho trực quan hóa dữ liệu.</p>
<ol type="1">
<li><p><strong>Leaflet</strong>: Đây là một thư viện mạnh mẽ để tạo bản đồ tương tác. Nó cho phép người dùng dễ dàng thêm các lớp, điểm đánh dấu và pop-up, rất lý tưởng để trực quan hóa dữ liệu địa lý. Leaflet đặc biệt hữu ích để hiển thị các dữ liệu như vị trí, lộ trình, hoặc phân bố không gian.</p></li>
<li><p><strong>gt</strong>: Gói <strong>gt</strong> được thiết kế để tạo ra các bảng chất lượng cao trong R. Nó cho phép người dùng định dạng và tạo kiểu cho bảng một cách dễ dàng, giúp chúng trở nên hấp dẫn và dễ đọc. gt hỗ trợ các tính năng như định dạng tùy chỉnh, dòng tóm tắt, và thậm chí thêm chú thích, nâng cao cách trình bày dữ liệu trong báo cáo.</p></li>
<li><p><strong>Biểu đồ Sankey</strong>: Những biểu đồ này được sử dụng để trực quan hóa luồng và mối quan hệ giữa các danh mục khác nhau. Trong R, gói <strong>networkD3</strong> hoặc <strong>ggalluvial</strong> có thể tạo ra biểu đồ Sankey, giúp hiểu cách các giá trị di chuyển giữa các nút, chẳng hạn như theo dõi hành trình người dùng hoặc hiển thị phân bổ tài nguyên.</p></li>
</ol>
<p>Để kết nối các biểu đồ lại với nhau, ta thường nghĩ đến <code>Shiny</code> trong <strong>R</strong> nhưng vì chúng ta đang tạo website bằng <strong>Quarto</strong> nên output cuối cùng sẽ là một trang web tĩnh - <em>static website</em>. Do đó, nó sẽ không phản hồi với thông tin đầu vào của người dùng hoặc chạy bất kỳ mã R nào. Bạn có thể hình dung giống như bạn đang muốn xem biểu đồ về doanh thu trong tháng tiếp theo trên 1 biểu đồ trong Word - không thể làm được vì nó thuộc dạng văn bản, bạn chỉ đọc hoặc nhìn chứ không tương tác được.</p>
<p>Tuy vậy, sau một thời gian tìm hiểu, mình cũng tìm được cách để nhúng <strong>Shiny</strong> vào R để hiển thị trên Quarto. Nguồn tài liệu bạn có thể kham khảo ở trang này <a href="https://github.com/coatless-quarto/r-shinylive-demo">r-shinylive-demo</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Shinylive</strong> là 1 extension của Quarto và được kích hoạt bằng:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span><span class="kw">:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> quarto-ext/shinylive</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>các extension trong filter sẽ ảnh hưởng đến kết quả sau khi Quarto render xong. App Shiny chỉ xuất hiện sau đó, nên bạn cần đợi thêm tùy theo độ nặng của app.</p>
</div>
</div>
<div class="column-page">
<pre class="shinylive-r" data-engine="r"><code>#| '!! shinylive warning !!': |
#|   shinylive does not work in self-contained HTML documents.
#|   Please set `embed-resources: false` in your metadata.
#| viewerHeight: 1000
#| standalone: true
#| fig-cap: "Biểu đồ 3: Dashboard về lịch trình vận chuyển hàng dự tính"
pacman::p_load(
  leaflet,
  dplyr,
  networkD3,
  shiny,
  bslib,
  DT,
  htmltools
)

# Add value:
# Convert GA solution to a matrix
# Optimal quantities matrix
optimal_quantities &lt;- matrix(c(
  43.306058, 10.87137, 13.26283,
  15.524054, 30.42748, 48.86716,
  7.599769, 44.93531, 27.46289,
  18.556927, 17.60396, 41.85203,
  16.305016, 13.15498, 21.79634
), nrow = 5, ncol = 3, byrow = TRUE)

# Warehouse data:
warehouses &lt;- data.frame(
  ID = 1:5,
  Latitude = c(21.0285, 16.0545, 10.7769, 14.0583, 19.8060),
  Longitude = c(105.8040, 108.2022, 106.6957, 108.2772, 105.7460),
  District = c("Đống Đa", "Hải Châu", "Quận 1", "Mang Yang", "Đông Sơn"),
  Province = c("Hà Nội", "Đà Nẵng", "Hồ Chí Minh", "Gia Lai", "Thanh Hóa"),
  Address = c(
    "2RH3+9HX Đống Đa, Hà Nội, Việt Nam",
    "3632+RV4 Hải Châu, Đà Nẵng, Việt Nam",
    "QMGW+Q74 Quận 1, Hồ Chí Minh, Việt Nam",
    "375G+8VG Mang Yang, Gia Lai, Việt Nam",
    "RP4W+99X Đông Sơn, Thanh Hóa, Việt Nam"
  )
)

# Distribution center data:
distribution_centers &lt;- data.frame(
  ID = 1:3,
  Latitude = c(17.97486, 11.77690, 15.12233),
  Longitude = c(102.6309, 106.6957, 108.7994),
  District = c("Viêng Chăn", "Lộc Ninh", "Quảng Ngãi"),
  Province = c("Lào", "Bình Phước", "Quảng Ngãi"),
  Address = c(
    "XJFJ+W8X Viêng Chăn, Lào",
    "QMGW+Q74 Lộc Ninh, Bình Phước, Việt Nam",
    "4QCX+WPQ Quảng Ngãi, Việt Nam"
  )
)

# Create a data frame with the warehouse data
result &lt;- data.frame(
  Warehouse = c("WH 1", "WH 2", "WH 3", "WH 4", "WH 5",
                "WH 1", "WH 2", "WH 3", "WH 4", "WH 5",
                "WH 1", "WH 2", "WH 3", "WH 4", "WH 5"),
  DC = c("DC 1", "DC 1", "DC 1", "DC 1", "DC 1",
         "DC 2", "DC 2", "DC 2", "DC 2", "DC 2",
         "DC 3", "DC 3", "DC 3", "DC 3", "DC 3"),
  Has_Machine = c("Yes", "No", "No", "No", "No",
                  "No", "No", "No", "No", "No",
                  "No", "No", "No", "No", "No"),
  Total_Weight = c(4.3306058, 1.5524054, 0.7599769, 1.8556927, 1.6305016,
                   1.0871366, 3.0427479, 4.4935308, 1.7603961, 1.3154977,
                   1.3262832, 4.8867159, 2.7462887, 4.1852028, 2.1796338),
  Weight_Category = c("2.5 to 5", "1.5 to 2.5", "&lt; 1.5", "1.5 to 2.5", "1.5 to 2.5",
                      "&lt; 1.5", "2.5 to 5", "2.5 to 5", "1.5 to 2.5", "&lt; 1.5",
                      "&lt; 1.5", "2.5 to 5", "2.5 to 5", "2.5 to 5", "1.5 to 2.5"),
  Loading_Cost = c(64300, 40680, 144640, 38790, 18750,
                   11610, 97870, 36380, 69120, 70030,
                   143740, 91150, 64990, 114230, 96240),
  Transport_cost = c(3802097.2, 5037171.3, 7297102.2, 5952559.7, 3086494.5,
                     8264855.3, 4021256.9, 889559.4, 2449208.3, 7188382.3,
                     5831987.6, 974375.3, 4273915.6, 1047828.2, 4905804.6)
)

# Custom icon:
warehouse_icon &lt;- makeIcon(
  iconUrl = "https://raw.githubusercontent.com/Loccx78vn/genetic-algorithm-method/refs/heads/main/img/warehouse_icon.png",
  iconWidth = 30,
  iconHeight = 30
)

dc_icon &lt;- makeIcon(
  iconUrl = "https://raw.githubusercontent.com/Loccx78vn/genetic-algorithm-method/refs/heads/main/img/distribution_center.png",
  iconWidth = 30,
  iconHeight = 30
)
# Define a custom theme
my_theme &lt;- bs_theme(
  version = 5,
  bootswatch = "litera",
  primary = "#3b5998",
  secondary = "#5cb85c",
  success = "#5cb85c",
  info = "#5bc0de",
  warning = "#f0ad4e",
  danger = "#d9534f"
)

# Define UI
ui &lt;- page_fluid(
  theme = my_theme,
  
  # Custom CSS for better visualization
  tags$head(
    tags$style(HTML("
      .card-header {
        background-color: #3b5998;
        color: white;
        font-weight: bold;
      }
      .nav-tabs .nav-link.active {
        font-weight: bold;
        color: #3b5998;
        border-bottom: 2px solid #3b5998;
      }
      .nav-tabs .nav-link {
        color: #6c757d;
      }
      .checkbox span {
        font-weight: normal;
      }
      .checkbox input:checked + span {
        font-weight: bold;
        color: #3b5998;
      }
      .warehouse-selection {
        border-left: 4px solid #3b5998;
        padding-left: 10px;
      }
      .dataTables_wrapper {
        padding: 10px;
        border-radius: 5px;
      }
      .table thead th {
        background-color: #e9ecef;
      }
      .leaflet-container {
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .sankey-container {
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 10px;
        background-color: #f8f9fa;
      }
      .summary-stats {
        background-color: #f8f9fa;
        border-radius: 5px;
        padding: 10px;
        margin-bottom: 15px;
        border-left: 4px solid #3b5998;
      }
    "))
  ),
  
  # Page header - simplified
  card(
    card_header(
      tags$div(
        class = "d-flex align-items-center",
        tags$img(
          src = "https://raw.githubusercontent.com/Loccx78vn/genetic-algorithm-method/refs/heads/main/img/supply-chain-management.png", 
          height = "30px", 
          style = "margin-right: 10px;"
        ),
        h3("Warehouse Distribution Dashboard", class = "m-0")
      )
    ),
    card_body(
      "This dashboard shows the optimal distribution of goods from warehouses to distribution centers."
    )
  ),
  
  layout_sidebar(
    sidebar = sidebar(
      title = "Controls",
      width = 300,
      bg = "#f8f9fa",
      class = "warehouse-selection",
      
      h4("Warehouse Selection", class = "mb-3 text-primary"),
      
      p("Select one or more warehouses to view their distribution data on the map and in the charts."),
      
      checkboxGroupInput(
        inputId = "warehouse", 
        label = NULL, 
        choices = setNames(
          paste("Warehouse", 1:5),
          paste("Warehouse", 1:5, "-", warehouses$District, ",", warehouses$Province)
        ),
        selected = paste("Warehouse", 1)
      ),
      
      hr(),
      
      tags$div(
        class = "alert alert-info",
        icon("info-circle"), 
        "Click on the map markers for detailed location information."
      )
    ),
    
    # Main content - restructured to put summary above map
    tabsetPanel(
      tabPanel(
        title = "Interactive Map", 
        icon = icon("map"),
        card(
          full_screen = TRUE,
          height = "650px", # Increased height
          card_body(
            # Summary stats placed above the map
            tags$div(
              class = "summary-stats",
              uiOutput("summary_stats")
            ),
            # Map with increased height
            leafletOutput("map", height = "550px") # Increased map height
          )
        )
      ),
      
      tabPanel(
        title = "Cost Analysis", 
        icon = icon("table"),
        card(
          full_screen = TRUE,
          height = "650px", # Increased to match
          card_header("Cost Table"),
          DTOutput("cost_table")
        )
      ),
      
      tabPanel(
        title = "Flow Diagram", 
        icon = icon("diagram-project"),
        card(
          full_screen = TRUE,
          height = "650px", # Increased to match
          card_header("Distribution Flow Diagram"),
          tags$div(
            class = "sankey-container",
            uiOutput("sankey_diagram")
          )
        )
      )
    )
  )
)

# Define server logic
server &lt;- function(input, output, session) {
  
  location &lt;- reactive({
    req(input$warehouse) 
    as.numeric(sub("Warehouse ", "", input$warehouse))
  })
  
  # Create the leaflet map
  output$map &lt;- renderLeaflet({
    req(location())
    
    # Color palette for routes
    route_colors &lt;- c("#FF5733", "#33A8FF", "#33FF57", "#D433FF", "#FFD133")
    
    # Initialize the map
    map &lt;- leaflet() |&gt;
      addTiles() |&gt;
      addProviderTiles(providers$CartoDB.Positron) |&gt;
      addMarkers(data = warehouses |&gt; filter(ID %in% location()), 
                 lat = ~Latitude, 
                 lng = ~Longitude, 
                 label = ~paste0("&lt;strong&gt; ID Warehouse: &lt;/strong&gt; ", ID, "&lt;br/&gt; ",
                                 "&lt;strong&gt; Province: &lt;/strong&gt; ", Province, "&lt;br/&gt; ",
                                 "&lt;strong&gt; District: &lt;/strong&gt; ", District, "&lt;br/&gt; ",
                                 "&lt;strong&gt; Address: &lt;/strong&gt; ", Address, "&lt;br/&gt; ") |&gt; 
                   lapply(htmltools::HTML),
                 icon = warehouse_icon) |&gt;
      addMarkers(data = distribution_centers, 
                 lat = ~Latitude, 
                 lng = ~Longitude, 
                 label = ~paste0("&lt;strong&gt; ID Distribution Center: &lt;/strong&gt; ", ID, "&lt;br/&gt; ",
                                 "&lt;strong&gt; Province: &lt;/strong&gt; ", Province, "&lt;br/&gt; ",
                                 "&lt;strong&gt; District: &lt;/strong&gt; ", District, "&lt;br/&gt; ",
                                 "&lt;strong&gt; Address: &lt;/strong&gt; ", Address, "&lt;br/&gt; ") |&gt; 
                   lapply(htmltools::HTML),
                 icon = dc_icon)
    
    qty_data &lt;- optimal_quantities[location(), , drop = FALSE]  
    
    # Add routes based on the optimal quantities with different colors
    route_colors &lt;- c("#FF5733", "#33A8FF", "#33FF57", "#D433FF", "#FFD133")
    line_weights &lt;- c(2, 3, 4, 5, 6)  # Variable line weights based on quantity
    
    # Add routes based on the optimal quantities
    for (i in seq_along(location())) {
      wh_id &lt;- location()[i]
      wh_idx &lt;- which(warehouses$ID == wh_id)
      color_idx &lt;- (wh_id - 1) %% length(route_colors) + 1
      
      for (j in 1:ncol(qty_data)) {
        if (qty_data[i, j] &gt; 0) {
          route_start &lt;- warehouses[warehouses$ID == wh_id, c("Longitude", "Latitude")]
          route_end &lt;- distribution_centers[distribution_centers$ID == j, c("Longitude", "Latitude")]
          
          # Calculate line weight based on quantity (normalized)
          weight_multiplier &lt;- qty_data[i, j] / max(optimal_quantities) * 5
          weight &lt;- max(2, min(6, weight_multiplier + 2))  # Scale between 2-6
          
          map &lt;- map |&gt;
            addPolylines(
              lat = c(route_start$Latitude, route_end$Latitude),
              lng = c(route_start$Longitude, route_end$Longitude),
              color = route_colors[color_idx],
              weight = weight,
              opacity = 0.7,
              label = paste0("Quantity: ", round(qty_data[i, j], 2)),
              dashArray = "5, 5",
              popup = paste0(
                "&lt;strong&gt;From:&lt;/strong&gt; Warehouse ", wh_id,
                "&lt;br&gt;&lt;strong&gt;To:&lt;/strong&gt; Distribution Center ", j,
                "&lt;br&gt;&lt;strong&gt;Quantity:&lt;/strong&gt; ", round(qty_data[i, j], 2)
              )
            )
        }
      }
    }
    
    map  # Return the modified map
  })
  
  # Render the cost table
  output$cost_table &lt;- renderDT({
    req(location())
    
    cost_data &lt;- result |&gt; 
      filter(Warehouse %in% paste("WH", location())) |&gt; 
      select(c(Warehouse, DC, Loading_Cost, Transport_cost))
    
    # Add a Total Cost column
    cost_data$Total_Cost &lt;- cost_data$Loading_Cost + cost_data$Transport_cost
    
    # Format currency values
    cost_data$Loading_Cost &lt;- formatC(cost_data$Loading_Cost, format="f", digits=0, big.mark=",")
    cost_data$Transport_cost &lt;- formatC(cost_data$Transport_cost, format="f", digits=0, big.mark=",")
    cost_data$Total_Cost &lt;- formatC(cost_data$Total_Cost, format="f", digits=0, big.mark=",")
    
    datatable(cost_data,
              options = list(
                pageLength = 10,
                dom = 'Bfrtip',
                buttons = c('copy', 'csv', 'excel'),
                initComplete = JS(
                  "function(settings, json) {",
                  "$(this.api().table().header()).css({'background-color': '#3b5998', 'color': 'white'});",
                  "}"
                ),
                columnDefs = list(
                  list(className = 'dt-center', targets = "_all")
                )
              ),
              rownames = FALSE,
              class = 'compact stripe hover') |&gt;
      formatStyle(
        'Warehouse',
        backgroundColor = styleEqual(
          paste("WH", 1:5), 
          c('#FFC3A0', '#A0D2FF', '#C8FFB0', '#D5A0FF', '#FFF0A0')
        )
      ) |&gt;
      formatStyle(
        'DC',
        backgroundColor = styleEqual(
          c("DC 1", "DC 2", "DC 3"), 
          c('#FFDDC3', '#C3E5FF', '#DDFFC3')
        )
      )
  })
  
  
  # Create and render the Sankey diagram
  selected_indices &lt;- reactive({
    as.numeric(sub("Warehouse ", "", input$warehouse))
  })
  
  # Filter data based on selected warehouses
  filtered_data &lt;- reactive({
    result |&gt;
      filter(Warehouse %in% paste("WH",input$warehouse))
  })

  # Create and render the Sankey diagram
  output$sankey_diagram &lt;- renderUI({
    req(length(selected_indices()) &gt; 0)
    
    # Create links data frame
    links &lt;- data.frame()
    
    # Add links for each selected warehouse
    for (i in 1:length(selected_indices())) {
      wh_idx &lt;- selected_indices()[i]
      wh_data &lt;- optimal_quantities[wh_idx, , drop = FALSE]
      
      # Add links for each DC
      for (j in 1:ncol(wh_data)) {
        if (wh_data[1, j] &gt; 0) {
          links &lt;- rbind(links, data.frame(
            source = i - 1,  # Use index in selected warehouses (0-based)
            target = length(selected_indices()) + j - 1,  # DCs come after warehouses
            value = wh_data[1, j]
          ))
        }
      }
    }
    
    # Only proceed if we have links
    req(nrow(links) &gt; 0)
    
    # Create nodes data frame
    nodes &lt;- data.frame(
      name = c(paste("Warehouse", selected_indices()), paste("DC", 1:3))
    )
    
    # Create the Sankey network
    sankey &lt;- sankeyNetwork(
      Links = links, 
      Nodes = nodes, 
      Source = "source", 
      Target = "target", 
      Value = "value",
      NodeID = "name",
      height = 500,  
      width = 800,
      fontSize = 12,
      nodeWidth = 20,
      sinksRight = TRUE
    )
    
    # Customize tooltips and add click functionality to show a value panel
    sankey &lt;- htmlwidgets::onRender(sankey, "
    function(el, x) {
      // Create a div for the value panel
      var valuePanel = d3.select('body').append('div')
        .attr('class', 'value-panel')
        .style('position', 'absolute')
        .style('padding', '8px')
        .style('background', 'lightgray')
        .style('border', '1px solid gray')
        .style('border-radius', '4px')
        .style('opacity', 0);  // Start hidden

      // Append title for tooltips on hover
      d3.selectAll('.link')
        .append('title')
        .text(function(d) { return 'Quantity: ' + d.value.toFixed(2); });  // Show value on hover

      // Add click event to show the value panel
      d3.selectAll('.link')
        .on('click', function(event, d) {
          // Ensure we get the correct value
          var value = d3.select(this).datum().value;
          var source = nodes.name[d.source.index];
          var target = nodes.name[d.target.index];

          // Position the value panel near the mouse cursor
          valuePanel
            .style('left', (event.pageX + 5) + 'px')
            .style('top', (event.pageY + 5) + 'px')
            .style('opacity', 1)  // Make it visible
            .html('From: ' + source + '&lt;br&gt;To: ' + target + '&lt;br&gt;Quantity: ' + value.toFixed(2));  // Set the text with details

          // Hide the panel after a delay
          setTimeout(function() {
            valuePanel.style('opacity', 0);
          }, 3000);  // Change the delay as needed
        });
    }
    ")
    
    # Add title and caption
    tagList(
      sankey,
      tags$p(style = "font-size: 12px; text-align: right;", 
             "A wider arrow indicates that a larger quantity is being sent from that warehouse to a distribution center.")
    )
  })
  
  # Add a summary statistics output at the bottom of the map tab
  output$summary_stats &lt;- renderUI({
    req(location())
    
    selected_data &lt;- result |&gt; 
      filter(Warehouse %in% paste("WH", location()))
    
    total_loading &lt;- sum(selected_data$Loading_Cost)
    total_transport &lt;- sum(selected_data$Transport_cost)
    total_weight &lt;- sum(selected_data$Total_Weight)
    
    div(
      class = "mt-3 p-3 bg-light rounded",
      h4("Summary Statistics", class = "text-primary mb-3"),
      div(class = "row",
          div(class = "col-md-4",
              div(class = "card text-white bg-primary mb-3",
                  div(class = "card-body",
                      h5(class = "card-title", "Total Weight"),
                      h3(class = "card-text", paste0(round(total_weight, 2), " tons"))
                  )
              )
          ),
          div(class = "col-md-4",
              div(class = "card text-white bg-success mb-3",
                  div(class = "card-body",
                      h5(class = "card-title", "Total Loading Cost"),
                      h3(class = "card-text", paste0("₫", formatC(total_loading, format="f", digits=0, big.mark=",")))
                  )
              )
          ),
          div(class = "col-md-4",
              div(class = "card text-white bg-info mb-3",
                  div(class = "card-body",
                      h5(class = "card-title", "Total Transport Cost"),
                      h3(class = "card-text", paste0("₫", formatC(total_transport, format="f", digits=0, big.mark=",")))
                  )
              )
          )
      )
    )
  })
}

# Run the application 
shinyApp(ui = ui, server = server)</code></pre>
</div>
<p>Bạn có thể thấy với <strong>dashboard</strong> như vậy, ta có thể xem được nhiều thông tin hơn như:</p>
<ul>
<li><p>Vị trí cụ thể của từng <em>WH</em> và <em>DC</em> cũng như là các tuyến đường dự kiến bằng các đường thẳng minh họa. (Xem <strong>Map tab</strong>)</p></li>
<li><p>Thông tin về chi phí <em>Loading cost</em> và <em>Transporation cost</em> cũng như lượng hàng cần vận chuyển cho từng nhà kho. (Xem <strong>Table and Sankey tab</strong>)</p></li>
</ul>
<p>Bạn có thể xem cho 1 hoặc nhiều nhà kho bằng cách <em>click</em> trên thanh <strong>Filter</strong>. Ngoài ra, đặc biệt với <strong>Sankey chart</strong>, bạn cần giữ hoặc <em>click</em> chuột vào tuyến để xem được số lượng hàng.</p>
<p>Tuy rất thích R nhưng mình vẫn không thích xây dựng dashboard bằng R lắm vì quá nặng về code và không hiệu quả về thời gian, nguồn lực. Các tools khác mình ưu tiên hơn như <strong>Power BI</strong>, <strong>Tableau</strong> hoặc các <strong>BIs</strong> mà công ty bạn sử dụng trong công việc hằng ngày.</p>



    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Go to Next Page</title>
    <style>
        /* Global Styles */
        body {
            font-family: 'Tahoma', sans-serif;
            display: flex;
            flex-direction: column;  /* Stack content and footnote vertically */
            justify-content: center;  /* Center content vertically */
            align-items: center;      /* Center content horizontally */
            margin: 0;
            background-color: $secondary-color;
            box-sizing: border-box;
            min-height: 80vh; /* Adjusted to 80vh to ensure it's not too high */
        }

        /* Container Styling (Main Content) */
        .container {
            text-align: center;
            padding: 20px 40px; /* Adjust padding for more compactness */
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            width: auto;  /* Auto width to fit content */
            max-width: 380px;  /* Adjusted max-width for a smaller container */
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            margin-top: 20px;  /* Space from the top of the page */
        }

        /* Link Styling */
        .link {
            font-size: 20px;  /* Adjusted font size for readability */
            color: #007bff;
            text-decoration: none;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            cursor: pointer;
            padding: 12px 30px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .link:hover {
            color: #0056b3;
            text-decoration: none;
            background-color: #e6f0ff;
        }

        /* Arrow Styling */
        .arrow {
            margin-left: 12px;
            font-size: 24px;
            transition: transform 0.3s ease, font-size 0.3s ease;
        }

        .link:hover .arrow {
            transform: translateX(8px);
            font-size: 26px;
        }

        /* Focus State for Accessibility */
        .link:focus {
            outline: 2px solid #0056b3;
        }

        /* Footer Styling (Footnote) */
        .footer {
            font-size: 14px;
            color: #777;
            margin-top: 20px;  /* Space between content and footnote */
            text-align: center;
            width: 100%;
        }

        /* Mobile-Friendly Adjustments */
        @media (max-width: 600px) {
            .link {
                font-size: 18px;
                padding: 8px 15px;  /* Smaller padding for mobile devices */
            }

            .arrow {
                font-size: 18px;
                margin-left: 8px;
            }

            .container {
                padding: 15px 30px;  /* Smaller padding on mobile */
                max-width: 90%;  /* Ensure container fits better on small screens */
            }
        }
    </style>


    <div class="container">
        <a href="https://loccx78vn.github.io/genetic-algorithm-method/MILP.html" class="link" tabindex="0">
            Go to Next Page
            <span class="arrow">➔</span>
        </a>
    </div>




<!-- -->


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-lucascrucca2013" class="csl-entry" role="listitem">
Luca Scrucca. 2013. <span>“GA: A Package for Genetic Algorithms in r.”</span> <em>Journal of Statistical Software</em>. <a href="https://doi.org/10.18637/jss.v053.i04">https://doi.org/10.18637/jss.v053.i04</a>.
</div>
<div id="ref-rohithgandhi2018" class="csl-entry" role="listitem">
Rohith Gandhi. 2018. <span>“Genetic Algorithms.”</span> <a href="https://medium.datadriveninvestor.com/genetic-algorithms-9f920939f7cc">https://medium.datadriveninvestor.com/genetic-algorithms-9f920939f7cc</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb6" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Genetic Algorithms in R"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Việt Nam, 2024"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> ["SupplyChainManagement", "Logistics","Genetic Algorithm"]</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Đây là bài viết của tôi về cách sử dụng R trong ứng dụng Genetic Algorithm trong Supply Chain"</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="an">crossref:</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">  labels: alpha a        </span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">  subref-labels: roman</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - quarto-ext/shinylive</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="fu"># Giới thiệu:</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Call packages</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(rio,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>               here,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>               janitor,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>               tidyverse,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>               dplyr,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>               magrittr,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>               ggplot2,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>               purrr,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>               lubridate,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>               mice,</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>               plotly,</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>               DiagrammeR,</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>               shinylive)</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## Vài điểm về thuật toán Genetic:</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>**GA** hay **Genetic Algorithm** là 1 thuật toán tối ưu hóa ngẫu nhiên (**stochastic search algorithms**), được phát triển dựa trên lý thuyết tiến hóa và sự chọn lọc tự nhiên của sinh học <span class="co">[</span><span class="ot">@lucascrucca2013</span><span class="co">]</span>.</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>Ở thời cấp 3, bạn đã từng học về lý thuyết tiến hóa và chọn lọc tự nhiên của <span class="co">[</span><span class="ot">Charles Darwin</span><span class="co">](https://vi.wikipedia.org/wiki/Charles_Darwin)</span> và <span class="co">[</span><span class="ot">Alfred Russel</span><span class="co">](https://vi.wikipedia.org/wiki/Alfred_Russel_Wallace)</span> ở môn Sinh học. Nếu bạn cũng từng liệt Sinh như tôi thì bạn quên cũng không sao 😅😅. Vậy thì để tôi giải thích lại như sau:</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>Sự tiến hóa là sự thay đổi đặc điểm di truyền của 1 quần thể sinh vật, ví dụ điển hình chính là từ loại vượn đã tiến hóa thành hình dạng con người văn minh như các bạn bây giờ. Vậy quá trình tiến hóa đó diễn ra khi có sự chọn lọc tự nhiên tạo ra các biến dị di truyền (Ví dụ: đột biến,...) và kết quả là các cá thể đột biến trở nên phổ biến hơn hoặc hiếm gặp hơn trong quần thể. Vậy điều kiện để xảy ra sự chọn lọc tự nhiên có thể là sự thay đổi về môi trường sống, địa lý,... dẫn tới sự khác nhau về khả năng sống sót và sinh sản.</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>Kết cục là xuất hiện các cá thể đột biến "mạnh mẽ hơn" hoặc đúng là "đặc biệt hơn" có khả năng tồn tại khi xuất hiện sự thay đổi lớn, ví dụ như dưới đây, do sự thay đổi về địa điểm sống, từ một loại chim sẻ đã phát triển thành 3 phân họ khác nhau.</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;div style="text-align: center; margin-bottom: 20px;"&gt;</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;img src="img/Natural_selection.jpg" style="max-width: 80%; height: auto; display: block; margin: 0 auto;"&gt;</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Picture Name --&gt;</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: left; margin-top: 10px;"&gt;</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="in">    Hình 1: Ví dụ về chọn lọc tự nhiên</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Source Link --&gt;</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: right; font-style: italic; margin-top: 5px;"&gt;</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a><span class="in">    Source: &lt;a href="https://www.biologyonline.com/dictionary/natural-selection"&gt;Link to Image&lt;/a&gt;</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/div&gt;</span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>Vậy lí thuyết này liên quan gì tới vấn đề tối ưu hóa. Thông thường khi bạn muốn tối ưu hóa một vấn đề gì đó, bạn cần xây dựng mô hình định lượng nó, ví dụ như dưới ảnh này ta đang có mô hình <span class="co">[</span><span class="ot">MILP</span><span class="co">](https://www.mathworks.com/help/optim/ug/mixed-integer-linear-programming-algorithms.html)</span> nhằm hoạch định tuyến đường và tối ưu hóa quãng đường di chuyển.</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;div style="text-align: center; margin-bottom: 20px;"&gt;</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;img src="img/MILP.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;"&gt;</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Picture Name --&gt;</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: left; margin-top: 10px;"&gt;</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a><span class="in">    Hình 2: Mô hình VRP</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Source Link --&gt;</span></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: right; font-style: italic; margin-top: 5px;"&gt;</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a><span class="in">    Source: &lt;a href="https://medium.com/@rihot_gusron/capacitated-vehicle-routing-problem-with-lingo-427c2d3bf724"&gt;Link to Image&lt;/a&gt;</span></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/div&gt;</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>Mục tiêu của hàm chính là tìm ra giá trị nhỏ nhất nghĩa là chi phí cho việc di chuyển của xe là nhỏ nhất. Do đó, bạn có thể hình dung rằng **giá trị nhỏ nhất** đó như là các **cá thể đột biến** có khả năng sống sót cao nhất trong quẩn thể.</span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>Vì vậy thuật toán **Genetic** (GA) chính là lặp đi lặp lại sự chọn lọc tự nhiên trong một quần thể hoặc một mẫu để đến cuối cùng tìm ra cá thể vượt trội nhất.</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cách hoạt động GA trong ML:</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>Trong Machine Learning, GA nhằm tìm ra đúng các biến cần thiết để xây dựng mô hình tốt nhất. Gỉa sử chúng ta có 2 mô hình là:</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mô hình 1: gồm các biến A,C,D.</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mô hình 2: gồm biến A,B,E.</span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>Vậy mô hình nào mới là tốt nhất cho mô hình dự đoán ? Chúng ta chưa biết được và chỉ có thể so sánh nó thông qua thuật toán Genetic.</span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a>Về quy trình, thuật toán Genetic sẽ có cách hoạt động như dưới đây. Quy trình này mình tham khảo của <span class="co">[</span><span class="ot">@rohithgandhi2018</span><span class="co">]</span>.</span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;div style="text-align: center; margin-bottom: 20px;"&gt;</span></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;img src="img/Genetic_Algorithm.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;"&gt;</span></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Picture Name --&gt;</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: left; margin-top: 10px;"&gt;</span></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a><span class="in">    Hình 3: Thuật toán Genetic</span></span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Source Link --&gt;</span></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: right; font-style: italic; margin-top: 5px;"&gt;</span></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a><span class="in">    Source: &lt;a href="https://medium.datadriveninvestor.com/genetic-algorithms-9f920939f7cc"&gt;Link to Image&lt;/a&gt;</span></span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/div&gt;</span></span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>Diễn giải cách hoạt động:</span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bước 1 (**Initialisation**): mỗi biến được xem là *Gene* và nhiều *Gene* gộp lại thành một mô hình hay gọi là *Chromosome* và nhiều *Chromosome* sẽ tạo thành một quần thể (*Population*). Việc này giống như là bạn đang trình bày hết các phương án có thể sử dụng.</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;div style="text-align: center; margin-bottom: 20px;"&gt;</span></span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;img src="img/Term.png" style="max-width: 100%; height: auto; display: block; margin: 0 auto;"&gt;</span></span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Picture Name --&gt;</span></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: left; margin-top: 10px;"&gt;</span></span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a><span class="in">    Hình 4: Các thuật ngữ trong GA</span></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;!-- Source Link --&gt;</span></span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div style="text-align: right; font-style: italic; margin-top: 5px;"&gt;</span></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a><span class="in">    Source: &lt;a href="https://www.doc.ic.ac.uk/research/technicalreports/2003/DTR03-4.pdf"&gt;Link to Image&lt;/a&gt;</span></span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/div&gt;</span></span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bước 2 (**Fitness Function**): Bạn cần xây dựng một hàm mục tiêu để tính toán giá trị cho các mô hình ở bước 1.</span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bước 3 (**Selection**): Biến nào có giá trị yếu kém sẽ bị loại và quá trình tính toán sẽ tiếp tục ở thế hệ của nó tiếp theo. Diễn giải đơn giản hơn là chúng ta thử một cách khác và cố gắng cải thiện kết quả.</span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bước 4 (**Crossover**): Tạo ra mô hình gồm các biến tốt đã lựa chọn ở bước 3. Ví dụ như biến A, B là tốt cho mô hình.</span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bước 5 (**Mutation**): Thay đổi mô hình đầu vào đã bao gồm các biến ở bước 4 và bắt đầu lại từ bước 1. Ví dụ mô hình cần chọn gồm 5 biến và ta đã chọn được biến A,B là tốt. Do đó, khi quay lại bước 1, ta chỉ cần chọn thêm 3 biến thay vì 5 biến như thông thường.</span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a><span class="fu"># Thực hành trong R:</span></span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>Sau khi đã sơ lược về thuật toán, bây giờ ta sẽ vào phần thực hành trong R. Vậy làm sao để ứng dụng thuật toán Genetic trong R, mình đã kham khảo qua nhiều nguồn tài liệu và tổng hợp dưới đây:</span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a>**Xây dựng hàm mục tiêu**: hàm mục tiêu là bước quan trọng nhất trong thuật toán Genetic vì nó là cơ sở để đánh giá và lựa chọn cá thể vượt trội nhất. Và hàm mục tiêu sẽ luôn khác nhau tùy vào vấn đề mà ta đặt ra. Giả sử chúng ta muốn tối ưu chi phí thì nó là hàm Min, còn ta muốn tối đa lợi nhuận thì nó sẽ là hàm Max.</span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>Vậy hàm mục tiêu của bài toán trên trong R, bạn có thể tham khảo phần code bên dưới mình:</span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Type of fitness function</span></span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a>Đối số <span class="in">`type`</span> trong hàm có 3 giá trị:</span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`"binary"`</span>: đại diện cho biến quyết định dạng phân loại, ví dụ: có/không</span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`"real-valued"`</span>: dùng dể tối ưu cho các biến quyết định là dạng số thực, số tự nhiên.</span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`"permutation"`</span>: cho các vấn đề liên quan đến việc sắp xếp lại các biến thành danh sách, ví dụ: thang đo Likert.</span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a>Chi tiết về hàm <span class="in">`ga()`</span>, bạn có thể tham khảo tài liệu của <span class="co">[</span><span class="ot">@lucascrucca2013</span><span class="co">]</span>.</span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a><span class="fu">## Thuật toán Genetic:</span></span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a>Vậy bây giờ chúng ta sẽ xử lí bài toán trên theo thuật toán **Genetic**</span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a>Gỉa sử chúng ta có bài toán về vận chuyển hàng từ nhà kho để thỏa mãn nhu cầu ở các điểm **DC (Distribution center)**. Và công thức để tính toán được chi phí là:</span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a>Hàm chi phí tổng thể được xác định như sau:</span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a>TC = \sum_{i=1}^{m} \left( D_{ij} \times \frac{P}{F} \times 0.4 + LC_i \right) \times Q_j</span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a>Trong bài toán này, bạn sẽ cần dữ liệu để tính toán 2 thông số là: **Phí bốc xếp (Loading cost)** và **Chi phí vận chuyển (Transportation cost)**.</span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a>Nếu trong công việc thường ngày ở công ty, chúng ta sẽ cần lấy dữ liệu từ **Data warehouse** bằng SQL hoặc các phần mềm **Business Intelligence** khác. Ở đây, nhằm mục đích học tập, mình đã tạo ra code ở phía dưới để xây dựng dữ liệu cho các bạn luyện tập.</span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for loading costs</span></span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a>loading_costs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a>  <span class="at">Warehouse =</span> <span class="fu">rep</span>(<span class="fu">paste</span>(<span class="st">"WH"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">times =</span> <span class="dv">4</span>),</span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a>  <span class="at">Weight_Category =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"&lt; 2 tons"</span>, <span class="st">"2 to 5 tons"</span>, <span class="st">"5 to 10 tons"</span>, <span class="st">"&gt; 10 tons"</span>), <span class="at">times =</span> <span class="dv">5</span>),</span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a>  <span class="at">Has_Machine =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"No"</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a>  <span class="at">Loading_Cost =</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">100</span>, <span class="dv">120</span>, <span class="dv">160</span>,  <span class="co"># Warehouse 1 (with machine)</span></span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">110</span>, <span class="dv">150</span>, <span class="dv">180</span>, <span class="dv">210</span>,  <span class="co"># Warehouse 2 (without machine)</span></span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">85</span>, <span class="dv">105</span>, <span class="dv">125</span>, <span class="dv">140</span>,  <span class="co"># Warehouse 3 (with machine)</span></span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">150</span>, <span class="dv">170</span>, <span class="dv">190</span>, <span class="dv">210</span>,  <span class="co"># Warehouse 4 (without machine)</span></span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">140</span>, <span class="dv">165</span>, <span class="dv">185</span>, <span class="dv">215</span>)   <span class="co"># Warehouse 5 (without machine)</span></span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Define parameters</span></span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a>weight_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"&lt; 1.5"</span>, <span class="st">"1.5 to 2.5"</span>, <span class="st">"2.5 to 5"</span>, <span class="st">"5 to 10"</span>, <span class="st">"&gt; 10"</span>)</span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame</span></span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a>loading_costs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a>  <span class="at">Warehouse =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">each =</span> <span class="dv">15</span>),  <span class="co"># 5 warehouses, 15 rows each</span></span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a>  <span class="at">DC =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">5</span>), <span class="at">times =</span> <span class="dv">5</span>),  <span class="co"># Repeat 1, 2, 3 for each warehouse</span></span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a>  <span class="at">Weight_Category =</span> <span class="fu">rep</span>(weight_categories, <span class="at">times =</span> <span class="dv">15</span>),  <span class="co"># Repeat categories for 15 rows</span></span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a>  <span class="at">Loading_Cost =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="dv">75</span>, <span class="dv">5</span>, <span class="dv">150</span>), <span class="dv">2</span>),</span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a>  <span class="at">Has_Machine =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>), <span class="dv">75</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Define warehouses with coordinates (latitude, longitude)</span></span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a>warehouses <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a>  <span class="at">Latitude =</span> <span class="fu">c</span>(<span class="fl">21.0285</span>, <span class="fl">16.0545</span>, <span class="fl">10.7769</span>, <span class="fl">14.0583</span>, <span class="fl">19.8060</span>), <span class="co"># Example latitudes (Hanoi, HCMC, Da Nang, etc.)</span></span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a>  <span class="at">Longitude =</span> <span class="fu">c</span>(<span class="fl">105.804</span>, <span class="fl">108.2022</span>, <span class="fl">106.6957</span>, <span class="fl">108.2772</span>, <span class="fl">105.7460</span>) <span class="co"># Example longitudes</span></span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Define distribution centers data in Vietnam (example coordinates)</span></span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a>distribution_centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb6-222"><a href="#cb6-222" aria-hidden="true" tabindex="-1"></a>  <span class="at">Demand =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">30</span>, <span class="dv">150</span>),</span>
<span id="cb6-223"><a href="#cb6-223" aria-hidden="true" tabindex="-1"></a>  <span class="at">Latitude =</span> <span class="fu">c</span>(<span class="fl">17.974855</span>, <span class="fl">11.7769</span>, <span class="fl">15.122327</span>), <span class="co"># Example latitudes (Hanoi, Da Nang, HCMC)</span></span>
<span id="cb6-224"><a href="#cb6-224" aria-hidden="true" tabindex="-1"></a>  <span class="at">Longitude =</span> <span class="fu">c</span>(<span class="fl">102.630867</span>, <span class="fl">106.6957</span>, <span class="fl">108.799357</span>) <span class="co"># Example longitudes</span></span>
<span id="cb6-225"><a href="#cb6-225" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-226"><a href="#cb6-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-227"><a href="#cb6-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-228"><a href="#cb6-228" aria-hidden="true" tabindex="-1"></a>Nếu bạn từng gặp khó khăn trong việc phải đối mặt với cả đống dữ liệu từ hệ thống và chưa biết lấy dữ liệu nào để phân tích hoặc gộp bảng nào qua bảng nào thì lời khuyên của mình là hãy vẽ bảng **Entity relation diagram (ERD)**.</span>
<span id="cb6-229"><a href="#cb6-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-230"><a href="#cb6-230" aria-hidden="true" tabindex="-1"></a>**ERD** là một công cụ trực quan dùng để mô tả cấu trúc dữ liệu trong cơ sở dữ liệu. ERD thể hiện các thực thể (*entities*), thuộc tính (*attributes*), và các mối quan hệ (*relationships*) giữa chúng. Các thực thể thường được biểu diễn dưới dạng hình chữ nhật, thuộc tính dưới dạng hình ellips, và mối quan hệ bằng hình thoi hoặc đường nối. ERD giúp lập kế hoạch cho thiết kế cơ sở dữ liệu, đảm bảo rằng các yếu tố dữ liệu và quan hệ giữa chúng được xác định rõ ràng, tạo nền tảng cho việc phát triển và quản lý dữ liệu hiệu quả.</span>
<span id="cb6-231"><a href="#cb6-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-232"><a href="#cb6-232" aria-hidden="true" tabindex="-1"></a>Như biểu đồ dưới đây, mình đang có 3 bảng gồm:</span>
<span id="cb6-233"><a href="#cb6-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-234"><a href="#cb6-234" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bảng thông tin chi tiết về DC.</span>
<span id="cb6-235"><a href="#cb6-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-236"><a href="#cb6-236" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bảng thông tin chi tiết về WH.</span>
<span id="cb6-237"><a href="#cb6-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-238"><a href="#cb6-238" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bảng giá về loading cost và transportation cost từ WH đến DC.</span>
<span id="cb6-239"><a href="#cb6-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-240"><a href="#cb6-240" aria-hidden="true" tabindex="-1"></a>Và các bạn có thể dễ dàng hình dung các mối quan hệ thông qua bảng **Entity relation diagram (ERD)** dưới đây:</span>
<span id="cb6-241"><a href="#cb6-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-244"><a href="#cb6-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-245"><a href="#cb6-245" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb6-246"><a href="#cb6-246" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: "Biểu đồ 1: EDR model"</span></span>
<span id="cb6-247"><a href="#cb6-247" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datamodelr)</span>
<span id="cb6-248"><a href="#cb6-248" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data model from your data frames</span></span>
<span id="cb6-249"><a href="#cb6-249" aria-hidden="true" tabindex="-1"></a>dm1 <span class="ot">&lt;-</span> <span class="fu">dm_from_data_frames</span>(<span class="fu">list</span>(</span>
<span id="cb6-250"><a href="#cb6-250" aria-hidden="true" tabindex="-1"></a>  <span class="at">Warehouses =</span> warehouses,</span>
<span id="cb6-251"><a href="#cb6-251" aria-hidden="true" tabindex="-1"></a>  <span class="at">Loading_Costs =</span> loading_costs,</span>
<span id="cb6-252"><a href="#cb6-252" aria-hidden="true" tabindex="-1"></a>  <span class="at">Distribution_Centers =</span> distribution_centers</span>
<span id="cb6-253"><a href="#cb6-253" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">|&gt;</span></span>
<span id="cb6-254"><a href="#cb6-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_set_key</span>(<span class="st">"Warehouses"</span>, <span class="st">"ID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-255"><a href="#cb6-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_set_key</span>(<span class="st">"Loading_Costs"</span>, <span class="fu">c</span>(<span class="st">"Warehouse"</span>, <span class="st">"DC"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb6-256"><a href="#cb6-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_set_key</span>(<span class="st">"Distribution_Centers"</span>, <span class="st">"ID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-257"><a href="#cb6-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_references</span>(</span>
<span id="cb6-258"><a href="#cb6-258" aria-hidden="true" tabindex="-1"></a>    Loading_Costs<span class="sc">$</span>Warehouse <span class="sc">==</span> Warehouses<span class="sc">$</span>ID,  <span class="co"># Correct reference</span></span>
<span id="cb6-259"><a href="#cb6-259" aria-hidden="true" tabindex="-1"></a>    Loading_Costs<span class="sc">$</span>DC <span class="sc">==</span> Distribution_Centers<span class="sc">$</span>ID  <span class="co"># Assuming this is the correct reference</span></span>
<span id="cb6-260"><a href="#cb6-260" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-261"><a href="#cb6-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-262"><a href="#cb6-262" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and render the ERD</span></span>
<span id="cb6-263"><a href="#cb6-263" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_create_graph</span>(dm1, <span class="at">rankdir =</span> <span class="st">"LR"</span>, <span class="at">columnArrows =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-264"><a href="#cb6-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_render_graph</span>()</span>
<span id="cb6-265"><a href="#cb6-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-266"><a href="#cb6-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-267"><a href="#cb6-267" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb6-268"><a href="#cb6-268" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tải package datamodelr:</span></span>
<span id="cb6-269"><a href="#cb6-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-270"><a href="#cb6-270" aria-hidden="true" tabindex="-1"></a>Mình tạo biểu đồ này bằng thư viện <span class="in">`datamodelr`</span>. Bạn có thể tải bằng cú pháp: <span class="in">`devtools::install_github("bergant/datamodelr")`</span></span>
<span id="cb6-271"><a href="#cb6-271" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb6-272"><a href="#cb6-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-273"><a href="#cb6-273" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dữ liệu đầu vào:</span></span>
<span id="cb6-274"><a href="#cb6-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-275"><a href="#cb6-275" aria-hidden="true" tabindex="-1"></a>Như vậy, dựa vào đó, ta sẽ tính toán được 2 *matrix* về chi phí:</span>
<span id="cb6-276"><a href="#cb6-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-277"><a href="#cb6-277" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bảng giá loading ở các kho. (Hình bên trái)</span>
<span id="cb6-278"><a href="#cb6-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-279"><a href="#cb6-279" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bảng chi phí vận chuyển từ từng WH đến các DCs. (Hình bên phải)</span>
<span id="cb6-280"><a href="#cb6-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-283"><a href="#cb6-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-284"><a href="#cb6-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-285"><a href="#cb6-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-286"><a href="#cb6-286" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the transportation cost:</span></span>
<span id="cb6-287"><a href="#cb6-287" aria-hidden="true" tabindex="-1"></a><span class="co"># Haversine distance function</span></span>
<span id="cb6-288"><a href="#cb6-288" aria-hidden="true" tabindex="-1"></a>haversine <span class="ot">&lt;-</span> <span class="cf">function</span>(lat1, lon1, lat2, lon2) {</span>
<span id="cb6-289"><a href="#cb6-289" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="dv">6371</span> <span class="co"># Radius of Earth in kilometers</span></span>
<span id="cb6-290"><a href="#cb6-290" aria-hidden="true" tabindex="-1"></a>  dlat <span class="ot">&lt;-</span> (lat2 <span class="sc">-</span> lat1) <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span></span>
<span id="cb6-291"><a href="#cb6-291" aria-hidden="true" tabindex="-1"></a>  dlon <span class="ot">&lt;-</span> (lon2 <span class="sc">-</span> lon1) <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span></span>
<span id="cb6-292"><a href="#cb6-292" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">sin</span>(dlat <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sin</span>(dlat <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-293"><a href="#cb6-293" aria-hidden="true" tabindex="-1"></a>       <span class="fu">cos</span>(lat1 <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span>) <span class="sc">*</span> <span class="fu">cos</span>(lat2 <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span>) <span class="sc">*</span> </span>
<span id="cb6-294"><a href="#cb6-294" aria-hidden="true" tabindex="-1"></a>       <span class="fu">sin</span>(dlon <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sin</span>(dlon <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb6-295"><a href="#cb6-295" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">atan2</span>(<span class="fu">sqrt</span>(a), <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> a))</span>
<span id="cb6-296"><a href="#cb6-296" aria-hidden="true" tabindex="-1"></a>  R <span class="sc">*</span> c <span class="co"># Distance in kilometers</span></span>
<span id="cb6-297"><a href="#cb6-297" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-298"><a href="#cb6-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-299"><a href="#cb6-299" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate distance matrix based on coordinates</span></span>
<span id="cb6-300"><a href="#cb6-300" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(warehouses), <span class="at">ncol =</span> <span class="fu">nrow</span>(distribution_centers))</span>
<span id="cb6-301"><a href="#cb6-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-302"><a href="#cb6-302" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(warehouses)) {</span>
<span id="cb6-303"><a href="#cb6-303" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(distribution_centers)) {</span>
<span id="cb6-304"><a href="#cb6-304" aria-hidden="true" tabindex="-1"></a>    distance_matrix[i, j] <span class="ot">&lt;-</span> <span class="fu">haversine</span>(</span>
<span id="cb6-305"><a href="#cb6-305" aria-hidden="true" tabindex="-1"></a>      warehouses<span class="sc">$</span>Latitude[i], warehouses<span class="sc">$</span>Longitude[i],</span>
<span id="cb6-306"><a href="#cb6-306" aria-hidden="true" tabindex="-1"></a>      distribution_centers<span class="sc">$</span>Latitude[j], distribution_centers<span class="sc">$</span>Longitude[j]</span>
<span id="cb6-307"><a href="#cb6-307" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-308"><a href="#cb6-308" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-309"><a href="#cb6-309" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-310"><a href="#cb6-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-311"><a href="#cb6-311" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the fuel price (example value)</span></span>
<span id="cb6-312"><a href="#cb6-312" aria-hidden="true" tabindex="-1"></a>fuel_price <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># Fuel price per kilometer</span></span>
<span id="cb6-313"><a href="#cb6-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-314"><a href="#cb6-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate transportation costs</span></span>
<span id="cb6-315"><a href="#cb6-315" aria-hidden="true" tabindex="-1"></a>transportation_costs <span class="ot">&lt;-</span> distance_matrix <span class="sc">*</span> fuel_price <span class="sc">*</span> <span class="fl">0.4</span></span>
<span id="cb6-316"><a href="#cb6-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-317"><a href="#cb6-317" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate the loading cost:</span></span>
<span id="cb6-318"><a href="#cb6-318" aria-hidden="true" tabindex="-1"></a>weights_per_good <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb6-319"><a href="#cb6-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-320"><a href="#cb6-320" aria-hidden="true" tabindex="-1"></a>mean_loading_cost<span class="ot">&lt;-</span>loading_costs <span class="sc">|&gt;</span> </span>
<span id="cb6-321"><a href="#cb6-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(DC, Warehouse) <span class="sc">|&gt;</span> </span>
<span id="cb6-322"><a href="#cb6-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Loading_Cost,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">1000</span><span class="sc">/</span>weights_per_good) <span class="sc">|&gt;</span> <span class="co"># Assumes weighted of goods is 0.1kg </span></span>
<span id="cb6-323"><a href="#cb6-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb6-324"><a href="#cb6-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-325"><a href="#cb6-325" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb6-326"><a href="#cb6-326" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data frame to a wide format</span></span>
<span id="cb6-327"><a href="#cb6-327" aria-hidden="true" tabindex="-1"></a>mean_cost_matrix <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">dcast</span>(mean_loading_cost,</span>
<span id="cb6-328"><a href="#cb6-328" aria-hidden="true" tabindex="-1"></a>                          Warehouse <span class="sc">~</span> DC, </span>
<span id="cb6-329"><a href="#cb6-329" aria-hidden="true" tabindex="-1"></a>                          <span class="at">value.var =</span> <span class="st">"mean"</span>)</span>
<span id="cb6-330"><a href="#cb6-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-331"><a href="#cb6-331" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the data frame to a matrix and remove the Warehouse column</span></span>
<span id="cb6-332"><a href="#cb6-332" aria-hidden="true" tabindex="-1"></a>loading_costs_per_dc <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(mean_cost_matrix[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb6-333"><a href="#cb6-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-334"><a href="#cb6-334" aria-hidden="true" tabindex="-1"></a><span class="co"># Set row names as the warehouse names</span></span>
<span id="cb6-335"><a href="#cb6-335" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(loading_costs_per_dc) <span class="ot">&lt;-</span> mean_loading_cost<span class="sc">$</span>Warehouse[<span class="sc">!</span><span class="fu">duplicated</span>(mean_loading_cost<span class="sc">$</span>Warehouse)]</span>
<span id="cb6-336"><a href="#cb6-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-337"><a href="#cb6-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-338"><a href="#cb6-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-339"><a href="#cb6-339" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb6-340"><a href="#cb6-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-341"><a href="#cb6-341" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Bảng chi phí bốc xếp</span></span>
<span id="cb6-342"><a href="#cb6-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-345"><a href="#cb6-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-346"><a href="#cb6-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-347"><a href="#cb6-347" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-348"><a href="#cb6-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb6-349"><a href="#cb6-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: ["Biểu đồ 2: Heatmap cho bảng chi phí bốc xếp"]</span></span>
<span id="cb6-350"><a href="#cb6-350" aria-hidden="true" tabindex="-1"></a><span class="co"># Code tạo hai biểu đồ</span></span>
<span id="cb6-351"><a href="#cb6-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-352"><a href="#cb6-352" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-353"><a href="#cb6-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-354"><a href="#cb6-354" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the distance matrix to a data frame</span></span>
<span id="cb6-355"><a href="#cb6-355" aria-hidden="true" tabindex="-1"></a>distance_df <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(transportation_costs)</span>
<span id="cb6-356"><a href="#cb6-356" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(distance_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Warehouse"</span>, <span class="st">"Distribution_Center"</span>, <span class="st">"Transportation_Cost"</span>)</span>
<span id="cb6-357"><a href="#cb6-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-358"><a href="#cb6-358" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the distance matrix with updated colors</span></span>
<span id="cb6-359"><a href="#cb6-359" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(distance_df, <span class="fu">aes</span>(<span class="at">x =</span> Warehouse, </span>
<span id="cb6-360"><a href="#cb6-360" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> Distribution_Center, </span>
<span id="cb6-361"><a href="#cb6-361" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> Transportation_Cost)) <span class="sc">+</span></span>
<span id="cb6-362"><a href="#cb6-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  <span class="co"># Add borders to tiles</span></span>
<span id="cb6-363"><a href="#cb6-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">comma</span>(Transportation_Cost, <span class="at">accuracy =</span> <span class="dv">1</span>)), </span>
<span id="cb6-364"><a href="#cb6-364" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">ifelse</span>(distance_df<span class="sc">$</span>Transportation_Cost <span class="sc">&gt;</span> </span>
<span id="cb6-365"><a href="#cb6-365" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">max</span>(distance_df<span class="sc">$</span>Transportation_Cost)<span class="sc">/</span><span class="dv">2</span>, <span class="st">"white"</span>, <span class="st">"black"</span>),</span>
<span id="cb6-366"><a href="#cb6-366" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span>  <span class="co"># Adaptive text color</span></span>
<span id="cb6-367"><a href="#cb6-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb6-368"><a href="#cb6-368" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">"#f7fbff"</span>, </span>
<span id="cb6-369"><a href="#cb6-369" aria-hidden="true" tabindex="-1"></a>    <span class="at">mid =</span> <span class="st">"#6baed6"</span>, </span>
<span id="cb6-370"><a href="#cb6-370" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">"#08519c"</span>,</span>
<span id="cb6-371"><a href="#cb6-371" aria-hidden="true" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="fu">median</span>(distance_df<span class="sc">$</span>Transportation_Cost),</span>
<span id="cb6-372"><a href="#cb6-372" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Cost (VNĐ)"</span>,</span>
<span id="cb6-373"><a href="#cb6-373" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span>comma</span>
<span id="cb6-374"><a href="#cb6-374" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-375"><a href="#cb6-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-376"><a href="#cb6-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-377"><a href="#cb6-377" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Transportation Costs Between Facilities"</span>,</span>
<span id="cb6-378"><a href="#cb6-378" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Costs shown in Vietnamese Dong (VNĐ)"</span>,</span>
<span id="cb6-379"><a href="#cb6-379" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Warehouse"</span>,</span>
<span id="cb6-380"><a href="#cb6-380" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Distribution Center"</span></span>
<span id="cb6-381"><a href="#cb6-381" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-382"><a href="#cb6-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb6-383"><a href="#cb6-383" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb6-384"><a href="#cb6-384" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb6-385"><a href="#cb6-385" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">15</span>)),</span>
<span id="cb6-386"><a href="#cb6-386" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">15</span>)),</span>
<span id="cb6-387"><a href="#cb6-387" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb6-388"><a href="#cb6-388" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"gray30"</span>),</span>
<span id="cb6-389"><a href="#cb6-389" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),  <span class="co"># Remove grid lines</span></span>
<span id="cb6-390"><a href="#cb6-390" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb6-391"><a href="#cb6-391" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-392"><a href="#cb6-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-393"><a href="#cb6-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-394"><a href="#cb6-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-395"><a href="#cb6-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-396"><a href="#cb6-396" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Bảng giá vận chuyển:</span></span>
<span id="cb6-397"><a href="#cb6-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-400"><a href="#cb6-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-401"><a href="#cb6-401" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-402"><a href="#cb6-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-403"><a href="#cb6-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb6-404"><a href="#cb6-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: ["Biểu đồ 3: Bảng giá vận chuyển từ WH đến DC"]</span></span>
<span id="cb6-405"><a href="#cb6-405" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the transportation costs matrix to a data frame</span></span>
<span id="cb6-406"><a href="#cb6-406" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb6-407"><a href="#cb6-407" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtExtras)</span>
<span id="cb6-408"><a href="#cb6-408" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a gt table</span></span>
<span id="cb6-409"><a href="#cb6-409" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span>loading_costs <span class="sc">|&gt;</span></span>
<span id="cb6-410"><a href="#cb6-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Loading_Cost =</span> Loading_Cost <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb6-411"><a href="#cb6-411" aria-hidden="true" tabindex="-1"></a>         <span class="at">DC =</span> <span class="fu">paste</span>(<span class="st">"DC"</span>,DC),</span>
<span id="cb6-412"><a href="#cb6-412" aria-hidden="true" tabindex="-1"></a>         <span class="at">Warehouse =</span> <span class="fu">paste</span>(<span class="st">"WH"</span>,Warehouse)) <span class="co"># Convert to currency</span></span>
<span id="cb6-413"><a href="#cb6-413" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-414"><a href="#cb6-414" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(m[<span class="fu">order</span>(<span class="sc">-</span>m<span class="sc">$</span>Loading_Cost),]) <span class="sc">|&gt;</span> </span>
<span id="cb6-415"><a href="#cb6-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-416"><a href="#cb6-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_currency</span>(</span>
<span id="cb6-417"><a href="#cb6-417" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Loading_Cost,</span>
<span id="cb6-418"><a href="#cb6-418" aria-hidden="true" tabindex="-1"></a>    <span class="at">currency =</span> <span class="st">"VND"</span>,</span>
<span id="cb6-419"><a href="#cb6-419" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span>,</span>
<span id="cb6-420"><a href="#cb6-420" aria-hidden="true" tabindex="-1"></a>    <span class="at">use_seps =</span> <span class="cn">TRUE</span></span>
<span id="cb6-421"><a href="#cb6-421" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-422"><a href="#cb6-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb6-423"><a href="#cb6-423" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Loading Costs by weight category in each warehouses**"</span>),</span>
<span id="cb6-424"><a href="#cb6-424" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">md</span>(<span class="st">"Table just contains **expected loading cost**"</span>)</span>
<span id="cb6-425"><a href="#cb6-425" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span>  </span>
<span id="cb6-426"><a href="#cb6-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_align_table_header</span>(<span class="at">align =</span> <span class="st">"center"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-427"><a href="#cb6-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb6-428"><a href="#cb6-428" aria-hidden="true" tabindex="-1"></a>    <span class="at">Loading_Cost =</span> <span class="st">"Loading Cost (VNĐ)"</span>,</span>
<span id="cb6-429"><a href="#cb6-429" aria-hidden="true" tabindex="-1"></a>    <span class="at">Weight_Category =</span> <span class="st">"Weight Category"</span>,</span>
<span id="cb6-430"><a href="#cb6-430" aria-hidden="true" tabindex="-1"></a>    <span class="at">Has_Machine =</span> <span class="st">"Has Machine"</span>,</span>
<span id="cb6-431"><a href="#cb6-431" aria-hidden="true" tabindex="-1"></a>    <span class="at">DC =</span> <span class="st">"Distribution Center"</span></span>
<span id="cb6-432"><a href="#cb6-432" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb6-433"><a href="#cb6-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(<span class="at">method =</span> <span class="st">"numeric"</span>,</span>
<span id="cb6-434"><a href="#cb6-434" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="st">"viridis"</span>,</span>
<span id="cb6-435"><a href="#cb6-435" aria-hidden="true" tabindex="-1"></a>             <span class="at">reverse =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-436"><a href="#cb6-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt_theme_pff</span>() <span class="sc">|&gt;</span> </span>
<span id="cb6-437"><a href="#cb6-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(<span class="at">style =</span> <span class="fu">list</span>(<span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"center"</span>)),</span>
<span id="cb6-438"><a href="#cb6-438" aria-hidden="true" tabindex="-1"></a>            <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> <span class="fu">everything</span>())) <span class="sc">|&gt;</span></span>
<span id="cb6-439"><a href="#cb6-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb6-440"><a href="#cb6-440" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(</span>
<span id="cb6-441"><a href="#cb6-441" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">align =</span> <span class="st">"center"</span>)</span>
<span id="cb6-442"><a href="#cb6-442" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-443"><a href="#cb6-443" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">list</span>(</span>
<span id="cb6-444"><a href="#cb6-444" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cells_column_labels</span>(<span class="fu">everything</span>())</span>
<span id="cb6-445"><a href="#cb6-445" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-446"><a href="#cb6-446" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb6-447"><a href="#cb6-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="at">source =</span> <span class="fu">md</span>(<span class="st">"*Source: package gt in R*"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-448"><a href="#cb6-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb6-449"><a href="#cb6-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"font-weight: bold"</span>,</span>
<span id="cb6-450"><a href="#cb6-450" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(Weight_Category)</span>
<span id="cb6-451"><a href="#cb6-451" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-452"><a href="#cb6-452" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-453"><a href="#cb6-453" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-454"><a href="#cb6-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-455"><a href="#cb6-455" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb6-456"><a href="#cb6-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-457"><a href="#cb6-457" aria-hidden="true" tabindex="-1"></a><span class="fu">### Xây dựng hàm mục tiêu:</span></span>
<span id="cb6-458"><a href="#cb6-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-459"><a href="#cb6-459" aria-hidden="true" tabindex="-1"></a>Sau khi đã có đủ dữ liệu, bạn sẽ bắt đầu viết hàm mục tiêu và dùng thuật toán GA để tìm ra giá trị tối ưu nhất.</span>
<span id="cb6-460"><a href="#cb6-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-461"><a href="#cb6-461" aria-hidden="true" tabindex="-1"></a>Trong hàm <span class="in">`ga`</span> từ gói **GA** trong R, có một số đối số quan trọng cho phép bạn tùy chỉnh thuật toán di truyền. Dưới đây là một cái nhìn tổng quan về một số đối số quan trọng:</span>
<span id="cb6-462"><a href="#cb6-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-463"><a href="#cb6-463" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**type**: Chỉ định loại tối ưu hóa (ví dụ: <span class="in">`"real-valued"`</span>, <span class="in">`"binary"`</span> hoặc <span class="in">`"permutation"`</span>).</span>
<span id="cb6-464"><a href="#cb6-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-465"><a href="#cb6-465" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**fitness**: Hàm đánh giá độ phù hợp; nó nên nhận một vector tham số làm đầu vào và trả về một giá trị số.</span>
<span id="cb6-466"><a href="#cb6-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-467"><a href="#cb6-467" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**lower** và **upper**: Định nghĩa giới hạn cho các biến nếu bạn đang tối ưu hóa trong không gian liên tục (dùng cho các loại giá trị thực).</span>
<span id="cb6-468"><a href="#cb6-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-469"><a href="#cb6-469" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**popSize**: Thiết lập kích thước quần thể cho mỗi thế hệ.</span>
<span id="cb6-470"><a href="#cb6-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-471"><a href="#cb6-471" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**maxiter**: Chỉ định số thế hệ tối đa để chạy thuật toán.</span>
<span id="cb6-472"><a href="#cb6-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-473"><a href="#cb6-473" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**run**: Chỉ định số thế hệ để chạy thuật toán mà không có sự cải thiện trước khi dừng lại.</span>
<span id="cb6-474"><a href="#cb6-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-475"><a href="#cb6-475" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**pmutation**: Xác suất xảy ra đột biến trong quần thể.</span>
<span id="cb6-476"><a href="#cb6-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-477"><a href="#cb6-477" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**elitism**: Xác định xem các cá thể tốt nhất có nên được giữ lại trong thế hệ tiếp theo hay không.</span>
<span id="cb6-478"><a href="#cb6-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-479"><a href="#cb6-479" aria-hidden="true" tabindex="-1"></a>Những đối số này giúp điều chỉnh thuật toán di truyền cho các nhu cầu tối ưu hóa cụ thể của bạn, cho phép hiệu suất tốt hơn và hội tụ về các giải pháp tối ưu.</span>
<span id="cb6-480"><a href="#cb6-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-481"><a href="#cb6-481" aria-hidden="true" tabindex="-1"></a>Ngoài ra, còn có các lưu ý cho bạn khi sử dụng R như sau:</span>
<span id="cb6-482"><a href="#cb6-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-483"><a href="#cb6-483" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb6-484"><a href="#cb6-484" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Lưu ý khi dùng hàm ga():</span></span>
<span id="cb6-485"><a href="#cb6-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-486"><a href="#cb6-486" aria-hidden="true" tabindex="-1"></a>Hàm <span class="in">`ga()`</span> phải có ít nhất 2 đối số là <span class="in">`type`</span> và <span class="in">`fitness thì R mới chạy được.`</span></span>
<span id="cb6-487"><a href="#cb6-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-488"><a href="#cb6-488" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Riêng khi type = "binary" thì cần thêm đối số <span class="in">`nBits.`</span></span>
<span id="cb6-489"><a href="#cb6-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-490"><a href="#cb6-490" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Còn khi <span class="in">`type = "real-valued"/"permutation"`</span> thì cần thêm đối số <span class="in">`min`</span> và <span class="in">`max`</span>.</span>
<span id="cb6-491"><a href="#cb6-491" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb6-492"><a href="#cb6-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-495"><a href="#cb6-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-496"><a href="#cb6-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-497"><a href="#cb6-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-498"><a href="#cb6-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb6-499"><a href="#cb6-499" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb6-500"><a href="#cb6-500" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GA)</span>
<span id="cb6-501"><a href="#cb6-501" aria-hidden="true" tabindex="-1"></a>demand<span class="ot">&lt;-</span><span class="fu">c</span>(distribution_centers<span class="sc">$</span>Demand)</span>
<span id="cb6-502"><a href="#cb6-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-503"><a href="#cb6-503" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the objective function</span></span>
<span id="cb6-504"><a href="#cb6-504" aria-hidden="true" tabindex="-1"></a>objective_function <span class="ot">&lt;-</span> <span class="cf">function</span>(quantities) {</span>
<span id="cb6-505"><a href="#cb6-505" aria-hidden="true" tabindex="-1"></a>    quantities_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(quantities, </span>
<span id="cb6-506"><a href="#cb6-506" aria-hidden="true" tabindex="-1"></a>                                <span class="at">nrow =</span> <span class="dv">5</span>, </span>
<span id="cb6-507"><a href="#cb6-507" aria-hidden="true" tabindex="-1"></a>                                <span class="at">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb6-508"><a href="#cb6-508" aria-hidden="true" tabindex="-1"></a>                                <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-509"><a href="#cb6-509" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-510"><a href="#cb6-510" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total loading costs</span></span>
<span id="cb6-511"><a href="#cb6-511" aria-hidden="true" tabindex="-1"></a>    loading_costs <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(quantities_matrix) <span class="sc">*</span> loading_costs_per_dc  <span class="co"># Total loading costs for each DC</span></span>
<span id="cb6-512"><a href="#cb6-512" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total transportation costs</span></span>
<span id="cb6-513"><a href="#cb6-513" aria-hidden="true" tabindex="-1"></a>    transportation_costs <span class="ot">&lt;-</span> <span class="fu">sum</span>(quantities_matrix <span class="sc">*</span> transportation_costs)</span>
<span id="cb6-514"><a href="#cb6-514" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-515"><a href="#cb6-515" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine both costs</span></span>
<span id="cb6-516"><a href="#cb6-516" aria-hidden="true" tabindex="-1"></a>    total_cost <span class="ot">&lt;-</span> <span class="fu">sum</span>(loading_costs) <span class="sc">+</span> transportation_costs</span>
<span id="cb6-517"><a href="#cb6-517" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-518"><a href="#cb6-518" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if demands are met</span></span>
<span id="cb6-519"><a href="#cb6-519" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">colSums</span>(quantities_matrix) <span class="sc">&lt;</span> demand)) {</span>
<span id="cb6-520"><a href="#cb6-520" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="cn">Inf</span>)  <span class="co"># Penalize if demands are not met</span></span>
<span id="cb6-521"><a href="#cb6-521" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-522"><a href="#cb6-522" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-523"><a href="#cb6-523" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(total_cost)</span>
<span id="cb6-524"><a href="#cb6-524" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-525"><a href="#cb6-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-526"><a href="#cb6-526" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the Genetic Algorithm</span></span>
<span id="cb6-527"><a href="#cb6-527" aria-hidden="true" tabindex="-1"></a>num_vars <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">*</span> <span class="dv">3</span>  <span class="co"># 5 warehouses, 3 distribution centers</span></span>
<span id="cb6-528"><a href="#cb6-528" aria-hidden="true" tabindex="-1"></a>ga_result <span class="ot">&lt;-</span> <span class="fu">ga</span>(</span>
<span id="cb6-529"><a href="#cb6-529" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"real-valued"</span>,</span>
<span id="cb6-530"><a href="#cb6-530" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitness =</span> <span class="cf">function</span>(x) <span class="sc">-</span><span class="fu">objective_function</span>(x),  <span class="co"># Negate for minimization</span></span>
<span id="cb6-531"><a href="#cb6-531" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">rep</span>(<span class="dv">0</span>, num_vars),  <span class="co"># Minimum quantity</span></span>
<span id="cb6-532"><a href="#cb6-532" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">rep</span>(<span class="dv">100</span>, num_vars),  <span class="co"># Maximum quantity (adjust as needed)</span></span>
<span id="cb6-533"><a href="#cb6-533" aria-hidden="true" tabindex="-1"></a>    <span class="at">popSize =</span> <span class="dv">50</span>,</span>
<span id="cb6-534"><a href="#cb6-534" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxiter =</span> <span class="dv">100</span>,</span>
<span id="cb6-535"><a href="#cb6-535" aria-hidden="true" tabindex="-1"></a>    <span class="at">run =</span> <span class="dv">10</span>,</span>
<span id="cb6-536"><a href="#cb6-536" aria-hidden="true" tabindex="-1"></a>    <span class="at">monitor =</span> <span class="cn">TRUE</span></span>
<span id="cb6-537"><a href="#cb6-537" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-538"><a href="#cb6-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-539"><a href="#cb6-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-542"><a href="#cb6-542" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-543"><a href="#cb6-543" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb6-544"><a href="#cb6-544" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-545"><a href="#cb6-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-546"><a href="#cb6-546" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the summary of the GA result</span></span>
<span id="cb6-547"><a href="#cb6-547" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ga_result)</span>
<span id="cb6-548"><a href="#cb6-548" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming ga_result@solution contains optimal quantities</span></span>
<span id="cb6-549"><a href="#cb6-549" aria-hidden="true" tabindex="-1"></a>ga_result_solution <span class="ot">&lt;-</span> <span class="fu">c</span>(ga_result<span class="sc">@</span>solution)</span>
<span id="cb6-550"><a href="#cb6-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-551"><a href="#cb6-551" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the solution into a matrix (5 warehouses x 3 DCs)</span></span>
<span id="cb6-552"><a href="#cb6-552" aria-hidden="true" tabindex="-1"></a>optimal_quantities <span class="ot">&lt;-</span> <span class="fu">matrix</span>(ga_result<span class="sc">@</span>solution,</span>
<span id="cb6-553"><a href="#cb6-553" aria-hidden="true" tabindex="-1"></a>                             <span class="at">nrow =</span> <span class="dv">5</span>, </span>
<span id="cb6-554"><a href="#cb6-554" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb6-555"><a href="#cb6-555" aria-hidden="true" tabindex="-1"></a>                             <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-556"><a href="#cb6-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-557"><a href="#cb6-557" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the matrix to a data frame</span></span>
<span id="cb6-558"><a href="#cb6-558" aria-hidden="true" tabindex="-1"></a>weights<span class="ot">&lt;-</span>optimal_quantities<span class="sc">*</span> weights_per_good</span>
<span id="cb6-559"><a href="#cb6-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-560"><a href="#cb6-560" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(weights) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb6-561"><a href="#cb6-561" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(weights) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb6-562"><a href="#cb6-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-563"><a href="#cb6-563" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb6-564"><a href="#cb6-564" aria-hidden="true" tabindex="-1"></a>real_weighted <span class="ot">&lt;-</span> <span class="fu">melt</span>(weights)</span>
<span id="cb6-565"><a href="#cb6-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-566"><a href="#cb6-566" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the columns</span></span>
<span id="cb6-567"><a href="#cb6-567" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(real_weighted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Warehouse"</span>, <span class="st">"DC"</span>, <span class="st">"Total_Weight"</span>)</span>
<span id="cb6-568"><a href="#cb6-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-569"><a href="#cb6-569" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform left join</span></span>
<span id="cb6-570"><a href="#cb6-570" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> real_weighted <span class="sc">|&gt;</span></span>
<span id="cb6-571"><a href="#cb6-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(loading_costs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Warehouse"</span>, <span class="st">"DC"</span>))</span>
<span id="cb6-572"><a href="#cb6-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-573"><a href="#cb6-573" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span>result <span class="sc">|&gt;</span> </span>
<span id="cb6-574"><a href="#cb6-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Price =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-575"><a href="#cb6-575" aria-hidden="true" tabindex="-1"></a>    Total_Weight <span class="sc">&lt;</span> <span class="fl">1.5</span> <span class="sc">~</span> <span class="st">"&lt; 1.5"</span>,</span>
<span id="cb6-576"><a href="#cb6-576" aria-hidden="true" tabindex="-1"></a>    Total_Weight <span class="sc">&lt;</span><span class="fl">2.5</span> <span class="sc">~</span> <span class="st">"1.5 to 2.5"</span>,</span>
<span id="cb6-577"><a href="#cb6-577" aria-hidden="true" tabindex="-1"></a>    Total_Weight <span class="sc">&lt;</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"2.5 to 5"</span>,</span>
<span id="cb6-578"><a href="#cb6-578" aria-hidden="true" tabindex="-1"></a>    Total_Weight <span class="sc">&lt;</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"5 to 10"</span>,</span>
<span id="cb6-579"><a href="#cb6-579" aria-hidden="true" tabindex="-1"></a>    Total_Weight <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"&gt; 10"</span>,</span>
<span id="cb6-580"><a href="#cb6-580" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(Total_Weight) <span class="sc">~</span> <span class="cn">NA_character_</span>  <span class="co"># Handle NA explicitly if needed</span></span>
<span id="cb6-581"><a href="#cb6-581" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb6-582"><a href="#cb6-582" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-583"><a href="#cb6-583" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span>result <span class="sc">|&gt;</span> </span>
<span id="cb6-584"><a href="#cb6-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Weight_Category <span class="sc">==</span> Price) <span class="sc">|&gt;</span> </span>
<span id="cb6-585"><a href="#cb6-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Price)</span>
<span id="cb6-586"><a href="#cb6-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-587"><a href="#cb6-587" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with tranportation cost table:</span></span>
<span id="cb6-588"><a href="#cb6-588" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(transportation_costs) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb6-589"><a href="#cb6-589" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(transportation_costs) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb6-590"><a href="#cb6-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-591"><a href="#cb6-591" aria-hidden="true" tabindex="-1"></a>transport<span class="ot">&lt;-</span><span class="fu">melt</span>(transportation_costs)</span>
<span id="cb6-592"><a href="#cb6-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-593"><a href="#cb6-593" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the columns</span></span>
<span id="cb6-594"><a href="#cb6-594" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(transport) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Warehouse"</span>, <span class="st">"DC"</span>, <span class="st">"Transport_cost"</span>)</span>
<span id="cb6-595"><a href="#cb6-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-596"><a href="#cb6-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-597"><a href="#cb6-597" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">left_join</span>(result,</span>
<span id="cb6-598"><a href="#cb6-598" aria-hidden="true" tabindex="-1"></a>                  transport,</span>
<span id="cb6-599"><a href="#cb6-599" aria-hidden="true" tabindex="-1"></a>                  <span class="at">by=</span><span class="fu">c</span>(<span class="st">"Warehouse"</span>, <span class="st">"DC"</span>))</span>
<span id="cb6-600"><a href="#cb6-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-601"><a href="#cb6-601" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust:</span></span>
<span id="cb6-602"><a href="#cb6-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-603"><a href="#cb6-603" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span>result <span class="sc">|&gt;</span> </span>
<span id="cb6-604"><a href="#cb6-604" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Loading_Cost =</span> Loading_Cost<span class="sc">*</span><span class="dv">1000</span>,</span>
<span id="cb6-605"><a href="#cb6-605" aria-hidden="true" tabindex="-1"></a>             <span class="at">Transport_cost =</span> Transport_cost<span class="sc">*</span><span class="dv">1000</span>,</span>
<span id="cb6-606"><a href="#cb6-606" aria-hidden="true" tabindex="-1"></a>             <span class="at">DC =</span> <span class="fu">paste</span>(<span class="st">"DC"</span>,DC),</span>
<span id="cb6-607"><a href="#cb6-607" aria-hidden="true" tabindex="-1"></a>             <span class="at">Warehouse =</span> <span class="fu">paste</span>(<span class="st">"WH"</span>,Warehouse)) </span>
<span id="cb6-608"><a href="#cb6-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-609"><a href="#cb6-609" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder cols in table:</span></span>
<span id="cb6-610"><a href="#cb6-610" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span>result[,<span class="fu">c</span>(<span class="st">"Warehouse"</span>,</span>
<span id="cb6-611"><a href="#cb6-611" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"DC"</span>,</span>
<span id="cb6-612"><a href="#cb6-612" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Has_Machine"</span>,</span>
<span id="cb6-613"><a href="#cb6-613" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Total_Weight"</span>,</span>
<span id="cb6-614"><a href="#cb6-614" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Weight_Category"</span>,</span>
<span id="cb6-615"><a href="#cb6-615" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Loading_Cost"</span>,</span>
<span id="cb6-616"><a href="#cb6-616" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Transport_cost"</span>)]</span>
<span id="cb6-617"><a href="#cb6-617" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-618"><a href="#cb6-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-619"><a href="#cb6-619" aria-hidden="true" tabindex="-1"></a>Kết quả tối ưu sẽ được trình bày ở bảng này (hơi màu mè 1 tí!!!)</span>
<span id="cb6-620"><a href="#cb6-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-623"><a href="#cb6-623" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-624"><a href="#cb6-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb6-625"><a href="#cb6-625" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb6-626"><a href="#cb6-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb6-627"><a href="#cb6-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-628"><a href="#cb6-628" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb6-629"><a href="#cb6-629" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb6-630"><a href="#cb6-630" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb6-631"><a href="#cb6-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-632"><a href="#cb6-632" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Total_Cost column and Has_Machine_Icon</span></span>
<span id="cb6-633"><a href="#cb6-633" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> result <span class="sc">|&gt;</span> </span>
<span id="cb6-634"><a href="#cb6-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-635"><a href="#cb6-635" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_Cost =</span> Loading_Cost <span class="sc">+</span> Transport_cost,</span>
<span id="cb6-636"><a href="#cb6-636" aria-hidden="true" tabindex="-1"></a>    <span class="at">Has_Machine_Icon =</span> <span class="fu">ifelse</span>(Has_Machine <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="st">"✅"</span>, <span class="st">"❌"</span>)</span>
<span id="cb6-637"><a href="#cb6-637" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb6-638"><a href="#cb6-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Has_Machine)</span>
<span id="cb6-639"><a href="#cb6-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-640"><a href="#cb6-640" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the row with highest total cost</span></span>
<span id="cb6-641"><a href="#cb6-641" aria-hidden="true" tabindex="-1"></a>max_total_cost <span class="ot">&lt;-</span> <span class="fu">max</span>(result<span class="sc">$</span>Total_Cost, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-642"><a href="#cb6-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-643"><a href="#cb6-643" aria-hidden="true" tabindex="-1"></a><span class="co"># Build enhanced GT table</span></span>
<span id="cb6-644"><a href="#cb6-644" aria-hidden="true" tabindex="-1"></a>result <span class="sc">|&gt;</span></span>
<span id="cb6-645"><a href="#cb6-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-646"><a href="#cb6-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb6-647"><a href="#cb6-647" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">html</span>(<span class="st">"&lt;b&gt;📦 Warehouse Shipment Summary&lt;/b&gt;"</span>),</span>
<span id="cb6-648"><a href="#cb6-648" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">md</span>(<span class="st">"Cost Breakdown &amp; Machine Availability"</span>)</span>
<span id="cb6-649"><a href="#cb6-649" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-650"><a href="#cb6-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_currency</span>(</span>
<span id="cb6-651"><a href="#cb6-651" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Loading_Cost, Transport_cost, Total_Cost),</span>
<span id="cb6-652"><a href="#cb6-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">currency =</span> <span class="st">"USD"</span></span>
<span id="cb6-653"><a href="#cb6-653" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-654"><a href="#cb6-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb6-655"><a href="#cb6-655" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Total_Weight,</span>
<span id="cb6-656"><a href="#cb6-656" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb6-657"><a href="#cb6-657" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-658"><a href="#cb6-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(</span>
<span id="cb6-659"><a href="#cb6-659" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Total_Weight,</span>
<span id="cb6-660"><a href="#cb6-660" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">col_numeric</span>(</span>
<span id="cb6-661"><a href="#cb6-661" aria-hidden="true" tabindex="-1"></a>      <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"lightblue"</span>, <span class="st">"blue"</span>),</span>
<span id="cb6-662"><a href="#cb6-662" aria-hidden="true" tabindex="-1"></a>      <span class="at">domain =</span> <span class="cn">NULL</span></span>
<span id="cb6-663"><a href="#cb6-663" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-664"><a href="#cb6-664" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-665"><a href="#cb6-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(</span>
<span id="cb6-666"><a href="#cb6-666" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Loading_Cost,</span>
<span id="cb6-667"><a href="#cb6-667" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">col_numeric</span>(</span>
<span id="cb6-668"><a href="#cb6-668" aria-hidden="true" tabindex="-1"></a>      <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"lightyellow"</span>, <span class="st">"orange"</span>),</span>
<span id="cb6-669"><a href="#cb6-669" aria-hidden="true" tabindex="-1"></a>      <span class="at">domain =</span> <span class="cn">NULL</span></span>
<span id="cb6-670"><a href="#cb6-670" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-671"><a href="#cb6-671" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-672"><a href="#cb6-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(</span>
<span id="cb6-673"><a href="#cb6-673" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Transport_cost,</span>
<span id="cb6-674"><a href="#cb6-674" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">col_numeric</span>(</span>
<span id="cb6-675"><a href="#cb6-675" aria-hidden="true" tabindex="-1"></a>      <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"lightpink"</span>, <span class="st">"deeppink"</span>),</span>
<span id="cb6-676"><a href="#cb6-676" aria-hidden="true" tabindex="-1"></a>      <span class="at">domain =</span> <span class="cn">NULL</span></span>
<span id="cb6-677"><a href="#cb6-677" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-678"><a href="#cb6-678" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-679"><a href="#cb6-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(</span>
<span id="cb6-680"><a href="#cb6-680" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Total_Cost,</span>
<span id="cb6-681"><a href="#cb6-681" aria-hidden="true" tabindex="-1"></a>    <span class="at">colors =</span> <span class="fu">col_numeric</span>(</span>
<span id="cb6-682"><a href="#cb6-682" aria-hidden="true" tabindex="-1"></a>      <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"lightgreen"</span>, <span class="st">"forestgreen"</span>),</span>
<span id="cb6-683"><a href="#cb6-683" aria-hidden="true" tabindex="-1"></a>      <span class="at">domain =</span> <span class="cn">NULL</span></span>
<span id="cb6-684"><a href="#cb6-684" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-685"><a href="#cb6-685" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-686"><a href="#cb6-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb6-687"><a href="#cb6-687" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>),</span>
<span id="cb6-688"><a href="#cb6-688" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb6-689"><a href="#cb6-689" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">vars</span>(Total_Cost),</span>
<span id="cb6-690"><a href="#cb6-690" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Total_Cost <span class="sc">==</span> max_total_cost</span>
<span id="cb6-691"><a href="#cb6-691" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-692"><a href="#cb6-692" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-693"><a href="#cb6-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb6-694"><a href="#cb6-694" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"lightgray"</span>),</span>
<span id="cb6-695"><a href="#cb6-695" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb6-696"><a href="#cb6-696" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">vars</span>(Has_Machine_Icon),</span>
<span id="cb6-697"><a href="#cb6-697" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Has_Machine_Icon <span class="sc">==</span> <span class="st">"✅"</span></span>
<span id="cb6-698"><a href="#cb6-698" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-699"><a href="#cb6-699" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-700"><a href="#cb6-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb6-701"><a href="#cb6-701" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#f5e1f7"</span>),</span>
<span id="cb6-702"><a href="#cb6-702" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb6-703"><a href="#cb6-703" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">vars</span>(Has_Machine_Icon),</span>
<span id="cb6-704"><a href="#cb6-704" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Has_Machine_Icon <span class="sc">==</span> <span class="st">"❌"</span></span>
<span id="cb6-705"><a href="#cb6-705" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-706"><a href="#cb6-706" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-707"><a href="#cb6-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb6-708"><a href="#cb6-708" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#fdf5e6"</span>),</span>
<span id="cb6-709"><a href="#cb6-709" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb6-710"><a href="#cb6-710" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">vars</span>(Weight_Category),</span>
<span id="cb6-711"><a href="#cb6-711" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Weight_Category <span class="sc">==</span> <span class="st">"Light"</span></span>
<span id="cb6-712"><a href="#cb6-712" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-713"><a href="#cb6-713" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-714"><a href="#cb6-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb6-715"><a href="#cb6-715" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#ffe4b5"</span>),</span>
<span id="cb6-716"><a href="#cb6-716" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb6-717"><a href="#cb6-717" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">vars</span>(Weight_Category),</span>
<span id="cb6-718"><a href="#cb6-718" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Weight_Category <span class="sc">==</span> <span class="st">"Medium"</span></span>
<span id="cb6-719"><a href="#cb6-719" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-720"><a href="#cb6-720" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb6-721"><a href="#cb6-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb6-722"><a href="#cb6-722" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"#ffcccb"</span>),</span>
<span id="cb6-723"><a href="#cb6-723" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb6-724"><a href="#cb6-724" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">vars</span>(Weight_Category),</span>
<span id="cb6-725"><a href="#cb6-725" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Weight_Category <span class="sc">==</span> <span class="st">"Heavy"</span></span>
<span id="cb6-726"><a href="#cb6-726" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-727"><a href="#cb6-727" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb6-728"><a href="#cb6-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb6-729"><a href="#cb6-729" aria-hidden="true" tabindex="-1"></a>  <span class="at">Warehouse =</span> <span class="st">"🏢 Warehouse"</span>,</span>
<span id="cb6-730"><a href="#cb6-730" aria-hidden="true" tabindex="-1"></a>  <span class="at">DC =</span> <span class="st">"🏬 Distribution Center"</span>,</span>
<span id="cb6-731"><a href="#cb6-731" aria-hidden="true" tabindex="-1"></a>  <span class="at">Has_Machine_Icon =</span> <span class="st">"🛠 Machine"</span>,</span>
<span id="cb6-732"><a href="#cb6-732" aria-hidden="true" tabindex="-1"></a>  <span class="at">Total_Weight =</span> <span class="st">"📦 Total Weight (kg)"</span>,</span>
<span id="cb6-733"><a href="#cb6-733" aria-hidden="true" tabindex="-1"></a>  <span class="at">Weight_Category =</span> <span class="st">"⚖️ Weight Category"</span>,</span>
<span id="cb6-734"><a href="#cb6-734" aria-hidden="true" tabindex="-1"></a>  <span class="at">Loading_Cost =</span> <span class="st">"💼 Loading Cost"</span>,</span>
<span id="cb6-735"><a href="#cb6-735" aria-hidden="true" tabindex="-1"></a>  <span class="at">Transport_cost =</span> <span class="st">"🚚 Transport Cost"</span>,</span>
<span id="cb6-736"><a href="#cb6-736" aria-hidden="true" tabindex="-1"></a>  <span class="at">Total_Cost =</span> <span class="st">"💰 Total Cost"</span></span>
<span id="cb6-737"><a href="#cb6-737" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb6-738"><a href="#cb6-738" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_style</span>(</span>
<span id="cb6-739"><a href="#cb6-739" aria-hidden="true" tabindex="-1"></a>  <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>),</span>
<span id="cb6-740"><a href="#cb6-740" aria-hidden="true" tabindex="-1"></a>  <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> <span class="fu">everything</span>())</span>
<span id="cb6-741"><a href="#cb6-741" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb6-742"><a href="#cb6-742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">opt_row_striping</span>()</span>
<span id="cb6-743"><a href="#cb6-743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-744"><a href="#cb6-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-745"><a href="#cb6-745" aria-hidden="true" tabindex="-1"></a><span class="fu"># Báo cáo:</span></span>
<span id="cb6-746"><a href="#cb6-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-747"><a href="#cb6-747" aria-hidden="true" tabindex="-1"></a>Và cuối cùng, sau khi có kết quả, mình sẽ dùng các thư viện gồm: **Leaflet**, **gt**, và **biểu đồ Sankey** phục vụ những mục đích khác nhau cho trực quan hóa dữ liệu.</span>
<span id="cb6-748"><a href="#cb6-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-749"><a href="#cb6-749" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Leaflet**: Đây là một thư viện mạnh mẽ để tạo bản đồ tương tác. Nó cho phép người dùng dễ dàng thêm các lớp, điểm đánh dấu và pop-up, rất lý tưởng để trực quan hóa dữ liệu địa lý. Leaflet đặc biệt hữu ích để hiển thị các dữ liệu như vị trí, lộ trình, hoặc phân bố không gian.</span>
<span id="cb6-750"><a href="#cb6-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-751"><a href="#cb6-751" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**gt**: Gói **gt** được thiết kế để tạo ra các bảng chất lượng cao trong R. Nó cho phép người dùng định dạng và tạo kiểu cho bảng một cách dễ dàng, giúp chúng trở nên hấp dẫn và dễ đọc. gt hỗ trợ các tính năng như định dạng tùy chỉnh, dòng tóm tắt, và thậm chí thêm chú thích, nâng cao cách trình bày dữ liệu trong báo cáo.</span>
<span id="cb6-752"><a href="#cb6-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-753"><a href="#cb6-753" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Biểu đồ Sankey**: Những biểu đồ này được sử dụng để trực quan hóa luồng và mối quan hệ giữa các danh mục khác nhau. Trong R, gói **networkD3** hoặc **ggalluvial** có thể tạo ra biểu đồ Sankey, giúp hiểu cách các giá trị di chuyển giữa các nút, chẳng hạn như theo dõi hành trình người dùng hoặc hiển thị phân bổ tài nguyên.</span>
<span id="cb6-754"><a href="#cb6-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-755"><a href="#cb6-755" aria-hidden="true" tabindex="-1"></a>Để kết nối các biểu đồ lại với nhau, ta thường nghĩ đến <span class="in">`Shiny`</span> trong **R** nhưng vì chúng ta đang tạo website bằng **Quarto** nên output cuối cùng sẽ là một trang web tĩnh - *static website*. Do đó, nó sẽ không phản hồi với thông tin đầu vào của người dùng hoặc chạy bất kỳ mã R nào. Bạn có thể hình dung giống như bạn đang muốn xem biểu đồ về doanh thu trong tháng tiếp theo trên 1 biểu đồ trong Word - không thể làm được vì nó thuộc dạng văn bản, bạn chỉ đọc hoặc nhìn chứ không tương tác được.</span>
<span id="cb6-756"><a href="#cb6-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-757"><a href="#cb6-757" aria-hidden="true" tabindex="-1"></a>Tuy vậy, sau một thời gian tìm hiểu, mình cũng tìm được cách để nhúng **Shiny** vào R để hiển thị trên Quarto. Nguồn tài liệu bạn có thể kham khảo ở trang này <span class="co">[</span><span class="ot">r-shinylive-demo</span><span class="co">](https://github.com/coatless-quarto/r-shinylive-demo)</span>.</span>
<span id="cb6-758"><a href="#cb6-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-759"><a href="#cb6-759" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb6-760"><a href="#cb6-760" aria-hidden="true" tabindex="-1"></a>**Shinylive** là 1 extension của Quarto và được kích hoạt bằng: </span>
<span id="cb6-761"><a href="#cb6-761" aria-hidden="true" tabindex="-1"></a><span class="in">```yaml</span></span>
<span id="cb6-762"><a href="#cb6-762" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span><span class="kw">:</span></span>
<span id="cb6-763"><a href="#cb6-763" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span>quarto-ext/shinylive</span>
<span id="cb6-764"><a href="#cb6-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-765"><a href="#cb6-765" aria-hidden="true" tabindex="-1"></a>các extension trong filter sẽ ảnh hưởng đến kết quả sau khi Quarto render xong. App Shiny chỉ xuất hiện sau đó, nên bạn cần đợi thêm tùy theo độ nặng của app.</span>
<span id="cb6-766"><a href="#cb6-766" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb6-767"><a href="#cb6-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-768"><a href="#cb6-768" aria-hidden="true" tabindex="-1"></a>:::{.column-page}</span>
<span id="cb6-769"><a href="#cb6-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-770"><a href="#cb6-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{shinylive-r}</span></span>
<span id="cb6-771"><a href="#cb6-771" aria-hidden="true" tabindex="-1"></a><span class="co">#| viewerHeight: 1000</span></span>
<span id="cb6-772"><a href="#cb6-772" aria-hidden="true" tabindex="-1"></a><span class="co">#| standalone: true</span></span>
<span id="cb6-773"><a href="#cb6-773" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Biểu đồ 3: Dashboard về lịch trình vận chuyển hàng dự tính"</span></span>
<span id="cb6-774"><a href="#cb6-774" aria-hidden="true" tabindex="-1"></a><span class="ex">pacman::p_load</span><span class="er">(</span></span>
<span id="cb6-775"><a href="#cb6-775" aria-hidden="true" tabindex="-1"></a>  <span class="ex">leaflet,</span></span>
<span id="cb6-776"><a href="#cb6-776" aria-hidden="true" tabindex="-1"></a>  <span class="ex">dplyr,</span></span>
<span id="cb6-777"><a href="#cb6-777" aria-hidden="true" tabindex="-1"></a>  <span class="ex">networkD3,</span></span>
<span id="cb6-778"><a href="#cb6-778" aria-hidden="true" tabindex="-1"></a>  <span class="ex">shiny,</span></span>
<span id="cb6-779"><a href="#cb6-779" aria-hidden="true" tabindex="-1"></a>  <span class="ex">bslib,</span></span>
<span id="cb6-780"><a href="#cb6-780" aria-hidden="true" tabindex="-1"></a>  <span class="ex">DT,</span></span>
<span id="cb6-781"><a href="#cb6-781" aria-hidden="true" tabindex="-1"></a>  <span class="ex">htmltools</span></span>
<span id="cb6-782"><a href="#cb6-782" aria-hidden="true" tabindex="-1"></a><span class="kw">)</span></span>
<span id="cb6-783"><a href="#cb6-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-784"><a href="#cb6-784" aria-hidden="true" tabindex="-1"></a><span class="co"># Add value:</span></span>
<span id="cb6-785"><a href="#cb6-785" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert GA solution to a matrix</span></span>
<span id="cb6-786"><a href="#cb6-786" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal quantities matrix</span></span>
<span id="cb6-787"><a href="#cb6-787" aria-hidden="true" tabindex="-1"></a><span class="ex">optimal_quantities</span> <span class="op">&lt;</span>- matrix<span class="er">(</span><span class="ex">c</span><span class="er">(</span></span>
<span id="cb6-788"><a href="#cb6-788" aria-hidden="true" tabindex="-1"></a>  <span class="ex">43.306058,</span> 10.87137, 13.26283,</span>
<span id="cb6-789"><a href="#cb6-789" aria-hidden="true" tabindex="-1"></a>  <span class="ex">15.524054,</span> 30.42748, 48.86716,</span>
<span id="cb6-790"><a href="#cb6-790" aria-hidden="true" tabindex="-1"></a>  <span class="ex">7.599769,</span> 44.93531, 27.46289,</span>
<span id="cb6-791"><a href="#cb6-791" aria-hidden="true" tabindex="-1"></a>  <span class="ex">18.556927,</span> 17.60396, 41.85203,</span>
<span id="cb6-792"><a href="#cb6-792" aria-hidden="true" tabindex="-1"></a>  <span class="ex">16.305016,</span> 13.15498, 21.79634</span>
<span id="cb6-793"><a href="#cb6-793" aria-hidden="true" tabindex="-1"></a><span class="kw">)</span><span class="ex">,</span> nrow = 5, ncol = 3, byrow = TRUE<span class="kw">)</span></span>
<span id="cb6-794"><a href="#cb6-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-795"><a href="#cb6-795" aria-hidden="true" tabindex="-1"></a><span class="co"># Warehouse data:</span></span>
<span id="cb6-796"><a href="#cb6-796" aria-hidden="true" tabindex="-1"></a><span class="ex">warehouses</span> <span class="op">&lt;</span>- data.frame<span class="er">(</span></span>
<span id="cb6-797"><a href="#cb6-797" aria-hidden="true" tabindex="-1"></a>  <span class="ex">ID</span> = 1:5,</span>
<span id="cb6-798"><a href="#cb6-798" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Latitude</span> = c<span class="er">(</span><span class="ex">21.0285,</span> 16.0545, 10.7769, 14.0583, 19.8060<span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-799"><a href="#cb6-799" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Longitude</span> = c<span class="er">(</span><span class="ex">105.8040,</span> 108.2022, 106.6957, 108.2772, 105.7460<span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-800"><a href="#cb6-800" aria-hidden="true" tabindex="-1"></a>  <span class="ex">District</span> = c<span class="er">(</span><span class="st">"Đống Đa"</span><span class="ex">,</span> <span class="st">"Hải Châu"</span>, <span class="st">"Quận 1"</span>, <span class="st">"Mang Yang"</span>, <span class="st">"Đông Sơn"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-801"><a href="#cb6-801" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Province</span> = c<span class="er">(</span><span class="st">"Hà Nội"</span><span class="ex">,</span> <span class="st">"Đà Nẵng"</span>, <span class="st">"Hồ Chí Minh"</span>, <span class="st">"Gia Lai"</span>, <span class="st">"Thanh Hóa"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-802"><a href="#cb6-802" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Address</span> = c<span class="er">(</span></span>
<span id="cb6-803"><a href="#cb6-803" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2RH3+9HX Đống Đa, Hà Nội, Việt Nam"</span><span class="ex">,</span></span>
<span id="cb6-804"><a href="#cb6-804" aria-hidden="true" tabindex="-1"></a>    <span class="st">"3632+RV4 Hải Châu, Đà Nẵng, Việt Nam"</span><span class="ex">,</span></span>
<span id="cb6-805"><a href="#cb6-805" aria-hidden="true" tabindex="-1"></a>    <span class="st">"QMGW+Q74 Quận 1, Hồ Chí Minh, Việt Nam"</span><span class="ex">,</span></span>
<span id="cb6-806"><a href="#cb6-806" aria-hidden="true" tabindex="-1"></a>    <span class="st">"375G+8VG Mang Yang, Gia Lai, Việt Nam"</span><span class="ex">,</span></span>
<span id="cb6-807"><a href="#cb6-807" aria-hidden="true" tabindex="-1"></a>    <span class="st">"RP4W+99X Đông Sơn, Thanh Hóa, Việt Nam"</span></span>
<span id="cb6-808"><a href="#cb6-808" aria-hidden="true" tabindex="-1"></a>  <span class="kw">)</span></span>
<span id="cb6-809"><a href="#cb6-809" aria-hidden="true" tabindex="-1"></a><span class="kw">)</span></span>
<span id="cb6-810"><a href="#cb6-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-811"><a href="#cb6-811" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution center data:</span></span>
<span id="cb6-812"><a href="#cb6-812" aria-hidden="true" tabindex="-1"></a><span class="ex">distribution_centers</span> <span class="op">&lt;</span>- data.frame<span class="er">(</span></span>
<span id="cb6-813"><a href="#cb6-813" aria-hidden="true" tabindex="-1"></a>  <span class="ex">ID</span> = 1:3,</span>
<span id="cb6-814"><a href="#cb6-814" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Latitude</span> = c<span class="er">(</span><span class="ex">17.97486,</span> 11.77690, 15.12233<span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-815"><a href="#cb6-815" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Longitude</span> = c<span class="er">(</span><span class="ex">102.6309,</span> 106.6957, 108.7994<span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-816"><a href="#cb6-816" aria-hidden="true" tabindex="-1"></a>  <span class="ex">District</span> = c<span class="er">(</span><span class="st">"Viêng Chăn"</span><span class="ex">,</span> <span class="st">"Lộc Ninh"</span>, <span class="st">"Quảng Ngãi"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-817"><a href="#cb6-817" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Province</span> = c<span class="er">(</span><span class="st">"Lào"</span><span class="ex">,</span> <span class="st">"Bình Phước"</span>, <span class="st">"Quảng Ngãi"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-818"><a href="#cb6-818" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Address</span> = c<span class="er">(</span></span>
<span id="cb6-819"><a href="#cb6-819" aria-hidden="true" tabindex="-1"></a>    <span class="st">"XJFJ+W8X Viêng Chăn, Lào"</span><span class="ex">,</span></span>
<span id="cb6-820"><a href="#cb6-820" aria-hidden="true" tabindex="-1"></a>    <span class="st">"QMGW+Q74 Lộc Ninh, Bình Phước, Việt Nam"</span><span class="ex">,</span></span>
<span id="cb6-821"><a href="#cb6-821" aria-hidden="true" tabindex="-1"></a>    <span class="st">"4QCX+WPQ Quảng Ngãi, Việt Nam"</span></span>
<span id="cb6-822"><a href="#cb6-822" aria-hidden="true" tabindex="-1"></a>  <span class="kw">)</span></span>
<span id="cb6-823"><a href="#cb6-823" aria-hidden="true" tabindex="-1"></a><span class="kw">)</span></span>
<span id="cb6-824"><a href="#cb6-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-825"><a href="#cb6-825" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame with the warehouse data</span></span>
<span id="cb6-826"><a href="#cb6-826" aria-hidden="true" tabindex="-1"></a><span class="ex">result</span> <span class="op">&lt;</span>- data.frame<span class="er">(</span></span>
<span id="cb6-827"><a href="#cb6-827" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Warehouse</span> = c<span class="er">(</span><span class="st">"WH 1"</span><span class="ex">,</span> <span class="st">"WH 2"</span>, <span class="st">"WH 3"</span>, <span class="st">"WH 4"</span>, <span class="st">"WH 5"</span>,</span>
<span id="cb6-828"><a href="#cb6-828" aria-hidden="true" tabindex="-1"></a>                <span class="st">"WH 1"</span><span class="ex">,</span> <span class="st">"WH 2"</span>, <span class="st">"WH 3"</span>, <span class="st">"WH 4"</span>, <span class="st">"WH 5"</span>,</span>
<span id="cb6-829"><a href="#cb6-829" aria-hidden="true" tabindex="-1"></a>                <span class="st">"WH 1"</span><span class="ex">,</span> <span class="st">"WH 2"</span>, <span class="st">"WH 3"</span>, <span class="st">"WH 4"</span>, <span class="st">"WH 5"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-830"><a href="#cb6-830" aria-hidden="true" tabindex="-1"></a>  <span class="ex">DC</span> = c<span class="er">(</span><span class="st">"DC 1"</span><span class="ex">,</span> <span class="st">"DC 1"</span>, <span class="st">"DC 1"</span>, <span class="st">"DC 1"</span>, <span class="st">"DC 1"</span>,</span>
<span id="cb6-831"><a href="#cb6-831" aria-hidden="true" tabindex="-1"></a>         <span class="st">"DC 2"</span><span class="ex">,</span> <span class="st">"DC 2"</span>, <span class="st">"DC 2"</span>, <span class="st">"DC 2"</span>, <span class="st">"DC 2"</span>,</span>
<span id="cb6-832"><a href="#cb6-832" aria-hidden="true" tabindex="-1"></a>         <span class="st">"DC 3"</span><span class="ex">,</span> <span class="st">"DC 3"</span>, <span class="st">"DC 3"</span>, <span class="st">"DC 3"</span>, <span class="st">"DC 3"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-833"><a href="#cb6-833" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Has_Machine</span> = c<span class="er">(</span><span class="st">"Yes"</span><span class="ex">,</span> <span class="st">"No"</span>, <span class="st">"No"</span>, <span class="st">"No"</span>, <span class="st">"No"</span>,</span>
<span id="cb6-834"><a href="#cb6-834" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"No"</span><span class="ex">,</span> <span class="st">"No"</span>, <span class="st">"No"</span>, <span class="st">"No"</span>, <span class="st">"No"</span>,</span>
<span id="cb6-835"><a href="#cb6-835" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"No"</span><span class="ex">,</span> <span class="st">"No"</span>, <span class="st">"No"</span>, <span class="st">"No"</span>, <span class="st">"No"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-836"><a href="#cb6-836" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Total_Weight</span> = c<span class="er">(</span><span class="ex">4.3306058,</span> 1.5524054, 0.7599769, 1.8556927, 1.6305016,</span>
<span id="cb6-837"><a href="#cb6-837" aria-hidden="true" tabindex="-1"></a>                   <span class="ex">1.0871366,</span> 3.0427479, 4.4935308, 1.7603961, 1.3154977,</span>
<span id="cb6-838"><a href="#cb6-838" aria-hidden="true" tabindex="-1"></a>                   <span class="ex">1.3262832,</span> 4.8867159, 2.7462887, 4.1852028, 2.1796338<span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-839"><a href="#cb6-839" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Weight_Category</span> = c<span class="er">(</span><span class="st">"2.5 to 5"</span><span class="ex">,</span> <span class="st">"1.5 to 2.5"</span>, <span class="st">"&lt; 1.5"</span>, <span class="st">"1.5 to 2.5"</span>, <span class="st">"1.5 to 2.5"</span>,</span>
<span id="cb6-840"><a href="#cb6-840" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"&lt; 1.5"</span><span class="ex">,</span> <span class="st">"2.5 to 5"</span>, <span class="st">"2.5 to 5"</span>, <span class="st">"1.5 to 2.5"</span>, <span class="st">"&lt; 1.5"</span>,</span>
<span id="cb6-841"><a href="#cb6-841" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"&lt; 1.5"</span><span class="ex">,</span> <span class="st">"2.5 to 5"</span>, <span class="st">"2.5 to 5"</span>, <span class="st">"2.5 to 5"</span>, <span class="st">"1.5 to 2.5"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-842"><a href="#cb6-842" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Loading_Cost</span> = c<span class="er">(</span><span class="ex">64300,</span> 40680, 144640, 38790, 18750,</span>
<span id="cb6-843"><a href="#cb6-843" aria-hidden="true" tabindex="-1"></a>                   <span class="ex">11610,</span> 97870, 36380, 69120, 70030,</span>
<span id="cb6-844"><a href="#cb6-844" aria-hidden="true" tabindex="-1"></a>                   <span class="ex">143740,</span> 91150, 64990, 114230, 96240<span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-845"><a href="#cb6-845" aria-hidden="true" tabindex="-1"></a>  <span class="ex">Transport_cost</span> = c<span class="er">(</span><span class="ex">3802097.2,</span> 5037171.3, 7297102.2, 5952559.7, 3086494.5,</span>
<span id="cb6-846"><a href="#cb6-846" aria-hidden="true" tabindex="-1"></a>                     <span class="ex">8264855.3,</span> 4021256.9, 889559.4, 2449208.3, 7188382.3,</span>
<span id="cb6-847"><a href="#cb6-847" aria-hidden="true" tabindex="-1"></a>                     <span class="ex">5831987.6,</span> 974375.3, 4273915.6, 1047828.2, 4905804.6<span class="kw">)</span></span>
<span id="cb6-848"><a href="#cb6-848" aria-hidden="true" tabindex="-1"></a><span class="kw">)</span></span>
<span id="cb6-849"><a href="#cb6-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-850"><a href="#cb6-850" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom icon:</span></span>
<span id="cb6-851"><a href="#cb6-851" aria-hidden="true" tabindex="-1"></a><span class="ex">warehouse_icon</span> <span class="op">&lt;</span>- makeIcon<span class="er">(</span></span>
<span id="cb6-852"><a href="#cb6-852" aria-hidden="true" tabindex="-1"></a>  <span class="ex">iconUrl</span> = <span class="st">"https://raw.githubusercontent.com/Loccx78vn/genetic-algorithm-method/refs/heads/main/img/warehouse_icon.png"</span>,</span>
<span id="cb6-853"><a href="#cb6-853" aria-hidden="true" tabindex="-1"></a>  <span class="ex">iconWidth</span> = 30,</span>
<span id="cb6-854"><a href="#cb6-854" aria-hidden="true" tabindex="-1"></a>  <span class="ex">iconHeight</span> = 30</span>
<span id="cb6-855"><a href="#cb6-855" aria-hidden="true" tabindex="-1"></a><span class="kw">)</span></span>
<span id="cb6-856"><a href="#cb6-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-857"><a href="#cb6-857" aria-hidden="true" tabindex="-1"></a><span class="ex">dc_icon</span> <span class="op">&lt;</span>- makeIcon<span class="er">(</span></span>
<span id="cb6-858"><a href="#cb6-858" aria-hidden="true" tabindex="-1"></a>  <span class="ex">iconUrl</span> = <span class="st">"https://raw.githubusercontent.com/Loccx78vn/genetic-algorithm-method/refs/heads/main/img/distribution_center.png"</span>,</span>
<span id="cb6-859"><a href="#cb6-859" aria-hidden="true" tabindex="-1"></a>  <span class="ex">iconWidth</span> = 30,</span>
<span id="cb6-860"><a href="#cb6-860" aria-hidden="true" tabindex="-1"></a>  <span class="ex">iconHeight</span> = 30</span>
<span id="cb6-861"><a href="#cb6-861" aria-hidden="true" tabindex="-1"></a><span class="kw">)</span></span>
<span id="cb6-862"><a href="#cb6-862" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a custom theme</span></span>
<span id="cb6-863"><a href="#cb6-863" aria-hidden="true" tabindex="-1"></a><span class="ex">my_theme</span> <span class="op">&lt;</span>- bs_theme<span class="er">(</span></span>
<span id="cb6-864"><a href="#cb6-864" aria-hidden="true" tabindex="-1"></a>  <span class="ex">version</span> = 5,</span>
<span id="cb6-865"><a href="#cb6-865" aria-hidden="true" tabindex="-1"></a>  <span class="ex">bootswatch</span> = <span class="st">"litera"</span>,</span>
<span id="cb6-866"><a href="#cb6-866" aria-hidden="true" tabindex="-1"></a>  <span class="ex">primary</span> = <span class="st">"#3b5998"</span>,</span>
<span id="cb6-867"><a href="#cb6-867" aria-hidden="true" tabindex="-1"></a>  <span class="ex">secondary</span> = <span class="st">"#5cb85c"</span>,</span>
<span id="cb6-868"><a href="#cb6-868" aria-hidden="true" tabindex="-1"></a>  <span class="ex">success</span> = <span class="st">"#5cb85c"</span>,</span>
<span id="cb6-869"><a href="#cb6-869" aria-hidden="true" tabindex="-1"></a>  <span class="ex">info</span> = <span class="st">"#5bc0de"</span>,</span>
<span id="cb6-870"><a href="#cb6-870" aria-hidden="true" tabindex="-1"></a>  <span class="ex">warning</span> = <span class="st">"#f0ad4e"</span>,</span>
<span id="cb6-871"><a href="#cb6-871" aria-hidden="true" tabindex="-1"></a>  <span class="ex">danger</span> = <span class="st">"#d9534f"</span></span>
<span id="cb6-872"><a href="#cb6-872" aria-hidden="true" tabindex="-1"></a><span class="kw">)</span></span>
<span id="cb6-873"><a href="#cb6-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-874"><a href="#cb6-874" aria-hidden="true" tabindex="-1"></a><span class="co"># Define UI</span></span>
<span id="cb6-875"><a href="#cb6-875" aria-hidden="true" tabindex="-1"></a><span class="ex">ui</span> <span class="op">&lt;</span>- page_fluid<span class="er">(</span></span>
<span id="cb6-876"><a href="#cb6-876" aria-hidden="true" tabindex="-1"></a>  <span class="ex">theme</span> = my_theme,</span>
<span id="cb6-877"><a href="#cb6-877" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-878"><a href="#cb6-878" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Custom CSS for better visualization</span></span>
<span id="cb6-879"><a href="#cb6-879" aria-hidden="true" tabindex="-1"></a>  <span class="ex">tags</span><span class="va">$head</span><span class="er">(</span></span>
<span id="cb6-880"><a href="#cb6-880" aria-hidden="true" tabindex="-1"></a>    <span class="ex">tags</span><span class="va">$style</span><span class="er">(</span><span class="ex">HTML</span><span class="er">(</span><span class="st">"</span></span>
<span id="cb6-881"><a href="#cb6-881" aria-hidden="true" tabindex="-1"></a><span class="st">      .card-header {</span></span>
<span id="cb6-882"><a href="#cb6-882" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #3b5998;</span></span>
<span id="cb6-883"><a href="#cb6-883" aria-hidden="true" tabindex="-1"></a><span class="st">        color: white;</span></span>
<span id="cb6-884"><a href="#cb6-884" aria-hidden="true" tabindex="-1"></a><span class="st">        font-weight: bold;</span></span>
<span id="cb6-885"><a href="#cb6-885" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb6-886"><a href="#cb6-886" aria-hidden="true" tabindex="-1"></a><span class="st">      .nav-tabs .nav-link.active {</span></span>
<span id="cb6-887"><a href="#cb6-887" aria-hidden="true" tabindex="-1"></a><span class="st">        font-weight: bold;</span></span>
<span id="cb6-888"><a href="#cb6-888" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #3b5998;</span></span>
<span id="cb6-889"><a href="#cb6-889" aria-hidden="true" tabindex="-1"></a><span class="st">        border-bottom: 2px solid #3b5998;</span></span>
<span id="cb6-890"><a href="#cb6-890" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb6-891"><a href="#cb6-891" aria-hidden="true" tabindex="-1"></a><span class="st">      .nav-tabs .nav-link {</span></span>
<span id="cb6-892"><a href="#cb6-892" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #6c757d;</span></span>
<span id="cb6-893"><a href="#cb6-893" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb6-894"><a href="#cb6-894" aria-hidden="true" tabindex="-1"></a><span class="st">      .checkbox span {</span></span>
<span id="cb6-895"><a href="#cb6-895" aria-hidden="true" tabindex="-1"></a><span class="st">        font-weight: normal;</span></span>
<span id="cb6-896"><a href="#cb6-896" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb6-897"><a href="#cb6-897" aria-hidden="true" tabindex="-1"></a><span class="st">      .checkbox input:checked + span {</span></span>
<span id="cb6-898"><a href="#cb6-898" aria-hidden="true" tabindex="-1"></a><span class="st">        font-weight: bold;</span></span>
<span id="cb6-899"><a href="#cb6-899" aria-hidden="true" tabindex="-1"></a><span class="st">        color: #3b5998;</span></span>
<span id="cb6-900"><a href="#cb6-900" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb6-901"><a href="#cb6-901" aria-hidden="true" tabindex="-1"></a><span class="st">      .warehouse-selection {</span></span>
<span id="cb6-902"><a href="#cb6-902" aria-hidden="true" tabindex="-1"></a><span class="st">        border-left: 4px solid #3b5998;</span></span>
<span id="cb6-903"><a href="#cb6-903" aria-hidden="true" tabindex="-1"></a><span class="st">        padding-left: 10px;</span></span>
<span id="cb6-904"><a href="#cb6-904" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb6-905"><a href="#cb6-905" aria-hidden="true" tabindex="-1"></a><span class="st">      .dataTables_wrapper {</span></span>
<span id="cb6-906"><a href="#cb6-906" aria-hidden="true" tabindex="-1"></a><span class="st">        padding: 10px;</span></span>
<span id="cb6-907"><a href="#cb6-907" aria-hidden="true" tabindex="-1"></a><span class="st">        border-radius: 5px;</span></span>
<span id="cb6-908"><a href="#cb6-908" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb6-909"><a href="#cb6-909" aria-hidden="true" tabindex="-1"></a><span class="st">      .table thead th {</span></span>
<span id="cb6-910"><a href="#cb6-910" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #e9ecef;</span></span>
<span id="cb6-911"><a href="#cb6-911" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb6-912"><a href="#cb6-912" aria-hidden="true" tabindex="-1"></a><span class="st">      .leaflet-container {</span></span>
<span id="cb6-913"><a href="#cb6-913" aria-hidden="true" tabindex="-1"></a><span class="st">        border-radius: 8px;</span></span>
<span id="cb6-914"><a href="#cb6-914" aria-hidden="true" tabindex="-1"></a><span class="st">        box-shadow: 0 2px 4px rgba(0,0,0,0.1);</span></span>
<span id="cb6-915"><a href="#cb6-915" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb6-916"><a href="#cb6-916" aria-hidden="true" tabindex="-1"></a><span class="st">      .sankey-container {</span></span>
<span id="cb6-917"><a href="#cb6-917" aria-hidden="true" tabindex="-1"></a><span class="st">        border: 1px solid #dee2e6;</span></span>
<span id="cb6-918"><a href="#cb6-918" aria-hidden="true" tabindex="-1"></a><span class="st">        border-radius: 8px;</span></span>
<span id="cb6-919"><a href="#cb6-919" aria-hidden="true" tabindex="-1"></a><span class="st">        padding: 10px;</span></span>
<span id="cb6-920"><a href="#cb6-920" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #f8f9fa;</span></span>
<span id="cb6-921"><a href="#cb6-921" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb6-922"><a href="#cb6-922" aria-hidden="true" tabindex="-1"></a><span class="st">      .summary-stats {</span></span>
<span id="cb6-923"><a href="#cb6-923" aria-hidden="true" tabindex="-1"></a><span class="st">        background-color: #f8f9fa;</span></span>
<span id="cb6-924"><a href="#cb6-924" aria-hidden="true" tabindex="-1"></a><span class="st">        border-radius: 5px;</span></span>
<span id="cb6-925"><a href="#cb6-925" aria-hidden="true" tabindex="-1"></a><span class="st">        padding: 10px;</span></span>
<span id="cb6-926"><a href="#cb6-926" aria-hidden="true" tabindex="-1"></a><span class="st">        margin-bottom: 15px;</span></span>
<span id="cb6-927"><a href="#cb6-927" aria-hidden="true" tabindex="-1"></a><span class="st">        border-left: 4px solid #3b5998;</span></span>
<span id="cb6-928"><a href="#cb6-928" aria-hidden="true" tabindex="-1"></a><span class="st">      }</span></span>
<span id="cb6-929"><a href="#cb6-929" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span><span class="kw">))</span></span>
<span id="cb6-930"><a href="#cb6-930" aria-hidden="true" tabindex="-1"></a>  <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-931"><a href="#cb6-931" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-932"><a href="#cb6-932" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Page header - simplified</span></span>
<span id="cb6-933"><a href="#cb6-933" aria-hidden="true" tabindex="-1"></a>  <span class="ex">card</span><span class="er">(</span></span>
<span id="cb6-934"><a href="#cb6-934" aria-hidden="true" tabindex="-1"></a>    <span class="ex">card_header</span><span class="er">(</span></span>
<span id="cb6-935"><a href="#cb6-935" aria-hidden="true" tabindex="-1"></a>      <span class="ex">tags</span><span class="va">$div</span><span class="er">(</span></span>
<span id="cb6-936"><a href="#cb6-936" aria-hidden="true" tabindex="-1"></a>        <span class="ex">class</span> = <span class="st">"d-flex align-items-center"</span>,</span>
<span id="cb6-937"><a href="#cb6-937" aria-hidden="true" tabindex="-1"></a>        <span class="ex">tags</span><span class="va">$img</span><span class="er">(</span></span>
<span id="cb6-938"><a href="#cb6-938" aria-hidden="true" tabindex="-1"></a>          <span class="ex">src</span> = <span class="st">"https://raw.githubusercontent.com/Loccx78vn/genetic-algorithm-method/refs/heads/main/img/supply-chain-management.png"</span>, </span>
<span id="cb6-939"><a href="#cb6-939" aria-hidden="true" tabindex="-1"></a>          <span class="ex">height</span> = <span class="st">"30px"</span>, </span>
<span id="cb6-940"><a href="#cb6-940" aria-hidden="true" tabindex="-1"></a>          <span class="ex">style</span> = <span class="st">"margin-right: 10px;"</span></span>
<span id="cb6-941"><a href="#cb6-941" aria-hidden="true" tabindex="-1"></a>        <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-942"><a href="#cb6-942" aria-hidden="true" tabindex="-1"></a>        <span class="ex">h3</span><span class="er">(</span><span class="st">"Warehouse Distribution Dashboard"</span><span class="ex">,</span> class = <span class="st">"m-0"</span><span class="kw">)</span></span>
<span id="cb6-943"><a href="#cb6-943" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span></span>
<span id="cb6-944"><a href="#cb6-944" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-945"><a href="#cb6-945" aria-hidden="true" tabindex="-1"></a>    <span class="ex">card_body</span><span class="er">(</span></span>
<span id="cb6-946"><a href="#cb6-946" aria-hidden="true" tabindex="-1"></a>      <span class="st">"This dashboard shows the optimal distribution of goods from warehouses to distribution centers."</span></span>
<span id="cb6-947"><a href="#cb6-947" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span></span>
<span id="cb6-948"><a href="#cb6-948" aria-hidden="true" tabindex="-1"></a>  <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-949"><a href="#cb6-949" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-950"><a href="#cb6-950" aria-hidden="true" tabindex="-1"></a>  <span class="ex">layout_sidebar</span><span class="er">(</span></span>
<span id="cb6-951"><a href="#cb6-951" aria-hidden="true" tabindex="-1"></a>    <span class="ex">sidebar</span> = sidebar<span class="er">(</span></span>
<span id="cb6-952"><a href="#cb6-952" aria-hidden="true" tabindex="-1"></a>      <span class="ex">title</span> = <span class="st">"Controls"</span>,</span>
<span id="cb6-953"><a href="#cb6-953" aria-hidden="true" tabindex="-1"></a>      <span class="ex">width</span> = 300,</span>
<span id="cb6-954"><a href="#cb6-954" aria-hidden="true" tabindex="-1"></a>      <span class="bu">bg</span> = <span class="st">"#f8f9fa"</span>,</span>
<span id="cb6-955"><a href="#cb6-955" aria-hidden="true" tabindex="-1"></a>      <span class="ex">class</span> = <span class="st">"warehouse-selection"</span>,</span>
<span id="cb6-956"><a href="#cb6-956" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-957"><a href="#cb6-957" aria-hidden="true" tabindex="-1"></a>      <span class="ex">h4</span><span class="er">(</span><span class="st">"Warehouse Selection"</span><span class="ex">,</span> class = <span class="st">"mb-3 text-primary"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-958"><a href="#cb6-958" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-959"><a href="#cb6-959" aria-hidden="true" tabindex="-1"></a>      <span class="ex">p</span><span class="er">(</span><span class="st">"Select one or more warehouses to view their distribution data on the map and in the charts."</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-960"><a href="#cb6-960" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-961"><a href="#cb6-961" aria-hidden="true" tabindex="-1"></a>      <span class="ex">checkboxGroupInput</span><span class="er">(</span></span>
<span id="cb6-962"><a href="#cb6-962" aria-hidden="true" tabindex="-1"></a>        <span class="ex">inputId</span> = <span class="st">"warehouse"</span>, </span>
<span id="cb6-963"><a href="#cb6-963" aria-hidden="true" tabindex="-1"></a>        <span class="ex">label</span> = NULL, </span>
<span id="cb6-964"><a href="#cb6-964" aria-hidden="true" tabindex="-1"></a>        <span class="ex">choices</span> = setNames<span class="er">(</span></span>
<span id="cb6-965"><a href="#cb6-965" aria-hidden="true" tabindex="-1"></a>          <span class="fu">paste</span><span class="er">(</span><span class="st">"Warehouse"</span><span class="ex">,</span> 1:5<span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-966"><a href="#cb6-966" aria-hidden="true" tabindex="-1"></a>          <span class="fu">paste</span><span class="er">(</span><span class="st">"Warehouse"</span><span class="ex">,</span> 1:5, <span class="st">"-"</span>, warehouses<span class="va">$District</span>, <span class="st">","</span>, warehouses<span class="va">$Province</span><span class="kw">)</span></span>
<span id="cb6-967"><a href="#cb6-967" aria-hidden="true" tabindex="-1"></a>        <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-968"><a href="#cb6-968" aria-hidden="true" tabindex="-1"></a>        <span class="ex">selected</span> = paste<span class="er">(</span><span class="st">"Warehouse"</span><span class="ex">,</span> 1<span class="kw">)</span></span>
<span id="cb6-969"><a href="#cb6-969" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-970"><a href="#cb6-970" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-971"><a href="#cb6-971" aria-hidden="true" tabindex="-1"></a>      <span class="fu">hr()</span><span class="ex">,</span></span>
<span id="cb6-972"><a href="#cb6-972" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-973"><a href="#cb6-973" aria-hidden="true" tabindex="-1"></a>      <span class="ex">tags</span><span class="va">$div</span><span class="er">(</span></span>
<span id="cb6-974"><a href="#cb6-974" aria-hidden="true" tabindex="-1"></a>        <span class="ex">class</span> = <span class="st">"alert alert-info"</span>,</span>
<span id="cb6-975"><a href="#cb6-975" aria-hidden="true" tabindex="-1"></a>        <span class="ex">icon</span><span class="er">(</span><span class="st">"info-circle"</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb6-976"><a href="#cb6-976" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Click on the map markers for detailed location information."</span></span>
<span id="cb6-977"><a href="#cb6-977" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span></span>
<span id="cb6-978"><a href="#cb6-978" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-979"><a href="#cb6-979" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-980"><a href="#cb6-980" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Main content - restructured to put summary above map</span></span>
<span id="cb6-981"><a href="#cb6-981" aria-hidden="true" tabindex="-1"></a>    <span class="ex">tabsetPanel</span><span class="er">(</span></span>
<span id="cb6-982"><a href="#cb6-982" aria-hidden="true" tabindex="-1"></a>      <span class="ex">tabPanel</span><span class="er">(</span></span>
<span id="cb6-983"><a href="#cb6-983" aria-hidden="true" tabindex="-1"></a>        <span class="ex">title</span> = <span class="st">"Interactive Map"</span>, </span>
<span id="cb6-984"><a href="#cb6-984" aria-hidden="true" tabindex="-1"></a>        <span class="ex">icon</span> = icon<span class="er">(</span><span class="st">"map"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-985"><a href="#cb6-985" aria-hidden="true" tabindex="-1"></a>        <span class="ex">card</span><span class="er">(</span></span>
<span id="cb6-986"><a href="#cb6-986" aria-hidden="true" tabindex="-1"></a>          <span class="ex">full_screen</span> = TRUE,</span>
<span id="cb6-987"><a href="#cb6-987" aria-hidden="true" tabindex="-1"></a>          <span class="ex">height</span> = <span class="st">"650px"</span>, <span class="co"># Increased height</span></span>
<span id="cb6-988"><a href="#cb6-988" aria-hidden="true" tabindex="-1"></a>          <span class="ex">card_body</span><span class="er">(</span></span>
<span id="cb6-989"><a href="#cb6-989" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Summary stats placed above the map</span></span>
<span id="cb6-990"><a href="#cb6-990" aria-hidden="true" tabindex="-1"></a>            <span class="ex">tags</span><span class="va">$div</span><span class="er">(</span></span>
<span id="cb6-991"><a href="#cb6-991" aria-hidden="true" tabindex="-1"></a>              <span class="ex">class</span> = <span class="st">"summary-stats"</span>,</span>
<span id="cb6-992"><a href="#cb6-992" aria-hidden="true" tabindex="-1"></a>              <span class="ex">uiOutput</span><span class="er">(</span><span class="st">"summary_stats"</span><span class="kw">)</span></span>
<span id="cb6-993"><a href="#cb6-993" aria-hidden="true" tabindex="-1"></a>            <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-994"><a href="#cb6-994" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Map with increased height</span></span>
<span id="cb6-995"><a href="#cb6-995" aria-hidden="true" tabindex="-1"></a>            <span class="ex">leafletOutput</span><span class="er">(</span><span class="st">"map"</span><span class="ex">,</span> height = <span class="st">"550px"</span><span class="kw">)</span> <span class="co"># Increased map height</span></span>
<span id="cb6-996"><a href="#cb6-996" aria-hidden="true" tabindex="-1"></a>          <span class="kw">)</span></span>
<span id="cb6-997"><a href="#cb6-997" aria-hidden="true" tabindex="-1"></a>        <span class="kw">)</span></span>
<span id="cb6-998"><a href="#cb6-998" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-999"><a href="#cb6-999" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-1000"><a href="#cb6-1000" aria-hidden="true" tabindex="-1"></a>      <span class="ex">tabPanel</span><span class="er">(</span></span>
<span id="cb6-1001"><a href="#cb6-1001" aria-hidden="true" tabindex="-1"></a>        <span class="ex">title</span> = <span class="st">"Cost Analysis"</span>, </span>
<span id="cb6-1002"><a href="#cb6-1002" aria-hidden="true" tabindex="-1"></a>        <span class="ex">icon</span> = icon<span class="er">(</span><span class="st">"table"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1003"><a href="#cb6-1003" aria-hidden="true" tabindex="-1"></a>        <span class="ex">card</span><span class="er">(</span></span>
<span id="cb6-1004"><a href="#cb6-1004" aria-hidden="true" tabindex="-1"></a>          <span class="ex">full_screen</span> = TRUE,</span>
<span id="cb6-1005"><a href="#cb6-1005" aria-hidden="true" tabindex="-1"></a>          <span class="ex">height</span> = <span class="st">"650px"</span>, <span class="co"># Increased to match</span></span>
<span id="cb6-1006"><a href="#cb6-1006" aria-hidden="true" tabindex="-1"></a>          <span class="ex">card_header</span><span class="er">(</span><span class="st">"Cost Table"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1007"><a href="#cb6-1007" aria-hidden="true" tabindex="-1"></a>          <span class="ex">DTOutput</span><span class="er">(</span><span class="st">"cost_table"</span><span class="kw">)</span></span>
<span id="cb6-1008"><a href="#cb6-1008" aria-hidden="true" tabindex="-1"></a>        <span class="kw">)</span></span>
<span id="cb6-1009"><a href="#cb6-1009" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1010"><a href="#cb6-1010" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-1011"><a href="#cb6-1011" aria-hidden="true" tabindex="-1"></a>      <span class="ex">tabPanel</span><span class="er">(</span></span>
<span id="cb6-1012"><a href="#cb6-1012" aria-hidden="true" tabindex="-1"></a>        <span class="ex">title</span> = <span class="st">"Flow Diagram"</span>, </span>
<span id="cb6-1013"><a href="#cb6-1013" aria-hidden="true" tabindex="-1"></a>        <span class="ex">icon</span> = icon<span class="er">(</span><span class="st">"diagram-project"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1014"><a href="#cb6-1014" aria-hidden="true" tabindex="-1"></a>        <span class="ex">card</span><span class="er">(</span></span>
<span id="cb6-1015"><a href="#cb6-1015" aria-hidden="true" tabindex="-1"></a>          <span class="ex">full_screen</span> = TRUE,</span>
<span id="cb6-1016"><a href="#cb6-1016" aria-hidden="true" tabindex="-1"></a>          <span class="ex">height</span> = <span class="st">"650px"</span>, <span class="co"># Increased to match</span></span>
<span id="cb6-1017"><a href="#cb6-1017" aria-hidden="true" tabindex="-1"></a>          <span class="ex">card_header</span><span class="er">(</span><span class="st">"Distribution Flow Diagram"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1018"><a href="#cb6-1018" aria-hidden="true" tabindex="-1"></a>          <span class="ex">tags</span><span class="va">$div</span><span class="er">(</span></span>
<span id="cb6-1019"><a href="#cb6-1019" aria-hidden="true" tabindex="-1"></a>            <span class="ex">class</span> = <span class="st">"sankey-container"</span>,</span>
<span id="cb6-1020"><a href="#cb6-1020" aria-hidden="true" tabindex="-1"></a>            <span class="ex">uiOutput</span><span class="er">(</span><span class="st">"sankey_diagram"</span><span class="kw">)</span></span>
<span id="cb6-1021"><a href="#cb6-1021" aria-hidden="true" tabindex="-1"></a>          <span class="kw">)</span></span>
<span id="cb6-1022"><a href="#cb6-1022" aria-hidden="true" tabindex="-1"></a>        <span class="kw">)</span></span>
<span id="cb6-1023"><a href="#cb6-1023" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span></span>
<span id="cb6-1024"><a href="#cb6-1024" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span></span>
<span id="cb6-1025"><a href="#cb6-1025" aria-hidden="true" tabindex="-1"></a>  <span class="kw">)</span></span>
<span id="cb6-1026"><a href="#cb6-1026" aria-hidden="true" tabindex="-1"></a><span class="kw">)</span></span>
<span id="cb6-1027"><a href="#cb6-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1028"><a href="#cb6-1028" aria-hidden="true" tabindex="-1"></a><span class="co"># Define server logic</span></span>
<span id="cb6-1029"><a href="#cb6-1029" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> <span class="op">&lt;</span>- function<span class="er">(</span><span class="ex">input,</span> output, session<span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb6-1030"><a href="#cb6-1030" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-1031"><a href="#cb6-1031" aria-hidden="true" tabindex="-1"></a>  <span class="ex">location</span> <span class="op">&lt;</span>- reactive<span class="er">(</span><span class="kw">{</span></span>
<span id="cb6-1032"><a href="#cb6-1032" aria-hidden="true" tabindex="-1"></a>    <span class="ex">req</span><span class="er">(</span><span class="ex">input</span><span class="va">$warehouse</span><span class="kw">)</span> </span>
<span id="cb6-1033"><a href="#cb6-1033" aria-hidden="true" tabindex="-1"></a>    <span class="ex">as.numeric</span><span class="er">(</span><span class="ex">sub</span><span class="er">(</span><span class="st">"Warehouse "</span><span class="ex">,</span> <span class="st">""</span>, input<span class="va">$warehouse</span><span class="kw">))</span></span>
<span id="cb6-1034"><a href="#cb6-1034" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb6-1035"><a href="#cb6-1035" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-1036"><a href="#cb6-1036" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the leaflet map</span></span>
<span id="cb6-1037"><a href="#cb6-1037" aria-hidden="true" tabindex="-1"></a>  <span class="ex">output</span><span class="va">$map</span> <span class="op">&lt;</span>- renderLeaflet<span class="er">(</span><span class="kw">{</span></span>
<span id="cb6-1038"><a href="#cb6-1038" aria-hidden="true" tabindex="-1"></a>    <span class="ex">req</span><span class="er">(</span><span class="fu">location()</span><span class="kw">)</span></span>
<span id="cb6-1039"><a href="#cb6-1039" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1040"><a href="#cb6-1040" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Color palette for routes</span></span>
<span id="cb6-1041"><a href="#cb6-1041" aria-hidden="true" tabindex="-1"></a>    <span class="ex">route_colors</span> <span class="op">&lt;</span>- c<span class="er">(</span><span class="st">"#FF5733"</span><span class="ex">,</span> <span class="st">"#33A8FF"</span>, <span class="st">"#33FF57"</span>, <span class="st">"#D433FF"</span>, <span class="st">"#FFD133"</span><span class="kw">)</span></span>
<span id="cb6-1042"><a href="#cb6-1042" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1043"><a href="#cb6-1043" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the map</span></span>
<span id="cb6-1044"><a href="#cb6-1044" aria-hidden="true" tabindex="-1"></a>    <span class="ex">map</span> <span class="op">&lt;</span>- leaflet<span class="er">(</span><span class="kw">)</span> <span class="kw">|</span><span class="op">&gt;</span></span>
<span id="cb6-1045"><a href="#cb6-1045" aria-hidden="true" tabindex="-1"></a>      <span class="fu">addTiles()</span> <span class="kw">|</span><span class="op">&gt;</span></span>
<span id="cb6-1046"><a href="#cb6-1046" aria-hidden="true" tabindex="-1"></a>      <span class="ex">addProviderTiles</span><span class="er">(</span><span class="ex">providers</span><span class="va">$CartoDB</span><span class="ex">.Positron</span><span class="kw">)</span> <span class="kw">|</span><span class="op">&gt;</span></span>
<span id="cb6-1047"><a href="#cb6-1047" aria-hidden="true" tabindex="-1"></a>      <span class="ex">addMarkers</span><span class="er">(</span><span class="ex">data</span> = warehouses <span class="kw">|</span><span class="op">&gt;</span> filter<span class="kw">(</span><span class="ex">ID</span> %in% location<span class="er">(</span><span class="kw">))</span><span class="ex">,</span> </span>
<span id="cb6-1048"><a href="#cb6-1048" aria-hidden="true" tabindex="-1"></a>                 <span class="ex">lat</span> = ~Latitude, </span>
<span id="cb6-1049"><a href="#cb6-1049" aria-hidden="true" tabindex="-1"></a>                 <span class="ex">lng</span> = ~Longitude, </span>
<span id="cb6-1050"><a href="#cb6-1050" aria-hidden="true" tabindex="-1"></a>                 <span class="ex">label</span> = ~paste0<span class="er">(</span><span class="st">"&lt;strong&gt; ID Warehouse: &lt;/strong&gt; "</span><span class="ex">,</span> ID, <span class="st">"&lt;br/&gt; "</span>,</span>
<span id="cb6-1051"><a href="#cb6-1051" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"&lt;strong&gt; Province: &lt;/strong&gt; "</span><span class="ex">,</span> Province, <span class="st">"&lt;br/&gt; "</span>,</span>
<span id="cb6-1052"><a href="#cb6-1052" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"&lt;strong&gt; District: &lt;/strong&gt; "</span><span class="ex">,</span> District, <span class="st">"&lt;br/&gt; "</span>,</span>
<span id="cb6-1053"><a href="#cb6-1053" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"&lt;strong&gt; Address: &lt;/strong&gt; "</span><span class="ex">,</span> Address, <span class="st">"&lt;br/&gt; "</span><span class="kw">)</span> <span class="kw">|</span><span class="op">&gt;</span> </span>
<span id="cb6-1054"><a href="#cb6-1054" aria-hidden="true" tabindex="-1"></a>                   <span class="ex">lapply</span><span class="er">(</span><span class="ex">htmltools::HTML</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1055"><a href="#cb6-1055" aria-hidden="true" tabindex="-1"></a>                 <span class="ex">icon</span> = warehouse_icon<span class="kw">)</span> <span class="kw">|</span><span class="op">&gt;</span></span>
<span id="cb6-1056"><a href="#cb6-1056" aria-hidden="true" tabindex="-1"></a>      <span class="ex">addMarkers</span><span class="er">(</span><span class="ex">data</span> = distribution_centers, </span>
<span id="cb6-1057"><a href="#cb6-1057" aria-hidden="true" tabindex="-1"></a>                 <span class="ex">lat</span> = ~Latitude, </span>
<span id="cb6-1058"><a href="#cb6-1058" aria-hidden="true" tabindex="-1"></a>                 <span class="ex">lng</span> = ~Longitude, </span>
<span id="cb6-1059"><a href="#cb6-1059" aria-hidden="true" tabindex="-1"></a>                 <span class="ex">label</span> = ~paste0<span class="er">(</span><span class="st">"&lt;strong&gt; ID Distribution Center: &lt;/strong&gt; "</span><span class="ex">,</span> ID, <span class="st">"&lt;br/&gt; "</span>,</span>
<span id="cb6-1060"><a href="#cb6-1060" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"&lt;strong&gt; Province: &lt;/strong&gt; "</span><span class="ex">,</span> Province, <span class="st">"&lt;br/&gt; "</span>,</span>
<span id="cb6-1061"><a href="#cb6-1061" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"&lt;strong&gt; District: &lt;/strong&gt; "</span><span class="ex">,</span> District, <span class="st">"&lt;br/&gt; "</span>,</span>
<span id="cb6-1062"><a href="#cb6-1062" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"&lt;strong&gt; Address: &lt;/strong&gt; "</span><span class="ex">,</span> Address, <span class="st">"&lt;br/&gt; "</span><span class="kw">)</span> <span class="kw">|</span><span class="op">&gt;</span> </span>
<span id="cb6-1063"><a href="#cb6-1063" aria-hidden="true" tabindex="-1"></a>                   <span class="ex">lapply</span><span class="er">(</span><span class="ex">htmltools::HTML</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1064"><a href="#cb6-1064" aria-hidden="true" tabindex="-1"></a>                 <span class="ex">icon</span> = dc_icon<span class="kw">)</span></span>
<span id="cb6-1065"><a href="#cb6-1065" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1066"><a href="#cb6-1066" aria-hidden="true" tabindex="-1"></a>    <span class="ex">qty_data</span> <span class="op">&lt;</span>- optimal_quantities[location<span class="er">(</span><span class="kw">)</span><span class="ex">,</span> , drop = FALSE]  </span>
<span id="cb6-1067"><a href="#cb6-1067" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1068"><a href="#cb6-1068" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add routes based on the optimal quantities with different colors</span></span>
<span id="cb6-1069"><a href="#cb6-1069" aria-hidden="true" tabindex="-1"></a>    <span class="ex">route_colors</span> <span class="op">&lt;</span>- c<span class="er">(</span><span class="st">"#FF5733"</span><span class="ex">,</span> <span class="st">"#33A8FF"</span>, <span class="st">"#33FF57"</span>, <span class="st">"#D433FF"</span>, <span class="st">"#FFD133"</span><span class="kw">)</span></span>
<span id="cb6-1070"><a href="#cb6-1070" aria-hidden="true" tabindex="-1"></a>    <span class="ex">line_weights</span> <span class="op">&lt;</span>- c<span class="er">(</span><span class="ex">2,</span> 3, 4, 5, 6<span class="kw">)</span>  <span class="co"># Variable line weights based on quantity</span></span>
<span id="cb6-1071"><a href="#cb6-1071" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1072"><a href="#cb6-1072" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add routes based on the optimal quantities</span></span>
<span id="cb6-1073"><a href="#cb6-1073" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="kw">(</span><span class="ex">i</span> in seq_along<span class="er">(</span><span class="fu">location()</span><span class="kw">))</span> <span class="kw">{</span></span>
<span id="cb6-1074"><a href="#cb6-1074" aria-hidden="true" tabindex="-1"></a>      <span class="ex">wh_id</span> <span class="op">&lt;</span>- location<span class="er">(</span><span class="kw">)</span><span class="ex">[i]</span></span>
<span id="cb6-1075"><a href="#cb6-1075" aria-hidden="true" tabindex="-1"></a>      <span class="ex">wh_idx</span> <span class="op">&lt;</span>- which<span class="er">(</span><span class="ex">warehouses</span><span class="va">$ID</span> == wh_id<span class="kw">)</span></span>
<span id="cb6-1076"><a href="#cb6-1076" aria-hidden="true" tabindex="-1"></a>      <span class="ex">color_idx</span> <span class="op">&lt;</span>- <span class="er">(</span><span class="ex">wh_id</span> <span class="at">-</span> 1<span class="kw">)</span> <span class="ex">%%</span> length<span class="er">(</span><span class="ex">route_colors</span><span class="kw">)</span> <span class="ex">+</span> 1</span>
<span id="cb6-1077"><a href="#cb6-1077" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-1078"><a href="#cb6-1078" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="kw">(</span><span class="ex">j</span> in 1:ncol<span class="er">(</span><span class="ex">qty_data</span><span class="kw">))</span> <span class="kw">{</span></span>
<span id="cb6-1079"><a href="#cb6-1079" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">(</span><span class="va">qty_data</span><span class="op">[</span>i, j<span class="op">]</span> <span class="op">&gt;</span> 0<span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb6-1080"><a href="#cb6-1080" aria-hidden="true" tabindex="-1"></a>          <span class="ex">route_start</span> <span class="op">&lt;</span>- warehouses[warehouses<span class="va">$ID</span> == wh_id, c<span class="er">(</span><span class="st">"Longitude"</span><span class="ex">,</span> <span class="st">"Latitude"</span><span class="kw">)</span><span class="ex">]</span></span>
<span id="cb6-1081"><a href="#cb6-1081" aria-hidden="true" tabindex="-1"></a>          <span class="ex">route_end</span> <span class="op">&lt;</span>- distribution_centers[distribution_centers<span class="va">$ID</span> == j, c<span class="er">(</span><span class="st">"Longitude"</span><span class="ex">,</span> <span class="st">"Latitude"</span><span class="kw">)</span><span class="ex">]</span></span>
<span id="cb6-1082"><a href="#cb6-1082" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-1083"><a href="#cb6-1083" aria-hidden="true" tabindex="-1"></a>          <span class="co"># Calculate line weight based on quantity (normalized)</span></span>
<span id="cb6-1084"><a href="#cb6-1084" aria-hidden="true" tabindex="-1"></a>          <span class="ex">weight_multiplier</span> <span class="op">&lt;</span>- qty_data[i, j] / max<span class="er">(</span><span class="ex">optimal_quantities</span><span class="kw">)</span> <span class="ex">*</span> 5</span>
<span id="cb6-1085"><a href="#cb6-1085" aria-hidden="true" tabindex="-1"></a>          <span class="ex">weight</span> <span class="op">&lt;</span>- max<span class="er">(</span><span class="ex">2,</span> min<span class="er">(</span><span class="ex">6,</span> weight_multiplier + 2<span class="kw">))</span>  <span class="co"># Scale between 2-6</span></span>
<span id="cb6-1086"><a href="#cb6-1086" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb6-1087"><a href="#cb6-1087" aria-hidden="true" tabindex="-1"></a>          <span class="ex">map</span> <span class="op">&lt;</span>- map <span class="kw">|</span><span class="op">&gt;</span></span>
<span id="cb6-1088"><a href="#cb6-1088" aria-hidden="true" tabindex="-1"></a>            <span class="ex">addPolylines</span><span class="er">(</span></span>
<span id="cb6-1089"><a href="#cb6-1089" aria-hidden="true" tabindex="-1"></a>              <span class="ex">lat</span> = c<span class="er">(</span><span class="ex">route_start</span><span class="va">$Latitude</span><span class="ex">,</span> route_end<span class="va">$Latitude</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1090"><a href="#cb6-1090" aria-hidden="true" tabindex="-1"></a>              <span class="ex">lng</span> = c<span class="er">(</span><span class="ex">route_start</span><span class="va">$Longitude</span><span class="ex">,</span> route_end<span class="va">$Longitude</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1091"><a href="#cb6-1091" aria-hidden="true" tabindex="-1"></a>              <span class="ex">color</span> = route_colors<span class="pp">[</span><span class="ss">color_idx</span><span class="pp">]</span>,</span>
<span id="cb6-1092"><a href="#cb6-1092" aria-hidden="true" tabindex="-1"></a>              <span class="ex">weight</span> = weight,</span>
<span id="cb6-1093"><a href="#cb6-1093" aria-hidden="true" tabindex="-1"></a>              <span class="ex">opacity</span> = 0.7,</span>
<span id="cb6-1094"><a href="#cb6-1094" aria-hidden="true" tabindex="-1"></a>              <span class="ex">label</span> = paste0<span class="er">(</span><span class="st">"Quantity: "</span><span class="ex">,</span> round<span class="er">(</span><span class="va">qty_data</span><span class="op">[</span>i, j<span class="op">]</span><span class="ex">,</span> 2<span class="kw">))</span><span class="ex">,</span></span>
<span id="cb6-1095"><a href="#cb6-1095" aria-hidden="true" tabindex="-1"></a>              <span class="ex">dashArray</span> = <span class="st">"5, 5"</span>,</span>
<span id="cb6-1096"><a href="#cb6-1096" aria-hidden="true" tabindex="-1"></a>              <span class="ex">popup</span> = paste0<span class="er">(</span></span>
<span id="cb6-1097"><a href="#cb6-1097" aria-hidden="true" tabindex="-1"></a>                <span class="st">"&lt;strong&gt;From:&lt;/strong&gt; Warehouse "</span><span class="ex">,</span> wh_id,</span>
<span id="cb6-1098"><a href="#cb6-1098" aria-hidden="true" tabindex="-1"></a>                <span class="st">"&lt;br&gt;&lt;strong&gt;To:&lt;/strong&gt; Distribution Center "</span><span class="ex">,</span> j,</span>
<span id="cb6-1099"><a href="#cb6-1099" aria-hidden="true" tabindex="-1"></a>                <span class="st">"&lt;br&gt;&lt;strong&gt;Quantity:&lt;/strong&gt; "</span><span class="ex">,</span> round<span class="er">(</span><span class="va">qty_data</span><span class="op">[</span>i, j<span class="op">]</span><span class="ex">,</span> 2<span class="kw">)</span></span>
<span id="cb6-1100"><a href="#cb6-1100" aria-hidden="true" tabindex="-1"></a>              <span class="kw">)</span></span>
<span id="cb6-1101"><a href="#cb6-1101" aria-hidden="true" tabindex="-1"></a>            <span class="kw">)</span></span>
<span id="cb6-1102"><a href="#cb6-1102" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb6-1103"><a href="#cb6-1103" aria-hidden="true" tabindex="-1"></a>      <span class="kw">}</span></span>
<span id="cb6-1104"><a href="#cb6-1104" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb6-1105"><a href="#cb6-1105" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1106"><a href="#cb6-1106" aria-hidden="true" tabindex="-1"></a>    <span class="ex">map</span>  <span class="co"># Return the modified map</span></span>
<span id="cb6-1107"><a href="#cb6-1107" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb6-1108"><a href="#cb6-1108" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-1109"><a href="#cb6-1109" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Render the cost table</span></span>
<span id="cb6-1110"><a href="#cb6-1110" aria-hidden="true" tabindex="-1"></a>  <span class="ex">output</span><span class="va">$cost_table</span> <span class="op">&lt;</span>- renderDT<span class="er">(</span><span class="kw">{</span></span>
<span id="cb6-1111"><a href="#cb6-1111" aria-hidden="true" tabindex="-1"></a>    <span class="ex">req</span><span class="er">(</span><span class="fu">location()</span><span class="kw">)</span></span>
<span id="cb6-1112"><a href="#cb6-1112" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1113"><a href="#cb6-1113" aria-hidden="true" tabindex="-1"></a>    <span class="ex">cost_data</span> <span class="op">&lt;</span>- result <span class="kw">|</span><span class="op">&gt;</span> </span>
<span id="cb6-1114"><a href="#cb6-1114" aria-hidden="true" tabindex="-1"></a>      <span class="ex">filter</span><span class="er">(</span><span class="ex">Warehouse</span> %in% paste<span class="er">(</span><span class="st">"WH"</span><span class="ex">,</span> location<span class="er">(</span><span class="kw">)))</span> <span class="kw">|</span><span class="op">&gt;</span> </span>
<span id="cb6-1115"><a href="#cb6-1115" aria-hidden="true" tabindex="-1"></a>      <span class="cf">select</span><span class="kw">(</span><span class="ex">c</span><span class="er">(</span><span class="ex">Warehouse,</span> DC, Loading_Cost, Transport_cost<span class="kw">))</span></span>
<span id="cb6-1116"><a href="#cb6-1116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1117"><a href="#cb6-1117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a Total Cost column</span></span>
<span id="cb6-1118"><a href="#cb6-1118" aria-hidden="true" tabindex="-1"></a>    <span class="ex">cost_data</span><span class="va">$Total_Cost</span> <span class="op">&lt;</span>- cost_data<span class="va">$Loading_Cost</span> + cost_data<span class="va">$Transport_cost</span></span>
<span id="cb6-1119"><a href="#cb6-1119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1120"><a href="#cb6-1120" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Format currency values</span></span>
<span id="cb6-1121"><a href="#cb6-1121" aria-hidden="true" tabindex="-1"></a>    <span class="ex">cost_data</span><span class="va">$Loading_Cost</span> <span class="op">&lt;</span>- formatC<span class="er">(</span><span class="ex">cost_data</span><span class="va">$Loading_Cost</span><span class="ex">,</span> format=<span class="st">"f"</span>, digits=0, big.mark=<span class="st">","</span><span class="kw">)</span></span>
<span id="cb6-1122"><a href="#cb6-1122" aria-hidden="true" tabindex="-1"></a>    <span class="ex">cost_data</span><span class="va">$Transport_cost</span> <span class="op">&lt;</span>- formatC<span class="er">(</span><span class="ex">cost_data</span><span class="va">$Transport_cost</span><span class="ex">,</span> format=<span class="st">"f"</span>, digits=0, big.mark=<span class="st">","</span><span class="kw">)</span></span>
<span id="cb6-1123"><a href="#cb6-1123" aria-hidden="true" tabindex="-1"></a>    <span class="ex">cost_data</span><span class="va">$Total_Cost</span> <span class="op">&lt;</span>- formatC<span class="er">(</span><span class="ex">cost_data</span><span class="va">$Total_Cost</span><span class="ex">,</span> format=<span class="st">"f"</span>, digits=0, big.mark=<span class="st">","</span><span class="kw">)</span></span>
<span id="cb6-1124"><a href="#cb6-1124" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1125"><a href="#cb6-1125" aria-hidden="true" tabindex="-1"></a>    <span class="ex">datatable</span><span class="er">(</span><span class="ex">cost_data,</span></span>
<span id="cb6-1126"><a href="#cb6-1126" aria-hidden="true" tabindex="-1"></a>              <span class="ex">options</span> = list<span class="er">(</span></span>
<span id="cb6-1127"><a href="#cb6-1127" aria-hidden="true" tabindex="-1"></a>                <span class="ex">pageLength</span> = 10,</span>
<span id="cb6-1128"><a href="#cb6-1128" aria-hidden="true" tabindex="-1"></a>                <span class="ex">dom</span> = <span class="st">'Bfrtip'</span>,</span>
<span id="cb6-1129"><a href="#cb6-1129" aria-hidden="true" tabindex="-1"></a>                <span class="ex">buttons</span> = c<span class="er">(</span><span class="st">'copy'</span><span class="ex">,</span> <span class="st">'csv'</span>, <span class="st">'excel'</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1130"><a href="#cb6-1130" aria-hidden="true" tabindex="-1"></a>                <span class="ex">initComplete</span> = JS<span class="er">(</span></span>
<span id="cb6-1131"><a href="#cb6-1131" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"function(settings, json) {"</span><span class="ex">,</span></span>
<span id="cb6-1132"><a href="#cb6-1132" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"</span><span class="va">$(</span><span class="fu">this.api().table().header()</span><span class="va">)</span><span class="st">.css({'background-color': '#3b5998', 'color': 'white'});"</span><span class="ex">,</span></span>
<span id="cb6-1133"><a href="#cb6-1133" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"}"</span></span>
<span id="cb6-1134"><a href="#cb6-1134" aria-hidden="true" tabindex="-1"></a>                <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1135"><a href="#cb6-1135" aria-hidden="true" tabindex="-1"></a>                <span class="ex">columnDefs</span> = list<span class="er">(</span></span>
<span id="cb6-1136"><a href="#cb6-1136" aria-hidden="true" tabindex="-1"></a>                  <span class="ex">list</span><span class="er">(</span><span class="ex">className</span> = <span class="st">'dt-center'</span>, targets = <span class="st">"_all"</span><span class="kw">)</span></span>
<span id="cb6-1137"><a href="#cb6-1137" aria-hidden="true" tabindex="-1"></a>                <span class="kw">)</span></span>
<span id="cb6-1138"><a href="#cb6-1138" aria-hidden="true" tabindex="-1"></a>              <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1139"><a href="#cb6-1139" aria-hidden="true" tabindex="-1"></a>              <span class="ex">rownames</span> = FALSE,</span>
<span id="cb6-1140"><a href="#cb6-1140" aria-hidden="true" tabindex="-1"></a>              <span class="ex">class</span> = <span class="st">'compact stripe hover'</span><span class="kw">)</span> <span class="kw">|</span><span class="op">&gt;</span></span>
<span id="cb6-1141"><a href="#cb6-1141" aria-hidden="true" tabindex="-1"></a>      <span class="ex">formatStyle</span><span class="er">(</span></span>
<span id="cb6-1142"><a href="#cb6-1142" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Warehouse'</span><span class="ex">,</span></span>
<span id="cb6-1143"><a href="#cb6-1143" aria-hidden="true" tabindex="-1"></a>        <span class="ex">backgroundColor</span> = styleEqual<span class="er">(</span></span>
<span id="cb6-1144"><a href="#cb6-1144" aria-hidden="true" tabindex="-1"></a>          <span class="fu">paste</span><span class="er">(</span><span class="st">"WH"</span><span class="ex">,</span> 1:5<span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb6-1145"><a href="#cb6-1145" aria-hidden="true" tabindex="-1"></a>          <span class="ex">c</span><span class="er">(</span><span class="st">'#FFC3A0'</span><span class="ex">,</span> <span class="st">'#A0D2FF'</span>, <span class="st">'#C8FFB0'</span>, <span class="st">'#D5A0FF'</span>, <span class="st">'#FFF0A0'</span><span class="kw">)</span></span>
<span id="cb6-1146"><a href="#cb6-1146" aria-hidden="true" tabindex="-1"></a>        <span class="kw">)</span></span>
<span id="cb6-1147"><a href="#cb6-1147" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span> <span class="kw">|</span><span class="op">&gt;</span></span>
<span id="cb6-1148"><a href="#cb6-1148" aria-hidden="true" tabindex="-1"></a>      <span class="ex">formatStyle</span><span class="er">(</span></span>
<span id="cb6-1149"><a href="#cb6-1149" aria-hidden="true" tabindex="-1"></a>        <span class="st">'DC'</span><span class="ex">,</span></span>
<span id="cb6-1150"><a href="#cb6-1150" aria-hidden="true" tabindex="-1"></a>        <span class="ex">backgroundColor</span> = styleEqual<span class="er">(</span></span>
<span id="cb6-1151"><a href="#cb6-1151" aria-hidden="true" tabindex="-1"></a>          <span class="ex">c</span><span class="er">(</span><span class="st">"DC 1"</span><span class="ex">,</span> <span class="st">"DC 2"</span>, <span class="st">"DC 3"</span><span class="kw">)</span><span class="ex">,</span> </span>
<span id="cb6-1152"><a href="#cb6-1152" aria-hidden="true" tabindex="-1"></a>          <span class="ex">c</span><span class="er">(</span><span class="st">'#FFDDC3'</span><span class="ex">,</span> <span class="st">'#C3E5FF'</span>, <span class="st">'#DDFFC3'</span><span class="kw">)</span></span>
<span id="cb6-1153"><a href="#cb6-1153" aria-hidden="true" tabindex="-1"></a>        <span class="kw">)</span></span>
<span id="cb6-1154"><a href="#cb6-1154" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span></span>
<span id="cb6-1155"><a href="#cb6-1155" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb6-1156"><a href="#cb6-1156" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-1157"><a href="#cb6-1157" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-1158"><a href="#cb6-1158" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create and render the Sankey diagram</span></span>
<span id="cb6-1159"><a href="#cb6-1159" aria-hidden="true" tabindex="-1"></a>  <span class="ex">selected_indices</span> <span class="op">&lt;</span>- reactive<span class="er">(</span><span class="kw">{</span></span>
<span id="cb6-1160"><a href="#cb6-1160" aria-hidden="true" tabindex="-1"></a>    <span class="ex">as.numeric</span><span class="er">(</span><span class="ex">sub</span><span class="er">(</span><span class="st">"Warehouse "</span><span class="ex">,</span> <span class="st">""</span>, input<span class="va">$warehouse</span><span class="kw">))</span></span>
<span id="cb6-1161"><a href="#cb6-1161" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb6-1162"><a href="#cb6-1162" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-1163"><a href="#cb6-1163" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data based on selected warehouses</span></span>
<span id="cb6-1164"><a href="#cb6-1164" aria-hidden="true" tabindex="-1"></a>  <span class="ex">filtered_data</span> <span class="op">&lt;</span>- reactive<span class="er">(</span><span class="kw">{</span></span>
<span id="cb6-1165"><a href="#cb6-1165" aria-hidden="true" tabindex="-1"></a>    <span class="ex">result</span> <span class="kw">|</span><span class="op">&gt;</span></span>
<span id="cb6-1166"><a href="#cb6-1166" aria-hidden="true" tabindex="-1"></a>      <span class="ex">filter</span><span class="er">(</span><span class="ex">Warehouse</span> %in% paste<span class="er">(</span><span class="st">"WH"</span><span class="ex">,input</span><span class="va">$warehouse</span><span class="kw">))</span></span>
<span id="cb6-1167"><a href="#cb6-1167" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb6-1168"><a href="#cb6-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1169"><a href="#cb6-1169" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create and render the Sankey diagram</span></span>
<span id="cb6-1170"><a href="#cb6-1170" aria-hidden="true" tabindex="-1"></a>  <span class="ex">output</span><span class="va">$sankey_diagram</span> <span class="op">&lt;</span>- renderUI<span class="er">(</span><span class="kw">{</span></span>
<span id="cb6-1171"><a href="#cb6-1171" aria-hidden="true" tabindex="-1"></a>    <span class="ex">req</span><span class="er">(</span><span class="ex">length</span><span class="er">(</span><span class="fu">selected_indices()</span><span class="kw">)</span> <span class="op">&gt;</span> 0<span class="kw">)</span></span>
<span id="cb6-1172"><a href="#cb6-1172" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1173"><a href="#cb6-1173" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create links data frame</span></span>
<span id="cb6-1174"><a href="#cb6-1174" aria-hidden="true" tabindex="-1"></a>    <span class="ex">links</span> <span class="op">&lt;</span>- data.frame<span class="er">(</span><span class="kw">)</span></span>
<span id="cb6-1175"><a href="#cb6-1175" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1176"><a href="#cb6-1176" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add links for each selected warehouse</span></span>
<span id="cb6-1177"><a href="#cb6-1177" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="kw">(</span><span class="ex">i</span> in 1:length<span class="er">(</span><span class="fu">selected_indices()</span><span class="kw">))</span> <span class="kw">{</span></span>
<span id="cb6-1178"><a href="#cb6-1178" aria-hidden="true" tabindex="-1"></a>      <span class="ex">wh_idx</span> <span class="op">&lt;</span>- selected_indices<span class="er">(</span><span class="kw">)</span><span class="ex">[i]</span></span>
<span id="cb6-1179"><a href="#cb6-1179" aria-hidden="true" tabindex="-1"></a>      <span class="ex">wh_data</span> <span class="op">&lt;</span>- optimal_quantities[wh_idx, , drop = FALSE]</span>
<span id="cb6-1180"><a href="#cb6-1180" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb6-1181"><a href="#cb6-1181" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add links for each DC</span></span>
<span id="cb6-1182"><a href="#cb6-1182" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="kw">(</span><span class="ex">j</span> in 1:ncol<span class="er">(</span><span class="ex">wh_data</span><span class="kw">))</span> <span class="kw">{</span></span>
<span id="cb6-1183"><a href="#cb6-1183" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">(</span><span class="va">wh_data</span><span class="op">[</span><span class="dv">1</span>, j<span class="op">]</span> <span class="op">&gt;</span> 0<span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb6-1184"><a href="#cb6-1184" aria-hidden="true" tabindex="-1"></a>          <span class="ex">links</span> <span class="op">&lt;</span>- rbind<span class="er">(</span><span class="ex">links,</span> data.frame<span class="er">(</span></span>
<span id="cb6-1185"><a href="#cb6-1185" aria-hidden="true" tabindex="-1"></a>            <span class="bu">source</span> = i <span class="at">-</span> 1,  <span class="co"># Use index in selected warehouses (0-based)</span></span>
<span id="cb6-1186"><a href="#cb6-1186" aria-hidden="true" tabindex="-1"></a>            <span class="ex">target</span> = length<span class="er">(</span><span class="fu">selected_indices()</span><span class="kw">)</span> <span class="ex">+</span> j <span class="at">-</span> 1,  <span class="co"># DCs come after warehouses</span></span>
<span id="cb6-1187"><a href="#cb6-1187" aria-hidden="true" tabindex="-1"></a>            <span class="ex">value</span> = wh_data[1, j]</span>
<span id="cb6-1188"><a href="#cb6-1188" aria-hidden="true" tabindex="-1"></a>          <span class="kw">))</span></span>
<span id="cb6-1189"><a href="#cb6-1189" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb6-1190"><a href="#cb6-1190" aria-hidden="true" tabindex="-1"></a>      <span class="kw">}</span></span>
<span id="cb6-1191"><a href="#cb6-1191" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb6-1192"><a href="#cb6-1192" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1193"><a href="#cb6-1193" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only proceed if we have links</span></span>
<span id="cb6-1194"><a href="#cb6-1194" aria-hidden="true" tabindex="-1"></a>    <span class="ex">req</span><span class="er">(</span><span class="ex">nrow</span><span class="er">(</span><span class="ex">links</span><span class="kw">)</span> <span class="op">&gt;</span> 0<span class="kw">)</span></span>
<span id="cb6-1195"><a href="#cb6-1195" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1196"><a href="#cb6-1196" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create nodes data frame</span></span>
<span id="cb6-1197"><a href="#cb6-1197" aria-hidden="true" tabindex="-1"></a>    <span class="ex">nodes</span> <span class="op">&lt;</span>- data.frame<span class="er">(</span></span>
<span id="cb6-1198"><a href="#cb6-1198" aria-hidden="true" tabindex="-1"></a>      <span class="ex">name</span> = c<span class="er">(</span><span class="fu">paste</span><span class="er">(</span><span class="st">"Warehouse"</span><span class="ex">,</span> selected_indices<span class="er">(</span><span class="kw">))</span><span class="ex">,</span> paste<span class="er">(</span><span class="st">"DC"</span><span class="ex">,</span> 1:3<span class="kw">))</span></span>
<span id="cb6-1199"><a href="#cb6-1199" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span></span>
<span id="cb6-1200"><a href="#cb6-1200" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1201"><a href="#cb6-1201" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the Sankey network</span></span>
<span id="cb6-1202"><a href="#cb6-1202" aria-hidden="true" tabindex="-1"></a>    <span class="ex">sankey</span> <span class="op">&lt;</span>- sankeyNetwork<span class="er">(</span></span>
<span id="cb6-1203"><a href="#cb6-1203" aria-hidden="true" tabindex="-1"></a>      <span class="ex">Links</span> = links, </span>
<span id="cb6-1204"><a href="#cb6-1204" aria-hidden="true" tabindex="-1"></a>      <span class="ex">Nodes</span> = nodes, </span>
<span id="cb6-1205"><a href="#cb6-1205" aria-hidden="true" tabindex="-1"></a>      <span class="ex">Source</span> = <span class="st">"source"</span>, </span>
<span id="cb6-1206"><a href="#cb6-1206" aria-hidden="true" tabindex="-1"></a>      <span class="ex">Target</span> = <span class="st">"target"</span>, </span>
<span id="cb6-1207"><a href="#cb6-1207" aria-hidden="true" tabindex="-1"></a>      <span class="ex">Value</span> = <span class="st">"value"</span>,</span>
<span id="cb6-1208"><a href="#cb6-1208" aria-hidden="true" tabindex="-1"></a>      <span class="ex">NodeID</span> = <span class="st">"name"</span>,</span>
<span id="cb6-1209"><a href="#cb6-1209" aria-hidden="true" tabindex="-1"></a>      <span class="ex">height</span> = 500,  </span>
<span id="cb6-1210"><a href="#cb6-1210" aria-hidden="true" tabindex="-1"></a>      <span class="ex">width</span> = 800,</span>
<span id="cb6-1211"><a href="#cb6-1211" aria-hidden="true" tabindex="-1"></a>      <span class="ex">fontSize</span> = 12,</span>
<span id="cb6-1212"><a href="#cb6-1212" aria-hidden="true" tabindex="-1"></a>      <span class="ex">nodeWidth</span> = 20,</span>
<span id="cb6-1213"><a href="#cb6-1213" aria-hidden="true" tabindex="-1"></a>      <span class="ex">sinksRight</span> = TRUE</span>
<span id="cb6-1214"><a href="#cb6-1214" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span></span>
<span id="cb6-1215"><a href="#cb6-1215" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1216"><a href="#cb6-1216" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Customize tooltips and add click functionality to show a value panel</span></span>
<span id="cb6-1217"><a href="#cb6-1217" aria-hidden="true" tabindex="-1"></a>    <span class="ex">sankey</span> <span class="op">&lt;</span>- htmlwidgets::onRender<span class="er">(</span><span class="ex">sankey,</span> <span class="st">"</span></span>
<span id="cb6-1218"><a href="#cb6-1218" aria-hidden="true" tabindex="-1"></a><span class="st">    function(el, x) {</span></span>
<span id="cb6-1219"><a href="#cb6-1219" aria-hidden="true" tabindex="-1"></a><span class="st">      // Create a div for the value panel</span></span>
<span id="cb6-1220"><a href="#cb6-1220" aria-hidden="true" tabindex="-1"></a><span class="st">      var valuePanel = d3.select('body').append('div')</span></span>
<span id="cb6-1221"><a href="#cb6-1221" aria-hidden="true" tabindex="-1"></a><span class="st">        .attr('class', 'value-panel')</span></span>
<span id="cb6-1222"><a href="#cb6-1222" aria-hidden="true" tabindex="-1"></a><span class="st">        .style('position', 'absolute')</span></span>
<span id="cb6-1223"><a href="#cb6-1223" aria-hidden="true" tabindex="-1"></a><span class="st">        .style('padding', '8px')</span></span>
<span id="cb6-1224"><a href="#cb6-1224" aria-hidden="true" tabindex="-1"></a><span class="st">        .style('background', 'lightgray')</span></span>
<span id="cb6-1225"><a href="#cb6-1225" aria-hidden="true" tabindex="-1"></a><span class="st">        .style('border', '1px solid gray')</span></span>
<span id="cb6-1226"><a href="#cb6-1226" aria-hidden="true" tabindex="-1"></a><span class="st">        .style('border-radius', '4px')</span></span>
<span id="cb6-1227"><a href="#cb6-1227" aria-hidden="true" tabindex="-1"></a><span class="st">        .style('opacity', 0);  // Start hidden</span></span>
<span id="cb6-1228"><a href="#cb6-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1229"><a href="#cb6-1229" aria-hidden="true" tabindex="-1"></a><span class="st">      // Append title for tooltips on hover</span></span>
<span id="cb6-1230"><a href="#cb6-1230" aria-hidden="true" tabindex="-1"></a><span class="st">      d3.selectAll('.link')</span></span>
<span id="cb6-1231"><a href="#cb6-1231" aria-hidden="true" tabindex="-1"></a><span class="st">        .append('title')</span></span>
<span id="cb6-1232"><a href="#cb6-1232" aria-hidden="true" tabindex="-1"></a><span class="st">        .text(function(d) { return 'Quantity: ' + d.value.toFixed(2); });  // Show value on hover</span></span>
<span id="cb6-1233"><a href="#cb6-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1234"><a href="#cb6-1234" aria-hidden="true" tabindex="-1"></a><span class="st">      // Add click event to show the value panel</span></span>
<span id="cb6-1235"><a href="#cb6-1235" aria-hidden="true" tabindex="-1"></a><span class="st">      d3.selectAll('.link')</span></span>
<span id="cb6-1236"><a href="#cb6-1236" aria-hidden="true" tabindex="-1"></a><span class="st">        .on('click', function(event, d) {</span></span>
<span id="cb6-1237"><a href="#cb6-1237" aria-hidden="true" tabindex="-1"></a><span class="st">          // Ensure we get the correct value</span></span>
<span id="cb6-1238"><a href="#cb6-1238" aria-hidden="true" tabindex="-1"></a><span class="st">          var value = d3.select(this).datum().value;</span></span>
<span id="cb6-1239"><a href="#cb6-1239" aria-hidden="true" tabindex="-1"></a><span class="st">          var source = nodes.name[d.source.index];</span></span>
<span id="cb6-1240"><a href="#cb6-1240" aria-hidden="true" tabindex="-1"></a><span class="st">          var target = nodes.name[d.target.index];</span></span>
<span id="cb6-1241"><a href="#cb6-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1242"><a href="#cb6-1242" aria-hidden="true" tabindex="-1"></a><span class="st">          // Position the value panel near the mouse cursor</span></span>
<span id="cb6-1243"><a href="#cb6-1243" aria-hidden="true" tabindex="-1"></a><span class="st">          valuePanel</span></span>
<span id="cb6-1244"><a href="#cb6-1244" aria-hidden="true" tabindex="-1"></a><span class="st">            .style('left', (event.pageX + 5) + 'px')</span></span>
<span id="cb6-1245"><a href="#cb6-1245" aria-hidden="true" tabindex="-1"></a><span class="st">            .style('top', (event.pageY + 5) + 'px')</span></span>
<span id="cb6-1246"><a href="#cb6-1246" aria-hidden="true" tabindex="-1"></a><span class="st">            .style('opacity', 1)  // Make it visible</span></span>
<span id="cb6-1247"><a href="#cb6-1247" aria-hidden="true" tabindex="-1"></a><span class="st">            .html('From: ' + source + '&lt;br&gt;To: ' + target + '&lt;br&gt;Quantity: ' + value.toFixed(2));  // Set the text with details</span></span>
<span id="cb6-1248"><a href="#cb6-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1249"><a href="#cb6-1249" aria-hidden="true" tabindex="-1"></a><span class="st">          // Hide the panel after a delay</span></span>
<span id="cb6-1250"><a href="#cb6-1250" aria-hidden="true" tabindex="-1"></a><span class="st">          setTimeout(function() {</span></span>
<span id="cb6-1251"><a href="#cb6-1251" aria-hidden="true" tabindex="-1"></a><span class="st">            valuePanel.style('opacity', 0);</span></span>
<span id="cb6-1252"><a href="#cb6-1252" aria-hidden="true" tabindex="-1"></a><span class="st">          }, 3000);  // Change the delay as needed</span></span>
<span id="cb6-1253"><a href="#cb6-1253" aria-hidden="true" tabindex="-1"></a><span class="st">        });</span></span>
<span id="cb6-1254"><a href="#cb6-1254" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb6-1255"><a href="#cb6-1255" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span><span class="kw">)</span></span>
<span id="cb6-1256"><a href="#cb6-1256" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1257"><a href="#cb6-1257" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add title and caption</span></span>
<span id="cb6-1258"><a href="#cb6-1258" aria-hidden="true" tabindex="-1"></a>    <span class="ex">tagList</span><span class="er">(</span></span>
<span id="cb6-1259"><a href="#cb6-1259" aria-hidden="true" tabindex="-1"></a>      <span class="ex">sankey,</span></span>
<span id="cb6-1260"><a href="#cb6-1260" aria-hidden="true" tabindex="-1"></a>      <span class="ex">tags</span><span class="va">$p</span><span class="er">(</span><span class="ex">style</span> = <span class="st">"font-size: 12px; text-align: right;"</span>, </span>
<span id="cb6-1261"><a href="#cb6-1261" aria-hidden="true" tabindex="-1"></a>             <span class="st">"A wider arrow indicates that a larger quantity is being sent from that warehouse to a distribution center."</span><span class="kw">)</span></span>
<span id="cb6-1262"><a href="#cb6-1262" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span></span>
<span id="cb6-1263"><a href="#cb6-1263" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb6-1264"><a href="#cb6-1264" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-1265"><a href="#cb6-1265" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a summary statistics output at the bottom of the map tab</span></span>
<span id="cb6-1266"><a href="#cb6-1266" aria-hidden="true" tabindex="-1"></a>  <span class="ex">output</span><span class="va">$summary_stats</span> <span class="op">&lt;</span>- renderUI<span class="er">(</span><span class="kw">{</span></span>
<span id="cb6-1267"><a href="#cb6-1267" aria-hidden="true" tabindex="-1"></a>    <span class="ex">req</span><span class="er">(</span><span class="fu">location()</span><span class="kw">)</span></span>
<span id="cb6-1268"><a href="#cb6-1268" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1269"><a href="#cb6-1269" aria-hidden="true" tabindex="-1"></a>    <span class="ex">selected_data</span> <span class="op">&lt;</span>- result <span class="kw">|</span><span class="op">&gt;</span> </span>
<span id="cb6-1270"><a href="#cb6-1270" aria-hidden="true" tabindex="-1"></a>      <span class="ex">filter</span><span class="er">(</span><span class="ex">Warehouse</span> %in% paste<span class="er">(</span><span class="st">"WH"</span><span class="ex">,</span> location<span class="er">(</span><span class="kw">)))</span></span>
<span id="cb6-1271"><a href="#cb6-1271" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1272"><a href="#cb6-1272" aria-hidden="true" tabindex="-1"></a>    <span class="ex">total_loading</span> <span class="op">&lt;</span>- sum<span class="er">(</span><span class="ex">selected_data</span><span class="va">$Loading_Cost</span><span class="kw">)</span></span>
<span id="cb6-1273"><a href="#cb6-1273" aria-hidden="true" tabindex="-1"></a>    <span class="ex">total_transport</span> <span class="op">&lt;</span>- sum<span class="er">(</span><span class="ex">selected_data</span><span class="va">$Transport_cost</span><span class="kw">)</span></span>
<span id="cb6-1274"><a href="#cb6-1274" aria-hidden="true" tabindex="-1"></a>    <span class="ex">total_weight</span> <span class="op">&lt;</span>- sum<span class="er">(</span><span class="ex">selected_data</span><span class="va">$Total_Weight</span><span class="kw">)</span></span>
<span id="cb6-1275"><a href="#cb6-1275" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-1276"><a href="#cb6-1276" aria-hidden="true" tabindex="-1"></a>    <span class="ex">div</span><span class="er">(</span></span>
<span id="cb6-1277"><a href="#cb6-1277" aria-hidden="true" tabindex="-1"></a>      <span class="ex">class</span> = <span class="st">"mt-3 p-3 bg-light rounded"</span>,</span>
<span id="cb6-1278"><a href="#cb6-1278" aria-hidden="true" tabindex="-1"></a>      <span class="ex">h4</span><span class="er">(</span><span class="st">"Summary Statistics"</span><span class="ex">,</span> class = <span class="st">"text-primary mb-3"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1279"><a href="#cb6-1279" aria-hidden="true" tabindex="-1"></a>      <span class="ex">div</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"row"</span>,</span>
<span id="cb6-1280"><a href="#cb6-1280" aria-hidden="true" tabindex="-1"></a>          <span class="ex">div</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"col-md-4"</span>,</span>
<span id="cb6-1281"><a href="#cb6-1281" aria-hidden="true" tabindex="-1"></a>              <span class="ex">div</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"card text-white bg-primary mb-3"</span>,</span>
<span id="cb6-1282"><a href="#cb6-1282" aria-hidden="true" tabindex="-1"></a>                  <span class="ex">div</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"card-body"</span>,</span>
<span id="cb6-1283"><a href="#cb6-1283" aria-hidden="true" tabindex="-1"></a>                      <span class="ex">h5</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"card-title"</span>, <span class="st">"Total Weight"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1284"><a href="#cb6-1284" aria-hidden="true" tabindex="-1"></a>                      <span class="ex">h3</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"card-text"</span>, paste0<span class="er">(</span><span class="ex">round</span><span class="er">(</span><span class="ex">total_weight,</span> 2<span class="kw">)</span><span class="ex">,</span> <span class="st">" tons"</span><span class="kw">))</span></span>
<span id="cb6-1285"><a href="#cb6-1285" aria-hidden="true" tabindex="-1"></a>                  <span class="kw">)</span></span>
<span id="cb6-1286"><a href="#cb6-1286" aria-hidden="true" tabindex="-1"></a>              <span class="kw">)</span></span>
<span id="cb6-1287"><a href="#cb6-1287" aria-hidden="true" tabindex="-1"></a>          <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1288"><a href="#cb6-1288" aria-hidden="true" tabindex="-1"></a>          <span class="ex">div</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"col-md-4"</span>,</span>
<span id="cb6-1289"><a href="#cb6-1289" aria-hidden="true" tabindex="-1"></a>              <span class="ex">div</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"card text-white bg-success mb-3"</span>,</span>
<span id="cb6-1290"><a href="#cb6-1290" aria-hidden="true" tabindex="-1"></a>                  <span class="ex">div</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"card-body"</span>,</span>
<span id="cb6-1291"><a href="#cb6-1291" aria-hidden="true" tabindex="-1"></a>                      <span class="ex">h5</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"card-title"</span>, <span class="st">"Total Loading Cost"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1292"><a href="#cb6-1292" aria-hidden="true" tabindex="-1"></a>                      <span class="ex">h3</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"card-text"</span>, paste0<span class="er">(</span><span class="st">"₫"</span><span class="ex">,</span> formatC<span class="er">(</span><span class="ex">total_loading,</span> format=<span class="st">"f"</span>, digits=0, big.mark=<span class="st">","</span><span class="kw">)))</span></span>
<span id="cb6-1293"><a href="#cb6-1293" aria-hidden="true" tabindex="-1"></a>                  <span class="kw">)</span></span>
<span id="cb6-1294"><a href="#cb6-1294" aria-hidden="true" tabindex="-1"></a>              <span class="kw">)</span></span>
<span id="cb6-1295"><a href="#cb6-1295" aria-hidden="true" tabindex="-1"></a>          <span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1296"><a href="#cb6-1296" aria-hidden="true" tabindex="-1"></a>          <span class="ex">div</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"col-md-4"</span>,</span>
<span id="cb6-1297"><a href="#cb6-1297" aria-hidden="true" tabindex="-1"></a>              <span class="ex">div</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"card text-white bg-info mb-3"</span>,</span>
<span id="cb6-1298"><a href="#cb6-1298" aria-hidden="true" tabindex="-1"></a>                  <span class="ex">div</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"card-body"</span>,</span>
<span id="cb6-1299"><a href="#cb6-1299" aria-hidden="true" tabindex="-1"></a>                      <span class="ex">h5</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"card-title"</span>, <span class="st">"Total Transport Cost"</span><span class="kw">)</span><span class="ex">,</span></span>
<span id="cb6-1300"><a href="#cb6-1300" aria-hidden="true" tabindex="-1"></a>                      <span class="ex">h3</span><span class="er">(</span><span class="ex">class</span> = <span class="st">"card-text"</span>, paste0<span class="er">(</span><span class="st">"₫"</span><span class="ex">,</span> formatC<span class="er">(</span><span class="ex">total_transport,</span> format=<span class="st">"f"</span>, digits=0, big.mark=<span class="st">","</span><span class="kw">)))</span></span>
<span id="cb6-1301"><a href="#cb6-1301" aria-hidden="true" tabindex="-1"></a>                  <span class="kw">)</span></span>
<span id="cb6-1302"><a href="#cb6-1302" aria-hidden="true" tabindex="-1"></a>              <span class="kw">)</span></span>
<span id="cb6-1303"><a href="#cb6-1303" aria-hidden="true" tabindex="-1"></a>          <span class="kw">)</span></span>
<span id="cb6-1304"><a href="#cb6-1304" aria-hidden="true" tabindex="-1"></a>      <span class="kw">)</span></span>
<span id="cb6-1305"><a href="#cb6-1305" aria-hidden="true" tabindex="-1"></a>    <span class="kw">)</span></span>
<span id="cb6-1306"><a href="#cb6-1306" aria-hidden="true" tabindex="-1"></a>  <span class="kw">})</span></span>
<span id="cb6-1307"><a href="#cb6-1307" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb6-1308"><a href="#cb6-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1309"><a href="#cb6-1309" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the application </span></span>
<span id="cb6-1310"><a href="#cb6-1310" aria-hidden="true" tabindex="-1"></a><span class="ex">shinyApp</span><span class="er">(</span><span class="ex">ui</span> = ui, server = server<span class="kw">)</span></span>
<span id="cb6-1311"><a href="#cb6-1311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-1312"><a href="#cb6-1312" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb6-1313"><a href="#cb6-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1314"><a href="#cb6-1314" aria-hidden="true" tabindex="-1"></a>Bạn có thể thấy với **dashboard** như vậy, ta có thể xem được nhiều thông tin hơn như:</span>
<span id="cb6-1315"><a href="#cb6-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1316"><a href="#cb6-1316" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Vị trí cụ thể của từng *WH* và *DC* cũng như là các tuyến đường dự kiến bằng các đường thẳng minh họa. (Xem **Map tab**)</span>
<span id="cb6-1317"><a href="#cb6-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1318"><a href="#cb6-1318" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Thông tin về chi phí *Loading cost* và *Transporation cost* cũng như lượng hàng cần vận chuyển cho từng nhà kho. (Xem **Table and Sankey tab**)</span>
<span id="cb6-1319"><a href="#cb6-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1320"><a href="#cb6-1320" aria-hidden="true" tabindex="-1"></a>Bạn có thể xem cho 1 hoặc nhiều nhà kho bằng cách *click* trên thanh **Filter**. Ngoài ra, đặc biệt với **Sankey chart**, bạn cần giữ hoặc *click* chuột vào tuyến để xem được số lượng hàng.</span>
<span id="cb6-1321"><a href="#cb6-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1322"><a href="#cb6-1322" aria-hidden="true" tabindex="-1"></a>Tuy rất thích R nhưng mình vẫn không thích xây dựng dashboard bằng R lắm vì quá nặng về code và không hiệu quả về thời gian, nguồn lực. Các tools khác mình ưu tiên hơn như **Power BI**, **Tableau** hoặc các **BIs** mà công ty bạn sử dụng trong công việc hằng ngày.</span>
<span id="cb6-1323"><a href="#cb6-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1324"><a href="#cb6-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1325"><a href="#cb6-1325" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb6-1326"><a href="#cb6-1326" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;!DOCTYPE html&gt;</span></span>
<span id="cb6-1327"><a href="#cb6-1327" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;html lang="en"&gt;</span></span>
<span id="cb6-1328"><a href="#cb6-1328" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;head&gt;</span></span>
<span id="cb6-1329"><a href="#cb6-1329" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;meta charset="UTF-8"&gt;</span></span>
<span id="cb6-1330"><a href="#cb6-1330" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></span>
<span id="cb6-1331"><a href="#cb6-1331" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;title&gt;Go to Next Page&lt;/title&gt;</span></span>
<span id="cb6-1332"><a href="#cb6-1332" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;style&gt;</span></span>
<span id="cb6-1333"><a href="#cb6-1333" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Global Styles */</span></span>
<span id="cb6-1334"><a href="#cb6-1334" aria-hidden="true" tabindex="-1"></a><span class="in">        body {</span></span>
<span id="cb6-1335"><a href="#cb6-1335" aria-hidden="true" tabindex="-1"></a><span class="in">            font-family: 'Tahoma', sans-serif;</span></span>
<span id="cb6-1336"><a href="#cb6-1336" aria-hidden="true" tabindex="-1"></a><span class="in">            display: flex;</span></span>
<span id="cb6-1337"><a href="#cb6-1337" aria-hidden="true" tabindex="-1"></a><span class="in">            flex-direction: column;  /* Stack content and footnote vertically */</span></span>
<span id="cb6-1338"><a href="#cb6-1338" aria-hidden="true" tabindex="-1"></a><span class="in">            justify-content: center;  /* Center content vertically */</span></span>
<span id="cb6-1339"><a href="#cb6-1339" aria-hidden="true" tabindex="-1"></a><span class="in">            align-items: center;      /* Center content horizontally */</span></span>
<span id="cb6-1340"><a href="#cb6-1340" aria-hidden="true" tabindex="-1"></a><span class="in">            margin: 0;</span></span>
<span id="cb6-1341"><a href="#cb6-1341" aria-hidden="true" tabindex="-1"></a><span class="in">            background-color: $secondary-color;</span></span>
<span id="cb6-1342"><a href="#cb6-1342" aria-hidden="true" tabindex="-1"></a><span class="in">            box-sizing: border-box;</span></span>
<span id="cb6-1343"><a href="#cb6-1343" aria-hidden="true" tabindex="-1"></a><span class="in">            min-height: 80vh; /* Adjusted to 80vh to ensure it's not too high */</span></span>
<span id="cb6-1344"><a href="#cb6-1344" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb6-1345"><a href="#cb6-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1346"><a href="#cb6-1346" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Container Styling (Main Content) */</span></span>
<span id="cb6-1347"><a href="#cb6-1347" aria-hidden="true" tabindex="-1"></a><span class="in">        .container {</span></span>
<span id="cb6-1348"><a href="#cb6-1348" aria-hidden="true" tabindex="-1"></a><span class="in">            text-align: center;</span></span>
<span id="cb6-1349"><a href="#cb6-1349" aria-hidden="true" tabindex="-1"></a><span class="in">            padding: 20px 40px; /* Adjust padding for more compactness */</span></span>
<span id="cb6-1350"><a href="#cb6-1350" aria-hidden="true" tabindex="-1"></a><span class="in">            background-color: white;</span></span>
<span id="cb6-1351"><a href="#cb6-1351" aria-hidden="true" tabindex="-1"></a><span class="in">            border-radius: 12px;</span></span>
<span id="cb6-1352"><a href="#cb6-1352" aria-hidden="true" tabindex="-1"></a><span class="in">            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);</span></span>
<span id="cb6-1353"><a href="#cb6-1353" aria-hidden="true" tabindex="-1"></a><span class="in">            width: auto;  /* Auto width to fit content */</span></span>
<span id="cb6-1354"><a href="#cb6-1354" aria-hidden="true" tabindex="-1"></a><span class="in">            max-width: 380px;  /* Adjusted max-width for a smaller container */</span></span>
<span id="cb6-1355"><a href="#cb6-1355" aria-hidden="true" tabindex="-1"></a><span class="in">            box-sizing: border-box;</span></span>
<span id="cb6-1356"><a href="#cb6-1356" aria-hidden="true" tabindex="-1"></a><span class="in">            display: flex;</span></span>
<span id="cb6-1357"><a href="#cb6-1357" aria-hidden="true" tabindex="-1"></a><span class="in">            justify-content: center;</span></span>
<span id="cb6-1358"><a href="#cb6-1358" aria-hidden="true" tabindex="-1"></a><span class="in">            align-items: center;</span></span>
<span id="cb6-1359"><a href="#cb6-1359" aria-hidden="true" tabindex="-1"></a><span class="in">            flex-direction: column;</span></span>
<span id="cb6-1360"><a href="#cb6-1360" aria-hidden="true" tabindex="-1"></a><span class="in">            margin-top: 20px;  /* Space from the top of the page */</span></span>
<span id="cb6-1361"><a href="#cb6-1361" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb6-1362"><a href="#cb6-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1363"><a href="#cb6-1363" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Link Styling */</span></span>
<span id="cb6-1364"><a href="#cb6-1364" aria-hidden="true" tabindex="-1"></a><span class="in">        .link {</span></span>
<span id="cb6-1365"><a href="#cb6-1365" aria-hidden="true" tabindex="-1"></a><span class="in">            font-size: 20px;  /* Adjusted font size for readability */</span></span>
<span id="cb6-1366"><a href="#cb6-1366" aria-hidden="true" tabindex="-1"></a><span class="in">            color: #007bff;</span></span>
<span id="cb6-1367"><a href="#cb6-1367" aria-hidden="true" tabindex="-1"></a><span class="in">            text-decoration: none;</span></span>
<span id="cb6-1368"><a href="#cb6-1368" aria-hidden="true" tabindex="-1"></a><span class="in">            font-weight: 700;</span></span>
<span id="cb6-1369"><a href="#cb6-1369" aria-hidden="true" tabindex="-1"></a><span class="in">            display: inline-flex;</span></span>
<span id="cb6-1370"><a href="#cb6-1370" aria-hidden="true" tabindex="-1"></a><span class="in">            align-items: center;</span></span>
<span id="cb6-1371"><a href="#cb6-1371" aria-hidden="true" tabindex="-1"></a><span class="in">            cursor: pointer;</span></span>
<span id="cb6-1372"><a href="#cb6-1372" aria-hidden="true" tabindex="-1"></a><span class="in">            padding: 12px 30px;</span></span>
<span id="cb6-1373"><a href="#cb6-1373" aria-hidden="true" tabindex="-1"></a><span class="in">            border-radius: 6px;</span></span>
<span id="cb6-1374"><a href="#cb6-1374" aria-hidden="true" tabindex="-1"></a><span class="in">            transition: all 0.3s ease;</span></span>
<span id="cb6-1375"><a href="#cb6-1375" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb6-1376"><a href="#cb6-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1377"><a href="#cb6-1377" aria-hidden="true" tabindex="-1"></a><span class="in">        .link:hover {</span></span>
<span id="cb6-1378"><a href="#cb6-1378" aria-hidden="true" tabindex="-1"></a><span class="in">            color: #0056b3;</span></span>
<span id="cb6-1379"><a href="#cb6-1379" aria-hidden="true" tabindex="-1"></a><span class="in">            text-decoration: none;</span></span>
<span id="cb6-1380"><a href="#cb6-1380" aria-hidden="true" tabindex="-1"></a><span class="in">            background-color: #e6f0ff;</span></span>
<span id="cb6-1381"><a href="#cb6-1381" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb6-1382"><a href="#cb6-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1383"><a href="#cb6-1383" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Arrow Styling */</span></span>
<span id="cb6-1384"><a href="#cb6-1384" aria-hidden="true" tabindex="-1"></a><span class="in">        .arrow {</span></span>
<span id="cb6-1385"><a href="#cb6-1385" aria-hidden="true" tabindex="-1"></a><span class="in">            margin-left: 12px;</span></span>
<span id="cb6-1386"><a href="#cb6-1386" aria-hidden="true" tabindex="-1"></a><span class="in">            font-size: 24px;</span></span>
<span id="cb6-1387"><a href="#cb6-1387" aria-hidden="true" tabindex="-1"></a><span class="in">            transition: transform 0.3s ease, font-size 0.3s ease;</span></span>
<span id="cb6-1388"><a href="#cb6-1388" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb6-1389"><a href="#cb6-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1390"><a href="#cb6-1390" aria-hidden="true" tabindex="-1"></a><span class="in">        .link:hover .arrow {</span></span>
<span id="cb6-1391"><a href="#cb6-1391" aria-hidden="true" tabindex="-1"></a><span class="in">            transform: translateX(8px);</span></span>
<span id="cb6-1392"><a href="#cb6-1392" aria-hidden="true" tabindex="-1"></a><span class="in">            font-size: 26px;</span></span>
<span id="cb6-1393"><a href="#cb6-1393" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb6-1394"><a href="#cb6-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1395"><a href="#cb6-1395" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Focus State for Accessibility */</span></span>
<span id="cb6-1396"><a href="#cb6-1396" aria-hidden="true" tabindex="-1"></a><span class="in">        .link:focus {</span></span>
<span id="cb6-1397"><a href="#cb6-1397" aria-hidden="true" tabindex="-1"></a><span class="in">            outline: 2px solid #0056b3;</span></span>
<span id="cb6-1398"><a href="#cb6-1398" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb6-1399"><a href="#cb6-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1400"><a href="#cb6-1400" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Footer Styling (Footnote) */</span></span>
<span id="cb6-1401"><a href="#cb6-1401" aria-hidden="true" tabindex="-1"></a><span class="in">        .footer {</span></span>
<span id="cb6-1402"><a href="#cb6-1402" aria-hidden="true" tabindex="-1"></a><span class="in">            font-size: 14px;</span></span>
<span id="cb6-1403"><a href="#cb6-1403" aria-hidden="true" tabindex="-1"></a><span class="in">            color: #777;</span></span>
<span id="cb6-1404"><a href="#cb6-1404" aria-hidden="true" tabindex="-1"></a><span class="in">            margin-top: 20px;  /* Space between content and footnote */</span></span>
<span id="cb6-1405"><a href="#cb6-1405" aria-hidden="true" tabindex="-1"></a><span class="in">            text-align: center;</span></span>
<span id="cb6-1406"><a href="#cb6-1406" aria-hidden="true" tabindex="-1"></a><span class="in">            width: 100%;</span></span>
<span id="cb6-1407"><a href="#cb6-1407" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb6-1408"><a href="#cb6-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1409"><a href="#cb6-1409" aria-hidden="true" tabindex="-1"></a><span class="in">        /* Mobile-Friendly Adjustments */</span></span>
<span id="cb6-1410"><a href="#cb6-1410" aria-hidden="true" tabindex="-1"></a><span class="in">        @media (max-width: 600px) {</span></span>
<span id="cb6-1411"><a href="#cb6-1411" aria-hidden="true" tabindex="-1"></a><span class="in">            .link {</span></span>
<span id="cb6-1412"><a href="#cb6-1412" aria-hidden="true" tabindex="-1"></a><span class="in">                font-size: 18px;</span></span>
<span id="cb6-1413"><a href="#cb6-1413" aria-hidden="true" tabindex="-1"></a><span class="in">                padding: 8px 15px;  /* Smaller padding for mobile devices */</span></span>
<span id="cb6-1414"><a href="#cb6-1414" aria-hidden="true" tabindex="-1"></a><span class="in">            }</span></span>
<span id="cb6-1415"><a href="#cb6-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1416"><a href="#cb6-1416" aria-hidden="true" tabindex="-1"></a><span class="in">            .arrow {</span></span>
<span id="cb6-1417"><a href="#cb6-1417" aria-hidden="true" tabindex="-1"></a><span class="in">                font-size: 18px;</span></span>
<span id="cb6-1418"><a href="#cb6-1418" aria-hidden="true" tabindex="-1"></a><span class="in">                margin-left: 8px;</span></span>
<span id="cb6-1419"><a href="#cb6-1419" aria-hidden="true" tabindex="-1"></a><span class="in">            }</span></span>
<span id="cb6-1420"><a href="#cb6-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-1421"><a href="#cb6-1421" aria-hidden="true" tabindex="-1"></a><span class="in">            .container {</span></span>
<span id="cb6-1422"><a href="#cb6-1422" aria-hidden="true" tabindex="-1"></a><span class="in">                padding: 15px 30px;  /* Smaller padding on mobile */</span></span>
<span id="cb6-1423"><a href="#cb6-1423" aria-hidden="true" tabindex="-1"></a><span class="in">                max-width: 90%;  /* Ensure container fits better on small screens */</span></span>
<span id="cb6-1424"><a href="#cb6-1424" aria-hidden="true" tabindex="-1"></a><span class="in">            }</span></span>
<span id="cb6-1425"><a href="#cb6-1425" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb6-1426"><a href="#cb6-1426" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;/style&gt;</span></span>
<span id="cb6-1427"><a href="#cb6-1427" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/head&gt;</span></span>
<span id="cb6-1428"><a href="#cb6-1428" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;body&gt;</span></span>
<span id="cb6-1429"><a href="#cb6-1429" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;div class="container"&gt;</span></span>
<span id="cb6-1430"><a href="#cb6-1430" aria-hidden="true" tabindex="-1"></a><span class="in">        &lt;a href="https://loccx78vn.github.io/genetic-algorithm-method/MILP.html" class="link" tabindex="0"&gt;</span></span>
<span id="cb6-1431"><a href="#cb6-1431" aria-hidden="true" tabindex="-1"></a><span class="in">            Go to Next Page</span></span>
<span id="cb6-1432"><a href="#cb6-1432" aria-hidden="true" tabindex="-1"></a><span class="in">            &lt;span class="arrow"&gt;➔&lt;/span&gt;</span></span>
<span id="cb6-1433"><a href="#cb6-1433" aria-hidden="true" tabindex="-1"></a><span class="in">        &lt;/a&gt;</span></span>
<span id="cb6-1434"><a href="#cb6-1434" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;/div&gt;</span></span>
<span id="cb6-1435"><a href="#cb6-1435" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/body&gt;</span></span>
<span id="cb6-1436"><a href="#cb6-1436" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/html&gt;</span></span>
<span id="cb6-1437"><a href="#cb6-1437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, <a href="https://github.com/Loccx78vn">Loc cao</a> <i class="fa-solid fa-heart"></i></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><i class="fa-solid fa-book"></i> Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>